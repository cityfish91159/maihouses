# MaiHouses

æˆ¿ç”¢ç¤¾å€è³‡è¨Šèˆ‡ AI æ‰¾æˆ¿åŠ©ç†ã€‚æ­¤ README è£œå…… AI ä»‹é¢ç¶­é‹èˆ‡é˜²æ­¢å›æ­¸éŒ¯èª¤çš„è¦é»ã€‚

## ğŸ”¤ ç¹é«”ä¸­æ–‡è¼¸å‡ºä¿è­‰

AI å°è©±æœå‹™åœ¨ `src/services/openai.ts` å…§å»º system promptï¼šè¦æ±‚æ‰€æœ‰å›è¦†ä½¿ç”¨ç¹é«”ä¸­æ–‡ï¼ˆå°ç£å­—å½¢èˆ‡ç”¨èªï¼‰ï¼Œé¿å…ç°¡é«”å­—å‡ºç¾ã€‚è‹¥éœ€èª¿æ•´èªè¨€ï¼Œåƒ…ä¿®æ”¹è©²æª”æ¡ˆçš„ `systemPrompt` å…§å®¹å³å¯ï¼Œä¸å¿…æ”¹å¤šè™•ã€‚

## ğŸ”Œ é€£ç·šç­–ç•¥ï¼ˆé¿å…æŒ‡å‘ /api/chatï¼‰

å‰ç«¯å‘¼å«é †åºï¼š
1. è‹¥å­˜åœ¨ `VITE_OPENAI_API_KEY` -> ç›´é€£ `https://api.openai.com/v1/chat/completions`ã€‚
2. å¦å‰‡è‹¥å­˜åœ¨ `VITE_AI_PROXY_URL` -> ä½¿ç”¨ä»£ç†ï¼ˆå»ºè­° Cloudflare Workersï¼‰ã€‚
3. å¦å‰‡å›é€€ `/api/chat`ï¼ˆGitHub Pages ä¸Šæœƒ 404/405ï¼Œå‹™å¿…é…ç½® 1 æˆ– 2ï¼‰ã€‚

ç¤ºä¾‹ç’°å¢ƒæª”ï¼šè«‹è¤‡è£½ `.env.example` ç‚º `.env` ä¸¦å¡«å…¥é‡‘é‘°æˆ–ä»£ç†ã€‚

## ğŸ§ª é‡‘é‘°/ä»£ç†æª¢æŸ¥

åŸ·è¡Œè…³æœ¬ï¼š
```bash
bash scripts/check-ai.sh
```
è¼¸å‡ºæœƒå‘ŠçŸ¥ï¼šé‡‘é‘°æ˜¯å¦æœ‰æ•ˆã€ä»£ç†æ˜¯å¦å¯é€£é€šæˆ–éœ€è£œ .env è¨­å®šã€‚

## ğŸ§­ ç•Œé¢èˆ‡è·¯ç”±è§£è€¦

AI èŠå¤©ç¨ç«‹è·¯ç”±ï¼š`/chat` å°æ‡‰ `src/pages/Chat/Standalone.tsx`ï¼Œåƒ…æ¸²æŸ“ `SmartAsk`ã€‚æœªä¾†é¦–é æ”¹ç‰ˆä¸æœƒå½±éŸ¿èŠå¤©é«”é©—ã€‚

è‹¥éœ€æ›´å¼·éš”é›¢ï¼ˆä¸å—å…¨ç«™ CSS å½±éŸ¿ï¼‰ï¼š
- æ–¹æ¡ˆ Aï¼šä»¥ `<iframe src="/#/chat">` å…§åµŒã€‚
- æ–¹æ¡ˆ Bï¼šå°è£æˆ Web Component ä½¿ç”¨ Shadow DOMï¼ˆå»ºç«‹ `components/ai-chat/`ï¼‰ã€‚
- æ–¹æ¡ˆ Cï¼šå¾®å‰ç«¯ï¼ˆSingle-SPA / Module Federationï¼‰â€” é©ç”¨æ–¼å¤šåœ˜éšŠå”ä½œï¼Œæš«ä¸å¿…å¯¦ä½œã€‚

## ğŸ›¡ é˜²å›æ­¸å»ºè­°

1. Git Tag ç©©å®šç‰ˆæœ¬ï¼š
```bash
git tag -a v2025-11-08-stable -m "Stable chat + zh-Hant system prompt"
git push origin v2025-11-08-stable
```
2. ç™¼ä½ˆæ™‚é™„ä¸Š `docs/` æ‰“åŒ…ï¼ˆReleases ä¸Šå‚³ zipï¼‰ã€‚
3. CI åŠ æœ€å°ç…™éœ§æ¸¬è©¦ï¼ˆé¿å…åˆ fallback åˆ° /api/chatï¼‰ï¼šåœ¨ GitHub Actions build å¾ŒåŠ å…¥ï¼š
```bash
if grep -R "\/api\/chat" docs; then echo "[CI] Forbidden /api/chat fallback detected"; exit 1; fi
```
4. README ä¸­æ˜ç¢ºå¯«ã€Œç¦æ­¢ä½¿ç”¨ /api/chat ä½œç‚ºæœ€çµ‚ç›®æ¨™ã€ã€‚å·²å®Œæˆã€‚
5. é›†ä¸­è¨­å®šï¼šæœªä¾†è‹¥æ”¹ä»£ç†ï¼Œåªéœ€æ”¹ `.env`ã€‚ç¨‹å¼å…§åƒ…è®€å–ç’°å¢ƒï¼Œä¸å¯«æ­»åŸŸåã€‚

## ğŸ“ é‡è¦æª”æ¡ˆä¸€è¦½

| æª”æ¡ˆ | ä½œç”¨ |
|------|------|
| `src/services/openai.ts` | å°è©±èˆ‡ä¸²æµé‚è¼¯ + system promptï¼ˆç¹é«”ä¿è­‰ï¼‰ |
| `src/pages/Chat/Standalone.tsx` | ç¨ç«‹èŠå¤©é é¢ï¼ˆèˆ‡é¦–é è§£è€¦ï¼‰ |
| `scripts/check-ai.sh` | é‡‘é‘°/ä»£ç†å¿«é€Ÿå¥åº·æª¢æŸ¥ |
| `.env.example` | é€£ç·šæ–¹å¼ç¤ºä¾‹è¨­å®š |
| `cf-workers/mai-ai-proxy/` | Cloudflare Workers ä»£ç†ç¨‹å¼ç¢¼ |

## ğŸš€ æœ¬åœ°é–‹ç™¼

```bash
npm install
cp .env.example .env   # ç·¨è¼¯å¾Œå¡«å…¥çœŸå¯¦å€¼
npm run dev
# æ‰“é–‹ http://localhost:5173/maihouses/#/chat é€²è¡Œæ¸¬è©¦
```

## âœ… å“è³ªæª¢æŸ¥

```bash
npm run typecheck
bash scripts/check-ai.sh
```

## ğŸ§© å¾ŒçºŒå¯é¸å„ªåŒ–ï¼ˆæš«ä¸å¿…è¦ï¼‰

- åŠ å…¥ä½¿ç”¨é‡è¨ˆæ•¸èˆ‡é€Ÿç‡é¡¯ç¤ºï¼ˆéœ€å¾Œç«¯é…åˆï¼‰
- å°‡æ¨è–¦æ¸…å–® `reco` çš„å–å¾—æ”¹ç‚ºçœŸæ­£çš„æˆ¿æºæ¨è–¦ API
- å°‡ system prompt å¤–éƒ¨åŒ–ç‚º `src/config/chat.ts` ä¾¿æ–¼ A/B æ¸¬è©¦

---
ç¶­é‹å‚™å¿˜ï¼šèŠå¤©è«‹æ±‚ç›®æ¨™ = ç›´é€£ OpenAI æˆ–è¨­å®šçš„ä»£ç†åŸŸåï¼›ç¦æ­¢æœ€çµ‚æŒ‡å‘ `/api/chat`ï¼ˆGitHub Pages éœæ…‹ç’°å¢ƒç„¡è©²ç«¯é»ï¼‰ã€‚
