#!/bin/sh

# 1. æª¢æŸ¥å®ˆé–€å“¡æ˜¯å¦è¢«æ”¶è²· (Hash Check)
# Hash calculated from Get-FileHash (SHA256)
EXPECTED_HASH="E2289C8382F7A488F727DB330B02EDB861E35CEC428F60BE77F017363ADC11D9"

# Calculate current hash (normalize to uppercase to match EXPECTED_HASH)
CURRENT_HASH=$(sha256sum scripts/quality-gate.cjs | awk '{print $1}' | tr '[:lower:]' '[:upper:]')

if [ "$CURRENT_HASH" != "$EXPECTED_HASH" ]; then
  echo "ğŸš¨ å®‰å…¨è­¦å ±ï¼šscripts/quality-gate.cjs å·²è¢«ç«„æ”¹ï¼"
  echo "æ‹’çµ•åŸ·è¡Œæäº¤ã€‚è«‹é‚„åŸè©²æª”æ¡ˆã€‚"
  echo "é æœŸè…³æœ¬æŒ‡ç´‹: $EXPECTED_HASH"
  echo "å¯¦éš›è…³æœ¬æŒ‡ç´‹: $CURRENT_HASH"
  exit 1
fi

# 2. æª¢æŸ¥ UTF-8 ç·¨ç¢¼
npm run check:utf8

# 3. åŸ·è¡Œå®ˆé–€å“¡
node scripts/quality-gate.cjs
