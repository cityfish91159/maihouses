# ç¤¾å€ç‰†æ¶æ§‹å„ªåŒ–èˆ‡åŠŸèƒ½è£œå®Œæ¸…å–®

> **è§’è‰²**ï¼šGoogle é¦–å¸­å‰å¾Œç«¯è™•é•·
> **å¯©è¨ˆæ—¥æœŸ**ï¼š2025/12/05
> **ç‹€æ…‹**ï¼šç¬¬äºŒéšæ®µ - æ¶æ§‹é‡æ§‹èˆ‡åŠŸèƒ½è½åœ°
> **åŸå‰‡**ï¼šæ‹’çµ•ã€Œçœ‹èµ·ä¾†èƒ½å‹•å°±å¥½ã€ï¼Œè¿½æ±‚ã€Œç©©å¥ã€å¯ç¶­è­·ã€å¯æ“´å±•ã€çš„å·¥ç¨‹å“è³ªã€‚

---

## ğŸ”´ P0 - æ¶æ§‹èˆ‡é‚è¼¯æ¼æ´ï¼ˆç«‹å³ä¿®å¾©ï¼‰

### 1. React Query å¿«å–éµå€¼ç¼ºå¤± (Cache Invalidation Risk)
**å•é¡Œæè¿°**ï¼š
`useCommunityWallQuery` çš„ `queryKey` ç›®å‰åƒ…ç‚º `['communityWall', communityId]`ã€‚
ç•¶ä½¿ç”¨è€…åˆ‡æ› `includePrivate`ï¼ˆæŸ¥çœ‹ç§å¯†è²¼æ–‡ï¼‰æ™‚ï¼ŒQuery Key æœªæ”¹è®Šï¼Œå°è‡´ React Query å›å‚³èˆŠçš„å¿«å–è³‡æ–™ï¼ˆä¸å«ç§å¯†è²¼æ–‡ï¼‰ï¼Œæˆ–è€…åœ¨ç™»å‡ºå¾Œä»ç„¶é¡¯ç¤ºç§å¯†è²¼æ–‡ï¼ˆè³‡å®‰é¢¨éšªï¼‰ã€‚

**ä¿®æ­£æ–¹æ¡ˆ**ï¼š
- ä¿®æ”¹ `queryKey` ç‚º `['communityWall', communityId, { includePrivate }]`ã€‚
- ç¢ºä¿ `useCommunityWallQuery` æ¥æ”¶ `includePrivate` åƒæ•¸ã€‚

### 2. LockedOverlay äº’å‹•æ–·é» (Broken UX)
**å•é¡Œæè¿°**ï¼š
`LockedOverlay` çµ„ä»¶ç›®å‰åƒ…åšè¦–è¦ºå±•ç¤ºï¼Œå…¶ CTA æŒ‰éˆ•ï¼ˆ"è§£é–æŸ¥çœ‹æ›´å¤š"ï¼‰æ²’æœ‰ç¶å®šä»»ä½•å¯¦éš›è¡Œç‚ºã€‚ä½¿ç”¨è€…é»æ“Šå¾Œç„¡åæ‡‰ï¼Œç„¡æ³•å¼•å°è‡³è¨»å†Šæˆ–ä»˜è²»æµç¨‹ã€‚

**ä¿®æ­£æ–¹æ¡ˆ**ï¼š
- `LockedOverlay` æ–°å¢ `onUnlock: () => void` propã€‚
- åœ¨ `CommunityWall` ä¸­å¯¦ä½œ `handleUnlock`ï¼Œæ ¹æ“šä½¿ç”¨è€…ç‹€æ…‹å°å‘ `/auth` æˆ– `/pricing`ã€‚
- ç¢ºä¿é»æ“Šå¾Œæœ‰æ˜ç¢ºçš„åé¥‹ï¼ˆå¦‚è·³è½‰æˆ–å½ˆçª—ï¼‰ã€‚

### 3. QA Section åŠŸèƒ½æœªä¸²æ¥ (Missing Implementation)
**å•é¡Œæè¿°**ï¼š
QA å€å¡Šçš„ã€Œæˆ‘è¦ç™¼å•ã€èˆ‡ã€Œæˆ‘è¦å›ç­”ã€æŒ‰éˆ•ç›®å‰åƒ…ç‚º UI å±•ç¤ºæˆ– `console.log`ï¼Œæœªä¸²æ¥ `useCommunityWall` çš„ `askQuestion` èˆ‡ `answerQuestion` æ–¹æ³•ã€‚

**ä¿®æ­£æ–¹æ¡ˆ**ï¼š
- `QASection` çµ„ä»¶éœ€æ¥æ”¶ `onAskQuestion` èˆ‡ `onAnswerQuestion` callbackã€‚
- å¯¦ä½œç°¡å–®çš„ Modal æˆ– Prompt è®“ä½¿ç”¨è€…è¼¸å…¥å•é¡Œ/ç­”æ¡ˆå…§å®¹ã€‚
- ä¸²æ¥ `useCommunityWall` çš„ mutation æ–¹æ³•ã€‚

---

## ğŸŸ  P1 - ä»£ç¢¼å“è³ªèˆ‡ç¶­è­·æ€§ (æœ¬é€±å…§å®Œæˆ)

### 4. å‹åˆ¥å®šç¾©é‡è¤‡ (Type Duplication)
**å•é¡Œæè¿°**ï¼š
`src/types/community.ts` èˆ‡ `src/pages/Community/types.ts` å­˜åœ¨å¤§é‡é‡è¤‡æˆ–çµæ§‹ç›¸ä¼¼çš„ä»‹é¢ï¼ˆå¦‚ `Post`, `Review`, `Question`ï¼‰ã€‚é€™å°è‡´ç¶­è­·æ™‚éœ€ä¿®æ”¹å¤šè™•ï¼Œå®¹æ˜“ç”¢ç”Ÿä¸ä¸€è‡´ã€‚

**ä¿®æ­£æ–¹æ¡ˆ**ï¼š
- å»ºç«‹ `src/types/domain/community.ts` ä½œç‚ºå”¯ä¸€çœŸç†ä¾†æº (SSOT)ã€‚
- ç§»é™¤ `src/pages/Community/types.ts` ä¸­çš„é‡è¤‡å®šç¾©ï¼Œæ”¹ç‚ºå¼•ç”¨å‰è€…ã€‚
- çµ±ä¸€ `UnifiedPost` ç­‰èšåˆå‹åˆ¥çš„å®šç¾©ä½ç½®ã€‚

### 5. Mock è³‡æ–™åˆ†æ•£ (Data Fragmentation)
**å•é¡Œæè¿°**ï¼š
Mock è³‡æ–™æ•£è½åœ¨ `src/pages/Community/mockData.ts` èˆ‡å„å€‹æ¸¬è©¦æª”æ¡ˆä¸­ã€‚æ¸¬è©¦ç”¨çš„ Mock è³‡æ–™èˆ‡é–‹ç™¼ç”¨çš„ Mock è³‡æ–™çµæ§‹å¯èƒ½è„«é‰¤ã€‚

**ä¿®æ­£æ–¹æ¡ˆ**ï¼š
- çµ±ä¸€ä½¿ç”¨ `src/pages/Community/mockData.ts` ä½œç‚º Mock Data Factoryã€‚
- æ¸¬è©¦æª”æ¡ˆæ‡‰å¼•å…¥è©² Factory ç”Ÿæˆè³‡æ–™ï¼Œè€Œéæ‰‹å¯« JSONã€‚

### 6. å´é‚Šæ¬„æ’åºé‚è¼¯å„ªåŒ– (Business Logic)
**å•é¡Œæè¿°**ï¼š
ç›®å‰ç†±é–€è²¼æ–‡æ’åºåƒ…ä¾æ“š `likes` (`b.likes - a.likes`)ã€‚é€™å¿½ç•¥äº†é«˜ç€è¦½é‡ä½†ä½äº’å‹•çš„è²¼æ–‡ï¼ˆå¦‚æˆ¿ä»²ç‰©ä»¶è³‡è¨Šï¼‰ï¼Œå°è‡´é‡è¦è³‡è¨Šæ›å…‰ä¸è¶³ã€‚

**ä¿®æ­£æ–¹æ¡ˆ**ï¼š
- ä¿®æ”¹æ’åºé‚è¼¯ç‚ºåŠ æ¬Šåˆ†æ•¸ï¼š`Score = Likes * 1 + Views * 0.1` (æ¬Šé‡å¯èª¿æ•´)ã€‚
- ç¢ºä¿ `UnifiedPost` ä»‹é¢åŒ…å« `views` æ¬„ä½ï¼ˆå¦‚ç„¡å‰‡éœ€æ–°å¢æˆ– mockï¼‰ã€‚

---

## ğŸŸ¡ P2 - æ¸¬è©¦è¦†è“‹ç‡ (æŒçºŒé€²è¡Œ)

### 7. E2E æ¸¬è©¦ (Playwright)
**å•é¡Œæè¿°**ï¼š
ç›®å‰åƒ…æœ‰å–®å…ƒ/æ•´åˆæ¸¬è©¦ï¼Œç¼ºä¹çœŸå¯¦ç€è¦½å™¨ç’°å¢ƒçš„ E2E æ¸¬è©¦ã€‚ç„¡æ³•é©—è­‰ CSS æ¨£å¼å½±éŸ¿ã€æ»¾å‹•è¡Œç‚ºã€è·¯ç”±åˆ‡æ›ç­‰çœŸå¯¦ä½¿ç”¨è€…å ´æ™¯ã€‚

**å¾…è¾¦äº‹é …**ï¼š
- å®‰è£ Playwrightã€‚
- æ’°å¯« `tests/e2e/community-wall.spec.ts`ã€‚
- æ¸¬è©¦å ´æ™¯ï¼šè¼‰å…¥ç‰†é¢ -> æ»¾å‹•åŠ è¼‰ -> åˆ‡æ› Tab -> é»æ“Šé–å®šå…§å®¹ -> ç™»å…¥æµç¨‹ã€‚

### 8. ç„¡éšœç¤™æ¸¬è©¦ (A11y)
**å•é¡Œæè¿°**ï¼š
ç¼ºä¹è‡ªå‹•åŒ– A11y æ¸¬è©¦ï¼Œç„¡æ³•ç¢ºä¿çµ„ä»¶ç¬¦åˆ WCAG æ¨™æº–ã€‚

**å¾…è¾¦äº‹é …**ï¼š
- æ•´åˆ `axe-core` æˆ– `jest-axe`ã€‚
- ç¢ºä¿æ‰€æœ‰äº’å‹•å…ƒç´ æœ‰æ­£ç¢ºçš„ `aria-label`ã€`role` èˆ‡éµç›¤å°èˆªæ”¯æ´ã€‚

---

## âœ… å·²å®Œæˆé …ç›® (Archive)

> è©³è¦‹ `COMMUNITY_WALL_DEV_LOG.md`

- [x] P0-1: API æ¨¡å¼ç„¡ End-to-End æ¸¬è©¦è¦†è“‹ (useCommunityWallQuery.test.ts)
- [x] P0-2: Mock/API åˆ‡æ›å¾Œè³‡æ–™ä¸åŒæ­¥ (localStorage persistence)
- [x] P1-3: convertApiData ç¼ºä¹é˜²ç¦¦æ€§ç¨‹å¼è¨­è¨ˆ (Optional Chaining)
- [x] P1-4: formatTimeAgo æœªä¾†æ™‚é–“é¡¯ç¤ºå•é¡Œ
- [x] P1-5: useCommunityWall ä¾è³´éå¤š (Custom Hook Refactoring)
- [x] P2-6: è¼‰å…¥ç‹€æ…‹é–ƒçˆ (Loading Skeleton)
- [x] P2-7: éŒ¯èª¤é‚Šç•Œç¼ºå¤± (ErrorBoundary)
- [x] P2-8: ç¼ºä¹ç©ºç‹€æ…‹è™•ç† (Empty State)
- [x] P2-9: å›è¦†åŠŸèƒ½æœªå¯¦ä½œ (Disabled State + Tooltip)
- [x] P2-10: Service å±¤æœªå°å‡º (Barrel File)
