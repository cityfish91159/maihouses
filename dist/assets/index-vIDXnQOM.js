const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DekheYw5.js","assets/react-vendor-O_HdFl-f.js","assets/ui-libs-l3-I0wpP.js","assets/supabase-gMFHs-AT.js"])))=>i.map(i=>d[i]);
var Mr=e=>{throw TypeError(e)};var Ts=(e,t,s)=>t.has(e)||Mr("Cannot "+s);var h=(e,t,s)=>(Ts(e,t,"read from private field"),s?s.call(e):t.get(e)),A=(e,t,s)=>t.has(e)?Mr("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),C=(e,t,s,n)=>(Ts(e,t,"write to private field"),n?n.call(e,s):t.set(e,s),s),M=(e,t,s)=>(Ts(e,t,"access private method"),s);var ss=(e,t,s,n)=>({set _(a){C(e,t,a,s)},get _(){return h(e,t,n)}});import{r as g,a as Po,R as _s,u as ur,L as ps,b as Jn,c as Oo,d as Mo,e as Fo,f as ge,B as Do}from"./react-vendor-O_HdFl-f.js";import{L as Lo,a as Zo,U as Uo,S as Bo,P as hr,b as qo,H as Yn,M as Wo,c as Vo,K as Qo,C as Go,d as Ho,A as Ko,B as Jo,e as Xn,f as Yo,z as Se,Z as Fr,F as ea,R as Xo,g as ei,h as ti,i as si,j as ta,I as ri,k as Dt,l as ni,m as ai,n as oi,o as Je,p as ii,q as mr,r as li,T as Fs,s as sa,t as ra,u as pr,v as na,w as ci,X as aa,x as oa,y as di,D as ui,E as ia,G as Dr,J as Lr,N as hi,O as Zr,Q as mi,V as pi,W as fi}from"./ui-libs-l3-I0wpP.js";import{c as gi}from"./supabase-gMFHs-AT.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=s(a);fetch(a.href,o)}})();var la={exports:{}},ks={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xi=g,bi=Symbol.for("react.element"),vi=Symbol.for("react.fragment"),yi=Object.prototype.hasOwnProperty,wi=xi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ji={key:!0,ref:!0,__self:!0,__source:!0};function ca(e,t,s){var n,a={},o=null,i=null;s!==void 0&&(o=""+s),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)yi.call(t,n)&&!ji.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:bi,type:e,key:o,ref:i,props:a,_owner:wi.current}}ks.Fragment=vi;ks.jsx=ca;ks.jsxs=ca;la.exports=ks;var r=la.exports,Ds={},Ur=Po;Ds.createRoot=Ur.createRoot,Ds.hydrateRoot=Ur.hydrateRoot;var Rt=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},_i={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},De,dr,Ln,ki=(Ln=class{constructor(){A(this,De,_i);A(this,dr,!1)}setTimeoutProvider(e){C(this,De,e)}setTimeout(e,t){return h(this,De).setTimeout(e,t)}clearTimeout(e){h(this,De).clearTimeout(e)}setInterval(e,t){return h(this,De).setInterval(e,t)}clearInterval(e){h(this,De).clearInterval(e)}},De=new WeakMap,dr=new WeakMap,Ln),Xe=new ki;function Ni(e){setTimeout(e,0)}var ct=typeof window>"u"||"Deno"in globalThis;function le(){}function Si(e,t){return typeof e=="function"?e(t):e}function Ls(e){return typeof e=="number"&&e>=0&&e!==1/0}function da(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Ge(e,t){return typeof e=="function"?e(t):e}function be(e,t){return typeof e=="function"?e(t):e}function Br(e,t){const{type:s="all",exact:n,fetchStatus:a,predicate:o,queryKey:i,stale:l}=e;if(i){if(n){if(t.queryHash!==fr(i,t.options))return!1}else if(!Lt(t.queryKey,i))return!1}if(s!=="all"){const c=t.isActive();if(s==="active"&&!c||s==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||a&&a!==t.state.fetchStatus||o&&!o(t))}function qr(e,t){const{exact:s,status:n,predicate:a,mutationKey:o}=e;if(o){if(!t.options.mutationKey)return!1;if(s){if(dt(t.options.mutationKey)!==dt(o))return!1}else if(!Lt(t.options.mutationKey,o))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function fr(e,t){return((t==null?void 0:t.queryKeyHashFn)||dt)(e)}function dt(e){return JSON.stringify(e,(t,s)=>Zs(s)?Object.keys(s).sort().reduce((n,a)=>(n[a]=s[a],n),{}):s)}function Lt(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(s=>Lt(e[s],t[s])):!1}var Ci=Object.prototype.hasOwnProperty;function ua(e,t){if(e===t)return e;const s=Wr(e)&&Wr(t);if(!s&&!(Zs(e)&&Zs(t)))return t;const a=(s?e:Object.keys(e)).length,o=s?t:Object.keys(t),i=o.length,l=s?new Array(i):{};let c=0;for(let d=0;d<i;d++){const u=s?d:o[d],m=e[u],p=t[u];if(m===p){l[u]=m,(s?d<a:Ci.call(e,u))&&c++;continue}if(m===null||p===null||typeof m!="object"||typeof p!="object"){l[u]=p;continue}const f=ua(m,p);l[u]=f,f===m&&c++}return a===i&&c===a?e:l}function fs(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}function Wr(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Zs(e){if(!Vr(e))return!1;const t=e.constructor;if(t===void 0)return!0;const s=t.prototype;return!(!Vr(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Vr(e){return Object.prototype.toString.call(e)==="[object Object]"}function zi(e){return new Promise(t=>{Xe.setTimeout(t,e)})}function Us(e,t,s){return typeof s.structuralSharing=="function"?s.structuralSharing(e,t):s.structuralSharing!==!1?ua(e,t):t}function Ei(e,t,s=0){const n=[...e,t];return s&&n.length>s?n.slice(1):n}function Ii(e,t,s=0){const n=[t,...e];return s&&n.length>s?n.slice(0,-1):n}var gr=Symbol();function ha(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===gr?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function ma(e,t){return typeof e=="function"?e(...t):!!e}var et,Le,yt,Zn,Ti=(Zn=class extends Rt{constructor(){super();A(this,et);A(this,Le);A(this,yt);C(this,yt,t=>{if(!ct&&window.addEventListener){const s=()=>t();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){h(this,Le)||this.setEventListener(h(this,yt))}onUnsubscribe(){var t;this.hasListeners()||((t=h(this,Le))==null||t.call(this),C(this,Le,void 0))}setEventListener(t){var s;C(this,yt,t),(s=h(this,Le))==null||s.call(this),C(this,Le,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){h(this,et)!==t&&(C(this,et,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(s=>{s(t)})}isFocused(){var t;return typeof h(this,et)=="boolean"?h(this,et):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},et=new WeakMap,Le=new WeakMap,yt=new WeakMap,Zn),xr=new Ti;function Bs(){let e,t;const s=new Promise((a,o)=>{e=a,t=o});s.status="pending",s.catch(()=>{});function n(a){Object.assign(s,a),delete s.resolve,delete s.reject}return s.resolve=a=>{n({status:"fulfilled",value:a}),e(a)},s.reject=a=>{n({status:"rejected",reason:a}),t(a)},s}var Ai=Ni;function Ri(){let e=[],t=0,s=l=>{l()},n=l=>{l()},a=Ai;const o=l=>{t?e.push(l):a(()=>{s(l)})},i=()=>{const l=e;e=[],l.length&&a(()=>{n(()=>{l.forEach(c=>{s(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||i()}return c},batchCalls:l=>(...c)=>{o(()=>{l(...c)})},schedule:o,setNotifyFunction:l=>{s=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{a=l}}}var X=Ri(),wt,Ze,jt,Un,$i=(Un=class extends Rt{constructor(){super();A(this,wt,!0);A(this,Ze);A(this,jt);C(this,jt,t=>{if(!ct&&window.addEventListener){const s=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",n)}}})}onSubscribe(){h(this,Ze)||this.setEventListener(h(this,jt))}onUnsubscribe(){var t;this.hasListeners()||((t=h(this,Ze))==null||t.call(this),C(this,Ze,void 0))}setEventListener(t){var s;C(this,jt,t),(s=h(this,Ze))==null||s.call(this),C(this,Ze,t(this.setOnline.bind(this)))}setOnline(t){h(this,wt)!==t&&(C(this,wt,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return h(this,wt)}},wt=new WeakMap,Ze=new WeakMap,jt=new WeakMap,Un),gs=new $i;function Pi(e){return Math.min(1e3*2**e,3e4)}function pa(e){return(e??"online")==="online"?gs.isOnline():!0}var qs=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function fa(e){let t=!1,s=0,n;const a=Bs(),o=()=>a.status!=="pending",i=_=>{var y;if(!o()){const k=new qs(_);p(k),(y=e.onCancel)==null||y.call(e,k)}},l=()=>{t=!0},c=()=>{t=!1},d=()=>xr.isFocused()&&(e.networkMode==="always"||gs.isOnline())&&e.canRun(),u=()=>pa(e.networkMode)&&e.canRun(),m=_=>{o()||(n==null||n(),a.resolve(_))},p=_=>{o()||(n==null||n(),a.reject(_))},f=()=>new Promise(_=>{var y;n=k=>{(o()||d())&&_(k)},(y=e.onPause)==null||y.call(e)}).then(()=>{var _;n=void 0,o()||(_=e.onContinue)==null||_.call(e)}),v=()=>{if(o())return;let _;const y=s===0?e.initialPromise:void 0;try{_=y??e.fn()}catch(k){_=Promise.reject(k)}Promise.resolve(_).then(m).catch(k=>{var S;if(o())return;const O=e.retry??(ct?0:3),z=e.retryDelay??Pi,w=typeof z=="function"?z(s,k):z,N=O===!0||typeof O=="number"&&s<O||typeof O=="function"&&O(s,k);if(t||!N){p(k);return}s++,(S=e.onFail)==null||S.call(e,s,k),zi(w).then(()=>d()?void 0:f()).then(()=>{t?p(k):v()})})};return{promise:a,status:()=>a.status,cancel:i,continue:()=>(n==null||n(),a),cancelRetry:l,continueRetry:c,canStart:u,start:()=>(u()?v():f().then(v),a)}}var tt,Bn,ga=(Bn=class{constructor(){A(this,tt)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Ls(this.gcTime)&&C(this,tt,Xe.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(ct?1/0:5*60*1e3))}clearGcTimeout(){h(this,tt)&&(Xe.clearTimeout(h(this,tt)),C(this,tt,void 0))}},tt=new WeakMap,Bn),st,_t,xe,rt,te,Bt,nt,ke,Te,qn,Oi=(qn=class extends ga{constructor(t){super();A(this,ke);A(this,st);A(this,_t);A(this,xe);A(this,rt);A(this,te);A(this,Bt);A(this,nt);C(this,nt,!1),C(this,Bt,t.defaultOptions),this.setOptions(t.options),this.observers=[],C(this,rt,t.client),C(this,xe,h(this,rt).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,C(this,st,Gr(this.options)),this.state=t.state??h(this,st),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=h(this,te))==null?void 0:t.promise}setOptions(t){if(this.options={...h(this,Bt),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const s=Gr(this.options);s.data!==void 0&&(this.setState(Qr(s.data,s.dataUpdatedAt)),C(this,st,s))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&h(this,xe).remove(this)}setData(t,s){const n=Us(this.state.data,t,this.options);return M(this,ke,Te).call(this,{data:n,type:"success",dataUpdatedAt:s==null?void 0:s.updatedAt,manual:s==null?void 0:s.manual}),n}setState(t,s){M(this,ke,Te).call(this,{type:"setState",state:t,setStateOptions:s})}cancel(t){var n,a;const s=(n=h(this,te))==null?void 0:n.promise;return(a=h(this,te))==null||a.cancel(t),s?s.then(le).catch(le):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(h(this,st))}isActive(){return this.observers.some(t=>be(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===gr||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Ge(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!da(this.state.dataUpdatedAt,t)}onFocus(){var s;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(s=h(this,te))==null||s.continue()}onOnline(){var s;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(s=h(this,te))==null||s.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),h(this,xe).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(s=>s!==t),this.observers.length||(h(this,te)&&(h(this,nt)?h(this,te).cancel({revert:!0}):h(this,te).cancelRetry()),this.scheduleGc()),h(this,xe).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||M(this,ke,Te).call(this,{type:"invalidate"})}async fetch(t,s){var c,d,u,m,p,f,v,_,y,k,O,z;if(this.state.fetchStatus!=="idle"&&((c=h(this,te))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(s!=null&&s.cancelRefetch))this.cancel({silent:!0});else if(h(this,te))return h(this,te).continueRetry(),h(this,te).promise}if(t&&this.setOptions(t),!this.options.queryFn){const w=this.observers.find(N=>N.options.queryFn);w&&this.setOptions(w.options)}const n=new AbortController,a=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(C(this,nt,!0),n.signal)})},o=()=>{const w=ha(this.options,s),S=(()=>{const T={client:h(this,rt),queryKey:this.queryKey,meta:this.meta};return a(T),T})();return C(this,nt,!1),this.options.persister?this.options.persister(w,S,this):w(S)},l=(()=>{const w={fetchOptions:s,options:this.options,queryKey:this.queryKey,client:h(this,rt),state:this.state,fetchFn:o};return a(w),w})();(d=this.options.behavior)==null||d.onFetch(l,this),C(this,_t,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=l.fetchOptions)==null?void 0:u.meta))&&M(this,ke,Te).call(this,{type:"fetch",meta:(m=l.fetchOptions)==null?void 0:m.meta}),C(this,te,fa({initialPromise:s==null?void 0:s.initialPromise,fn:l.fetchFn,onCancel:w=>{w instanceof qs&&w.revert&&this.setState({...h(this,_t),fetchStatus:"idle"}),n.abort()},onFail:(w,N)=>{M(this,ke,Te).call(this,{type:"failed",failureCount:w,error:N})},onPause:()=>{M(this,ke,Te).call(this,{type:"pause"})},onContinue:()=>{M(this,ke,Te).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const w=await h(this,te).start();if(w===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(w),(f=(p=h(this,xe).config).onSuccess)==null||f.call(p,w,this),(_=(v=h(this,xe).config).onSettled)==null||_.call(v,w,this.state.error,this),w}catch(w){if(w instanceof qs){if(w.silent)return h(this,te).promise;if(w.revert){if(this.state.data===void 0)throw w;return this.state.data}}throw M(this,ke,Te).call(this,{type:"error",error:w}),(k=(y=h(this,xe).config).onError)==null||k.call(y,w,this),(z=(O=h(this,xe).config).onSettled)==null||z.call(O,this.state.data,w,this),w}finally{this.scheduleGc()}}},st=new WeakMap,_t=new WeakMap,xe=new WeakMap,rt=new WeakMap,te=new WeakMap,Bt=new WeakMap,nt=new WeakMap,ke=new WeakSet,Te=function(t){const s=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...xa(n.data,this.options),fetchMeta:t.meta??null};case"success":const a={...n,...Qr(t.data,t.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return C(this,_t,t.manual?a:void 0),a;case"error":const o=t.error;return{...n,error:o,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=s(this.state),X.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),h(this,xe).notify({query:this,type:"updated",action:t})})},qn);function xa(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:pa(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Qr(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Gr(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,s=t!==void 0,n=s?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:s?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var ce,D,qt,oe,at,kt,Ae,Ue,Wt,Nt,St,ot,it,Be,Ct,L,Mt,Ws,Vs,Qs,Gs,Hs,Ks,Js,ba,Wn,Mi=(Wn=class extends Rt{constructor(t,s){super();A(this,L);A(this,ce);A(this,D);A(this,qt);A(this,oe);A(this,at);A(this,kt);A(this,Ae);A(this,Ue);A(this,Wt);A(this,Nt);A(this,St);A(this,ot);A(this,it);A(this,Be);A(this,Ct,new Set);this.options=s,C(this,ce,t),C(this,Ue,null),C(this,Ae,Bs()),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(h(this,D).addObserver(this),Hr(h(this,D),this.options)?M(this,L,Mt).call(this):this.updateResult(),M(this,L,Gs).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Ys(h(this,D),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Ys(h(this,D),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,M(this,L,Hs).call(this),M(this,L,Ks).call(this),h(this,D).removeObserver(this)}setOptions(t){const s=this.options,n=h(this,D);if(this.options=h(this,ce).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof be(this.options.enabled,h(this,D))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");M(this,L,Js).call(this),h(this,D).setOptions(this.options),s._defaulted&&!fs(this.options,s)&&h(this,ce).getQueryCache().notify({type:"observerOptionsUpdated",query:h(this,D),observer:this});const a=this.hasListeners();a&&Kr(h(this,D),n,this.options,s)&&M(this,L,Mt).call(this),this.updateResult(),a&&(h(this,D)!==n||be(this.options.enabled,h(this,D))!==be(s.enabled,h(this,D))||Ge(this.options.staleTime,h(this,D))!==Ge(s.staleTime,h(this,D)))&&M(this,L,Ws).call(this);const o=M(this,L,Vs).call(this);a&&(h(this,D)!==n||be(this.options.enabled,h(this,D))!==be(s.enabled,h(this,D))||o!==h(this,Be))&&M(this,L,Qs).call(this,o)}getOptimisticResult(t){const s=h(this,ce).getQueryCache().build(h(this,ce),t),n=this.createResult(s,t);return Di(this,n)&&(C(this,oe,n),C(this,kt,this.options),C(this,at,h(this,D).state)),n}getCurrentResult(){return h(this,oe)}trackResult(t,s){return new Proxy(t,{get:(n,a)=>(this.trackProp(a),s==null||s(a),a==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&h(this,Ae).status==="pending"&&h(this,Ae).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,a))})}trackProp(t){h(this,Ct).add(t)}getCurrentQuery(){return h(this,D)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const s=h(this,ce).defaultQueryOptions(t),n=h(this,ce).getQueryCache().build(h(this,ce),s);return n.fetch().then(()=>this.createResult(n,s))}fetch(t){return M(this,L,Mt).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),h(this,oe)))}createResult(t,s){var Z;const n=h(this,D),a=this.options,o=h(this,oe),i=h(this,at),l=h(this,kt),d=t!==n?t.state:h(this,qt),{state:u}=t;let m={...u},p=!1,f;if(s._optimisticResults){const P=this.hasListeners(),J=!P&&Hr(t,s),pe=P&&Kr(t,n,s,a);(J||pe)&&(m={...m,...xa(u.data,t.options)}),s._optimisticResults==="isRestoring"&&(m.fetchStatus="idle")}let{error:v,errorUpdatedAt:_,status:y}=m;f=m.data;let k=!1;if(s.placeholderData!==void 0&&f===void 0&&y==="pending"){let P;o!=null&&o.isPlaceholderData&&s.placeholderData===(l==null?void 0:l.placeholderData)?(P=o.data,k=!0):P=typeof s.placeholderData=="function"?s.placeholderData((Z=h(this,St))==null?void 0:Z.state.data,h(this,St)):s.placeholderData,P!==void 0&&(y="success",f=Us(o==null?void 0:o.data,P,s),p=!0)}if(s.select&&f!==void 0&&!k)if(o&&f===(i==null?void 0:i.data)&&s.select===h(this,Wt))f=h(this,Nt);else try{C(this,Wt,s.select),f=s.select(f),f=Us(o==null?void 0:o.data,f,s),C(this,Nt,f),C(this,Ue,null)}catch(P){C(this,Ue,P)}h(this,Ue)&&(v=h(this,Ue),f=h(this,Nt),_=Date.now(),y="error");const O=m.fetchStatus==="fetching",z=y==="pending",w=y==="error",N=z&&O,S=f!==void 0,j={status:y,fetchStatus:m.fetchStatus,isPending:z,isSuccess:y==="success",isError:w,isInitialLoading:N,isLoading:N,data:f,dataUpdatedAt:m.dataUpdatedAt,error:v,errorUpdatedAt:_,failureCount:m.fetchFailureCount,failureReason:m.fetchFailureReason,errorUpdateCount:m.errorUpdateCount,isFetched:m.dataUpdateCount>0||m.errorUpdateCount>0,isFetchedAfterMount:m.dataUpdateCount>d.dataUpdateCount||m.errorUpdateCount>d.errorUpdateCount,isFetching:O,isRefetching:O&&!z,isLoadingError:w&&!S,isPaused:m.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:w&&S,isStale:br(t,s),refetch:this.refetch,promise:h(this,Ae),isEnabled:be(s.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const P=ye=>{j.status==="error"?ye.reject(j.error):j.data!==void 0&&ye.resolve(j.data)},J=()=>{const ye=C(this,Ae,j.promise=Bs());P(ye)},pe=h(this,Ae);switch(pe.status){case"pending":t.queryHash===n.queryHash&&P(pe);break;case"fulfilled":(j.status==="error"||j.data!==pe.value)&&J();break;case"rejected":(j.status!=="error"||j.error!==pe.reason)&&J();break}}return j}updateResult(){const t=h(this,oe),s=this.createResult(h(this,D),this.options);if(C(this,at,h(this,D).state),C(this,kt,this.options),h(this,at).data!==void 0&&C(this,St,h(this,D)),fs(s,t))return;C(this,oe,s);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:a}=this.options,o=typeof a=="function"?a():a;if(o==="all"||!o&&!h(this,Ct).size)return!0;const i=new Set(o??h(this,Ct));return this.options.throwOnError&&i.add("error"),Object.keys(h(this,oe)).some(l=>{const c=l;return h(this,oe)[c]!==t[c]&&i.has(c)})};M(this,L,ba).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&M(this,L,Gs).call(this)}},ce=new WeakMap,D=new WeakMap,qt=new WeakMap,oe=new WeakMap,at=new WeakMap,kt=new WeakMap,Ae=new WeakMap,Ue=new WeakMap,Wt=new WeakMap,Nt=new WeakMap,St=new WeakMap,ot=new WeakMap,it=new WeakMap,Be=new WeakMap,Ct=new WeakMap,L=new WeakSet,Mt=function(t){M(this,L,Js).call(this);let s=h(this,D).fetch(this.options,t);return t!=null&&t.throwOnError||(s=s.catch(le)),s},Ws=function(){M(this,L,Hs).call(this);const t=Ge(this.options.staleTime,h(this,D));if(ct||h(this,oe).isStale||!Ls(t))return;const n=da(h(this,oe).dataUpdatedAt,t)+1;C(this,ot,Xe.setTimeout(()=>{h(this,oe).isStale||this.updateResult()},n))},Vs=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(h(this,D)):this.options.refetchInterval)??!1},Qs=function(t){M(this,L,Ks).call(this),C(this,Be,t),!(ct||be(this.options.enabled,h(this,D))===!1||!Ls(h(this,Be))||h(this,Be)===0)&&C(this,it,Xe.setInterval(()=>{(this.options.refetchIntervalInBackground||xr.isFocused())&&M(this,L,Mt).call(this)},h(this,Be)))},Gs=function(){M(this,L,Ws).call(this),M(this,L,Qs).call(this,M(this,L,Vs).call(this))},Hs=function(){h(this,ot)&&(Xe.clearTimeout(h(this,ot)),C(this,ot,void 0))},Ks=function(){h(this,it)&&(Xe.clearInterval(h(this,it)),C(this,it,void 0))},Js=function(){const t=h(this,ce).getQueryCache().build(h(this,ce),this.options);if(t===h(this,D))return;const s=h(this,D);C(this,D,t),C(this,qt,t.state),this.hasListeners()&&(s==null||s.removeObserver(this),t.addObserver(this))},ba=function(t){X.batch(()=>{t.listeners&&this.listeners.forEach(s=>{s(h(this,oe))}),h(this,ce).getQueryCache().notify({query:h(this,D),type:"observerResultsUpdated"})})},Wn);function Fi(e,t){return be(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Hr(e,t){return Fi(e,t)||e.state.data!==void 0&&Ys(e,t,t.refetchOnMount)}function Ys(e,t,s){if(be(t.enabled,e)!==!1&&Ge(t.staleTime,e)!=="static"){const n=typeof s=="function"?s(e):s;return n==="always"||n!==!1&&br(e,t)}return!1}function Kr(e,t,s,n){return(e!==t||be(n.enabled,e)===!1)&&(!s.suspense||e.state.status!=="error")&&br(e,s)}function br(e,t){return be(t.enabled,e)!==!1&&e.isStaleByTime(Ge(t.staleTime,e))}function Di(e,t){return!fs(e.getCurrentResult(),t)}function Jr(e){return{onFetch:(t,s)=>{var u,m,p,f,v;const n=t.options,a=(p=(m=(u=t.fetchOptions)==null?void 0:u.meta)==null?void 0:m.fetchMore)==null?void 0:p.direction,o=((f=t.state.data)==null?void 0:f.pages)||[],i=((v=t.state.data)==null?void 0:v.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const d=async()=>{let _=!1;const y=z=>{Object.defineProperty(z,"signal",{enumerable:!0,get:()=>(t.signal.aborted?_=!0:t.signal.addEventListener("abort",()=>{_=!0}),t.signal)})},k=ha(t.options,t.fetchOptions),O=async(z,w,N)=>{if(_)return Promise.reject();if(w==null&&z.pages.length)return Promise.resolve(z);const T=(()=>{const J={client:t.client,queryKey:t.queryKey,pageParam:w,direction:N?"backward":"forward",meta:t.options.meta};return y(J),J})(),j=await k(T),{maxPages:Z}=t.options,P=N?Ii:Ei;return{pages:P(z.pages,j,Z),pageParams:P(z.pageParams,w,Z)}};if(a&&o.length){const z=a==="backward",w=z?Li:Yr,N={pages:o,pageParams:i},S=w(n,N);l=await O(N,S,z)}else{const z=e??o.length;do{const w=c===0?i[0]??n.initialPageParam:Yr(n,l);if(c>0&&w==null)break;l=await O(l,w),c++}while(c<z)}return l};t.options.persister?t.fetchFn=()=>{var _,y;return(y=(_=t.options).persister)==null?void 0:y.call(_,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},s)}:t.fetchFn=d}}}function Yr(e,{pages:t,pageParams:s}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,s[n],s):void 0}function Li(e,{pages:t,pageParams:s}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,s[0],s):void 0}var Vt,Ce,ie,lt,ze,Fe,Vn,Zi=(Vn=class extends ga{constructor(t){super();A(this,ze);A(this,Vt);A(this,Ce);A(this,ie);A(this,lt);C(this,Vt,t.client),this.mutationId=t.mutationId,C(this,ie,t.mutationCache),C(this,Ce,[]),this.state=t.state||va(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){h(this,Ce).includes(t)||(h(this,Ce).push(t),this.clearGcTimeout(),h(this,ie).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){C(this,Ce,h(this,Ce).filter(s=>s!==t)),this.scheduleGc(),h(this,ie).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){h(this,Ce).length||(this.state.status==="pending"?this.scheduleGc():h(this,ie).remove(this))}continue(){var t;return((t=h(this,lt))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,l,c,d,u,m,p,f,v,_,y,k,O,z,w,N,S,T,j,Z;const s=()=>{M(this,ze,Fe).call(this,{type:"continue"})},n={client:h(this,Vt),meta:this.options.meta,mutationKey:this.options.mutationKey};C(this,lt,fa({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(P,J)=>{M(this,ze,Fe).call(this,{type:"failed",failureCount:P,error:J})},onPause:()=>{M(this,ze,Fe).call(this,{type:"pause"})},onContinue:s,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>h(this,ie).canRun(this)}));const a=this.state.status==="pending",o=!h(this,lt).canStart();try{if(a)s();else{M(this,ze,Fe).call(this,{type:"pending",variables:t,isPaused:o}),await((l=(i=h(this,ie).config).onMutate)==null?void 0:l.call(i,t,this,n));const J=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,t,n));J!==this.state.context&&M(this,ze,Fe).call(this,{type:"pending",context:J,variables:t,isPaused:o})}const P=await h(this,lt).start();return await((m=(u=h(this,ie).config).onSuccess)==null?void 0:m.call(u,P,t,this.state.context,this,n)),await((f=(p=this.options).onSuccess)==null?void 0:f.call(p,P,t,this.state.context,n)),await((_=(v=h(this,ie).config).onSettled)==null?void 0:_.call(v,P,null,this.state.variables,this.state.context,this,n)),await((k=(y=this.options).onSettled)==null?void 0:k.call(y,P,null,t,this.state.context,n)),M(this,ze,Fe).call(this,{type:"success",data:P}),P}catch(P){try{throw await((z=(O=h(this,ie).config).onError)==null?void 0:z.call(O,P,t,this.state.context,this,n)),await((N=(w=this.options).onError)==null?void 0:N.call(w,P,t,this.state.context,n)),await((T=(S=h(this,ie).config).onSettled)==null?void 0:T.call(S,void 0,P,this.state.variables,this.state.context,this,n)),await((Z=(j=this.options).onSettled)==null?void 0:Z.call(j,void 0,P,t,this.state.context,n)),P}finally{M(this,ze,Fe).call(this,{type:"error",error:P})}}finally{h(this,ie).runNext(this)}}},Vt=new WeakMap,Ce=new WeakMap,ie=new WeakMap,lt=new WeakMap,ze=new WeakSet,Fe=function(t){const s=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=s(this.state),X.batch(()=>{h(this,Ce).forEach(n=>{n.onMutationUpdate(t)}),h(this,ie).notify({mutation:this,type:"updated",action:t})})},Vn);function va(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Re,Ne,Qt,Qn,Ui=(Qn=class extends Rt{constructor(t={}){super();A(this,Re);A(this,Ne);A(this,Qt);this.config=t,C(this,Re,new Set),C(this,Ne,new Map),C(this,Qt,0)}build(t,s,n){const a=new Zi({client:t,mutationCache:this,mutationId:++ss(this,Qt)._,options:t.defaultMutationOptions(s),state:n});return this.add(a),a}add(t){h(this,Re).add(t);const s=rs(t);if(typeof s=="string"){const n=h(this,Ne).get(s);n?n.push(t):h(this,Ne).set(s,[t])}this.notify({type:"added",mutation:t})}remove(t){if(h(this,Re).delete(t)){const s=rs(t);if(typeof s=="string"){const n=h(this,Ne).get(s);if(n)if(n.length>1){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}else n[0]===t&&h(this,Ne).delete(s)}}this.notify({type:"removed",mutation:t})}canRun(t){const s=rs(t);if(typeof s=="string"){const n=h(this,Ne).get(s),a=n==null?void 0:n.find(o=>o.state.status==="pending");return!a||a===t}else return!0}runNext(t){var n;const s=rs(t);if(typeof s=="string"){const a=(n=h(this,Ne).get(s))==null?void 0:n.find(o=>o!==t&&o.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){X.batch(()=>{h(this,Re).forEach(t=>{this.notify({type:"removed",mutation:t})}),h(this,Re).clear(),h(this,Ne).clear()})}getAll(){return Array.from(h(this,Re))}find(t){const s={exact:!0,...t};return this.getAll().find(n=>qr(s,n))}findAll(t={}){return this.getAll().filter(s=>qr(t,s))}notify(t){X.batch(()=>{this.listeners.forEach(s=>{s(t)})})}resumePausedMutations(){const t=this.getAll().filter(s=>s.state.isPaused);return X.batch(()=>Promise.all(t.map(s=>s.continue().catch(le))))}},Re=new WeakMap,Ne=new WeakMap,Qt=new WeakMap,Qn);function rs(e){var t;return(t=e.options.scope)==null?void 0:t.id}var $e,qe,de,Pe,Oe,ms,Xs,Gn,Bi=(Gn=class extends Rt{constructor(s,n){super();A(this,Oe);A(this,$e);A(this,qe);A(this,de);A(this,Pe);C(this,$e,s),this.setOptions(n),this.bindMethods(),M(this,Oe,ms).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(s){var a;const n=this.options;this.options=h(this,$e).defaultMutationOptions(s),fs(this.options,n)||h(this,$e).getMutationCache().notify({type:"observerOptionsUpdated",mutation:h(this,de),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&dt(n.mutationKey)!==dt(this.options.mutationKey)?this.reset():((a=h(this,de))==null?void 0:a.state.status)==="pending"&&h(this,de).setOptions(this.options)}onUnsubscribe(){var s;this.hasListeners()||(s=h(this,de))==null||s.removeObserver(this)}onMutationUpdate(s){M(this,Oe,ms).call(this),M(this,Oe,Xs).call(this,s)}getCurrentResult(){return h(this,qe)}reset(){var s;(s=h(this,de))==null||s.removeObserver(this),C(this,de,void 0),M(this,Oe,ms).call(this),M(this,Oe,Xs).call(this)}mutate(s,n){var a;return C(this,Pe,n),(a=h(this,de))==null||a.removeObserver(this),C(this,de,h(this,$e).getMutationCache().build(h(this,$e),this.options)),h(this,de).addObserver(this),h(this,de).execute(s)}},$e=new WeakMap,qe=new WeakMap,de=new WeakMap,Pe=new WeakMap,Oe=new WeakSet,ms=function(){var n;const s=((n=h(this,de))==null?void 0:n.state)??va();C(this,qe,{...s,isPending:s.status==="pending",isSuccess:s.status==="success",isError:s.status==="error",isIdle:s.status==="idle",mutate:this.mutate,reset:this.reset})},Xs=function(s){X.batch(()=>{var n,a,o,i,l,c,d,u;if(h(this,Pe)&&this.hasListeners()){const m=h(this,qe).variables,p=h(this,qe).context,f={client:h(this,$e),meta:this.options.meta,mutationKey:this.options.mutationKey};(s==null?void 0:s.type)==="success"?((a=(n=h(this,Pe)).onSuccess)==null||a.call(n,s.data,m,p,f),(i=(o=h(this,Pe)).onSettled)==null||i.call(o,s.data,null,m,p,f)):(s==null?void 0:s.type)==="error"&&((c=(l=h(this,Pe)).onError)==null||c.call(l,s.error,m,p,f),(u=(d=h(this,Pe)).onSettled)==null||u.call(d,void 0,s.error,m,p,f))}this.listeners.forEach(m=>{m(h(this,qe))})})},Gn),Ee,Hn,qi=(Hn=class extends Rt{constructor(t={}){super();A(this,Ee);this.config=t,C(this,Ee,new Map)}build(t,s,n){const a=s.queryKey,o=s.queryHash??fr(a,s);let i=this.get(o);return i||(i=new Oi({client:t,queryKey:a,queryHash:o,options:t.defaultQueryOptions(s),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(i)),i}add(t){h(this,Ee).has(t.queryHash)||(h(this,Ee).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const s=h(this,Ee).get(t.queryHash);s&&(t.destroy(),s===t&&h(this,Ee).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){X.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return h(this,Ee).get(t)}getAll(){return[...h(this,Ee).values()]}find(t){const s={exact:!0,...t};return this.getAll().find(n=>Br(s,n))}findAll(t={}){const s=this.getAll();return Object.keys(t).length>0?s.filter(n=>Br(t,n)):s}notify(t){X.batch(()=>{this.listeners.forEach(s=>{s(t)})})}onFocus(){X.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){X.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Ee=new WeakMap,Hn),Q,We,Ve,zt,Et,Qe,It,Tt,Kn,Wi=(Kn=class{constructor(e={}){A(this,Q);A(this,We);A(this,Ve);A(this,zt);A(this,Et);A(this,Qe);A(this,It);A(this,Tt);C(this,Q,e.queryCache||new qi),C(this,We,e.mutationCache||new Ui),C(this,Ve,e.defaultOptions||{}),C(this,zt,new Map),C(this,Et,new Map),C(this,Qe,0)}mount(){ss(this,Qe)._++,h(this,Qe)===1&&(C(this,It,xr.subscribe(async e=>{e&&(await this.resumePausedMutations(),h(this,Q).onFocus())})),C(this,Tt,gs.subscribe(async e=>{e&&(await this.resumePausedMutations(),h(this,Q).onOnline())})))}unmount(){var e,t;ss(this,Qe)._--,h(this,Qe)===0&&((e=h(this,It))==null||e.call(this),C(this,It,void 0),(t=h(this,Tt))==null||t.call(this),C(this,Tt,void 0))}isFetching(e){return h(this,Q).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return h(this,We).findAll({...e,status:"pending"}).length}getQueryData(e){var s;const t=this.defaultQueryOptions({queryKey:e});return(s=h(this,Q).get(t.queryHash))==null?void 0:s.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),s=h(this,Q).build(this,t),n=s.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&s.isStaleByTime(Ge(t.staleTime,s))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return h(this,Q).findAll(e).map(({queryKey:t,state:s})=>{const n=s.data;return[t,n]})}setQueryData(e,t,s){const n=this.defaultQueryOptions({queryKey:e}),a=h(this,Q).get(n.queryHash),o=a==null?void 0:a.state.data,i=Si(t,o);if(i!==void 0)return h(this,Q).build(this,n).setData(i,{...s,manual:!0})}setQueriesData(e,t,s){return X.batch(()=>h(this,Q).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,s)]))}getQueryState(e){var s;const t=this.defaultQueryOptions({queryKey:e});return(s=h(this,Q).get(t.queryHash))==null?void 0:s.state}removeQueries(e){const t=h(this,Q);X.batch(()=>{t.findAll(e).forEach(s=>{t.remove(s)})})}resetQueries(e,t){const s=h(this,Q);return X.batch(()=>(s.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const s={revert:!0,...t},n=X.batch(()=>h(this,Q).findAll(e).map(a=>a.cancel(s)));return Promise.all(n).then(le).catch(le)}invalidateQueries(e,t={}){return X.batch(()=>(h(this,Q).findAll(e).forEach(s=>{s.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const s={...t,cancelRefetch:t.cancelRefetch??!0},n=X.batch(()=>h(this,Q).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let o=a.fetch(void 0,s);return s.throwOnError||(o=o.catch(le)),a.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(n).then(le)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const s=h(this,Q).build(this,t);return s.isStaleByTime(Ge(t.staleTime,s))?s.fetch(t):Promise.resolve(s.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(le).catch(le)}fetchInfiniteQuery(e){return e.behavior=Jr(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(le).catch(le)}ensureInfiniteQueryData(e){return e.behavior=Jr(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return gs.isOnline()?h(this,We).resumePausedMutations():Promise.resolve()}getQueryCache(){return h(this,Q)}getMutationCache(){return h(this,We)}getDefaultOptions(){return h(this,Ve)}setDefaultOptions(e){C(this,Ve,e)}setQueryDefaults(e,t){h(this,zt).set(dt(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...h(this,zt).values()],s={};return t.forEach(n=>{Lt(e,n.queryKey)&&Object.assign(s,n.defaultOptions)}),s}setMutationDefaults(e,t){h(this,Et).set(dt(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...h(this,Et).values()],s={};return t.forEach(n=>{Lt(e,n.mutationKey)&&Object.assign(s,n.defaultOptions)}),s}defaultQueryOptions(e){if(e._defaulted)return e;const t={...h(this,Ve).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=fr(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===gr&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...h(this,Ve).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){h(this,Q).clear(),h(this,We).clear()}},Q=new WeakMap,We=new WeakMap,Ve=new WeakMap,zt=new WeakMap,Et=new WeakMap,Qe=new WeakMap,It=new WeakMap,Tt=new WeakMap,Kn),ya=g.createContext(void 0),vr=e=>{const t=g.useContext(ya);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Vi=({client:e,children:t})=>(g.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),r.jsx(ya.Provider,{value:e,children:t})),wa=g.createContext(!1),Qi=()=>g.useContext(wa);wa.Provider;function ja(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var _a=g.createContext(ja()),Gi=()=>g.useContext(_a),Hi=({children:e})=>{const[t]=g.useState(()=>ja());return r.jsx(_a.Provider,{value:t,children:typeof e=="function"?e(t):e})},Ki=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},Ji=e=>{g.useEffect(()=>{e.clearReset()},[e])},Yi=({result:e,errorResetBoundary:t,throwOnError:s,query:n,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(a&&e.data===void 0||ma(s,[e.error,n])),Xi=e=>{if(e.suspense){const s=a=>a==="static"?a:Math.max(a??1e3,1e3),n=e.staleTime;e.staleTime=typeof n=="function"?(...a)=>s(n(...a)):s(n),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},el=(e,t)=>e.isLoading&&e.isFetching&&!t,tl=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,Xr=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function sl(e,t,s){var m,p,f,v,_;const n=Qi(),a=Gi(),o=vr(),i=o.defaultQueryOptions(e);(p=(m=o.getDefaultOptions().queries)==null?void 0:m._experimental_beforeQuery)==null||p.call(m,i),i._optimisticResults=n?"isRestoring":"optimistic",Xi(i),Ki(i,a),Ji(a);const l=!o.getQueryCache().get(i.queryHash),[c]=g.useState(()=>new t(o,i)),d=c.getOptimisticResult(i),u=!n&&e.subscribed!==!1;if(g.useSyncExternalStore(g.useCallback(y=>{const k=u?c.subscribe(X.batchCalls(y)):le;return c.updateResult(),k},[c,u]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),g.useEffect(()=>{c.setOptions(i)},[i,c]),tl(i,d))throw Xr(i,c,a);if(Yi({result:d,errorResetBoundary:a,throwOnError:i.throwOnError,query:o.getQueryCache().get(i.queryHash),suspense:i.suspense}))throw d.error;if((v=(f=o.getDefaultOptions().queries)==null?void 0:f._experimental_afterQuery)==null||v.call(f,i,d),i.experimental_prefetchInRender&&!ct&&el(d,n)){const y=l?Xr(i,c,a):(_=o.getQueryCache().get(i.queryHash))==null?void 0:_.promise;y==null||y.catch(le).finally(()=>{c.updateResult()})}return i.notifyOnChangeProps?d:c.trackResult(d)}function rl(e,t){return sl(e,Mi)}function nl(e,t){const s=vr(),[n]=g.useState(()=>new Bi(s,e));g.useEffect(()=>{n.setOptions(e)},[n,e]);const a=g.useSyncExternalStore(g.useCallback(i=>n.subscribe(X.batchCalls(i)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),o=g.useCallback((i,l)=>{n.mutate(i,l).catch(le)},[n]);if(a.error&&ma(n.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:o,mutateAsync:a.mutate}}const ka="maihouse_config";async function al(e){return(await fetch(e)).json()}function ol(e){return e&&typeof e=="object"&&typeof e.apiBaseUrl=="string"&&typeof e.appVersion=="string"&&typeof e.minBackend=="string"&&typeof e.features=="object"}async function il(){try{const s=localStorage.getItem(ka);if(s){const n=JSON.parse(s);if(ol(n))return{...n,...Na()}}}catch{}const t=`${window.location.origin}/maihouses/app.config.json`;return al(t)}function je(e){const t=new URLSearchParams(location.search).get(e),s=location.hash.indexOf("?");return(s>-1?new URLSearchParams(location.hash.slice(s)).get(e):null)??t??void 0}function Na(){const e=je("slots"),t=e?e.split(",").reduce((s,n)=>(s[n.trim()]=!0,s),{}):void 0;return{apiBaseUrl:je("api"),features:t,mock:je("mock")?je("mock")==="1":void 0,latency:je("latency")?+je("latency"):void 0,error:je("error")?+je("error"):void 0,q:je("q"),devtools:je("devtools"),mockSeed:je("seed")}}async function Sa(){const e=await il(),t=Na(),s={...e,...t,mock:t.mock??e.mock??!0,latency:t.latency??e.latency??0,error:t.error??e.error??0};try{localStorage.setItem(ka,JSON.stringify(s))}catch{}return s}const ll="modulepreload",cl=function(e){return"/maihouses/"+e},en={},dl=function(t,s,n){let a=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(s.map(c=>{if(c=cl(c),c in en)return;en[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":ll,d||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),d)return new Promise((p,f)=>{m.addEventListener("load",p),m.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return a.then(i=>{for(const l of i||[])l.status==="rejected"&&o(l.reason);return t().catch(o)})};let ns;const ul=new Uint8Array(16);function hl(){if(!ns&&(ns=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ns))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ns(ul)}const se=[];for(let e=0;e<256;++e)se.push((e+256).toString(16).slice(1));function ml(e,t=0){return se[e[t+0]]+se[e[t+1]]+se[e[t+2]]+se[e[t+3]]+"-"+se[e[t+4]]+se[e[t+5]]+"-"+se[e[t+6]]+se[e[t+7]]+"-"+se[e[t+8]]+se[e[t+9]]+"-"+se[e[t+10]]+se[e[t+11]]+se[e[t+12]]+se[e[t+13]]+se[e[t+14]]+se[e[t+15]]}const pl=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),tn={randomUUID:pl};function er(e,t,s){if(tn.randomUUID&&!e)return tn.randomUUID();e=e||{};const n=e.random||(e.rng||hl)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,ml(n)}function ue(e,t){try{console.debug("[track]",e,t||{})}catch{}}const he={QuietOn:"user.needs_quiet_space",QuietOff:"user.back_to_explore",QuietAutoOff:"user.quiet_space_timeout",QuietTurnUsed:"user.quiet_space_turn_used",WarmbarView:"ui.warmbar_view",WarmbarContinue:"ui.warmbar_click_continue",WarmbarDismiss:"ui.warmbar_click_dismiss",MoodPick:"user.feeling_set",NoteSaved:"user.reflects_on_viewing",DebriefGen:"user.debrief_mna_generated",DebriefSave:"user.debrief_saved",BudgetCopy:"user.seeks_budget_clarity",ELI5Open:"user.needs_plain_explain",RewriteGen:"user.needs_polite_message_generated",RewriteAdopt:"user.polite_message_adopted"},Ca="mai-quiet-mode-v1",fl=g.createContext(null);function sn(){try{const e=localStorage.getItem(Ca);return e?JSON.parse(e):{isQuiet:!1,untilTs:null,remainingTurns:null}}catch{return{isQuiet:!1,untilTs:null,remainingTurns:null}}}function gt(e){localStorage.setItem(Ca,JSON.stringify(e))}const gl=({children:e})=>{const[t,s]=g.useState(()=>sn()),n=g.useRef(null),a=g.useCallback(()=>{if(!t.isQuiet)return!1;const d=Date.now();return!(t.untilTs&&d>t.untilTs||t.remainingTurns!==null&&(t.remainingTurns??0)<=0)},[t]);g.useEffect(()=>{const d=Date.now();t.isQuiet&&t.untilTs&&d>t.untilTs&&(s({isQuiet:!1,untilTs:null,remainingTurns:null}),gt({isQuiet:!1,untilTs:null,remainingTurns:null}))},[t]),g.useEffect(()=>(n.current&&window.clearInterval(n.current),n.current=window.setInterval(()=>{const d=Date.now(),u=sn();u.isQuiet&&u.untilTs&&d>u.untilTs&&(s({isQuiet:!1,untilTs:null,remainingTurns:null}),gt({isQuiet:!1,untilTs:null,remainingTurns:null}))},3e4),()=>{n.current&&window.clearInterval(n.current)}),[]);const o=g.useCallback(d=>{const u=(d==null?void 0:d.minutes)??null,m=(d==null?void 0:d.turns)??10,p=d==null?void 0:d.reason,f=u?Date.now()+u*6e4:null,v={isQuiet:!0,...p&&{reason:p},untilTs:f,remainingTurns:m};s(v),gt(v),ue(he.QuietOn,{reason:p,minutes:u,turns:m})},[]),i=g.useCallback(()=>{const d={isQuiet:!1,untilTs:null,remainingTurns:null};s(d),gt(d),ue(he.QuietOff,{})},[]),l=g.useCallback(()=>{s(d=>{if(!d.isQuiet||d.remainingTurns===null)return d;const u=Math.max(0,(d.remainingTurns??0)-1),m={...d,remainingTurns:u};if(gt(m),u===0){const p={isQuiet:!1,untilTs:null,remainingTurns:null};return gt(p),ue(he.QuietAutoOff,{reason:"turns_exhausted"}),p}return m})},[]),c=g.useMemo(()=>({state:t,startQuiet:o,clearQuiet:i,decrementTurn:l,isActive:a}),[t,o,i,l,a]);return r.jsx(fl.Provider,{value:c,children:e})};function xl(){try{const e=localStorage.getItem("mai-quiet-mode-v1");if(!e)return!1;const t=JSON.parse(e),s=Date.now();return!(!t.isQuiet||t.untilTs&&s>t.untilTs||t.remainingTurns!==null&&(t.remainingTurns??0)<=0)}catch{return!1}}const za="mai-user-profile-v1",rn="mai-first-seen-ts",Ea="mai-warmbar-dismissed-date";function Gt(){try{const e=localStorage.getItem(za);return e?JSON.parse(e):{tags:[]}}catch{return{tags:[]}}}function Ia(e){localStorage.setItem(za,JSON.stringify(e))}function bl(e){const t=Gt(),s=new Set([...t.tags||[],...e].filter(Boolean));t.tags=Array.from(s).slice(0,8),Ia(t)}function vl(e){const t=Gt();t.lastMood=e,Ia(t)}function yl(){return localStorage.getItem(rn)?{isFirstVisit:!1}:(localStorage.setItem(rn,String(Date.now())),{isFirstVisit:!0})}function wl(){localStorage.setItem(Ea,Ta())}function jl(){return localStorage.getItem(Ea)===Ta()}function _l(e=3){return(Gt().tags||[]).slice(0,e)}function Ta(){const e=new Date,t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${s}-${n}`}function kl(e,t){const n=new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime(),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime();return Math.round((n-a)/864e5)}function Nl(e){if(!e)return null;const t=new Date;if(e.birthday){const s=nn(e.birthday,t,7);if(s)return s}if(e.move_in_date){const s=nn(e.move_in_date,t,7,"搬家");if(s)return s}return null}function nn(e,t,s=7,n){const[a,o,i]=e.split("-").map(d=>Number(d));if(!a||!o||!i)return null;const l=new Date(t.getFullYear(),o-1,i);return Math.abs(kl(l,t))<=s?n==="搬家"?"搬家一週年！":"生日快樂！":null}const Sl="你是邁房子的在地好鄰居助理（暱稱：邁邁）。語氣溫暖、尊重，台灣語境。回覆≤2行，先同理再資訊，避免推銷語。",Cl="你是邁邁。使用者啟用安靜模式，現在只想被陪伴。100% 傾聽與同理，回覆 1–2 句；嚴禁主動推薦任何房源/社區/廣告。";function zl(){const e=xl(),t=localStorage.getItem("mai-mood-v1")||"neutral",n=(Gt().tags||[]).slice(0,5),a=t==="stress"?"偵測到對方壓力較大：降低資訊量、避免指示語、用安撫口吻。":t==="rest"?"對方想放鬆：可以輕鬆、溫暖地聊天，不必急著提供建議。":"保持友善、清晰的語氣。",o=n.length?`使用者在意：${n.join("、")}。未被詢問時不要主動推任何清單，但可在相關話題出現時輕柔承接。`:"";return[e?Cl:Sl,a,o,"所有輸出需簡潔、真誠，拒絕銷售話術。"].filter(Boolean).join(`
`)}async function Ht(e,t,s){var c,d,u,m,p,f;const n=typeof t=="function"?t:void 0,a=typeof t=="object"?t:s,o=await fetch("/api/openai-proxy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[{role:"system",content:zl()},...e],temperature:(a==null?void 0:a.temperature)??.7,max_tokens:(a==null?void 0:a.max_tokens)??300,stream:!!n})});if(!o.ok)throw new Error(`LLM proxy error: ${o.status}`);if(n&&o.body){const v=o.body.getReader(),_=new TextDecoder;let y="";for(;;){const{done:k,value:O}=await v.read();if(k)break;const w=_.decode(O,{stream:!0}).split(`
`);for(const N of w)if(N.startsWith("data: ")){const S=N.slice(6);if(S==="[DONE]")continue;try{const T=JSON.parse(S),j=(u=(d=(c=T==null?void 0:T.choices)==null?void 0:c[0])==null?void 0:d.delta)==null?void 0:u.content;j&&(y+=j,n(j))}catch{}}}return y}const i=await o.json();return((f=(p=(m=i==null?void 0:i.choices)==null?void 0:m[0])==null?void 0:p.message)==null?void 0:f.content)??""}async function El(e,t){const s=(t==null?void 0:t.audience)==="owner"?"屋主":"仲介",n=(()=>{switch(t==null?void 0:t.intent){case"view":return"預約看房";case"detail":return"詢問物件細節";case"pet":return"確認是否可養寵物";case"price":return"詢問價格與議價空間";default:return"一般詢問"}})(),a=`請將以下訊息改寫成「禮貌、簡短、尊重」的兩個版本（V1/V2），情境：要發給「${s}」，目的：「${n}」。維持原意，避免命令語：
---
${e}
---
格式：
V1：...
V2：...`;return Ht([{role:"user",content:a}],{max_tokens:220})}async function Il(e){const t=`以下是一段對物件的主觀感受，請以同理的語氣回聲，僅 1–2 句、避免建議：
「${e}」`;return Ht([{role:"user",content:t}],{max_tokens:80})}async function Tl(e){const t=`請用白話、非法律意見的方式解釋這段名詞/條款，列出「重點」與「注意」各1–2點，總長≤2行：
${e}`;return Ht([{role:"user",content:t}],{max_tokens:120})}async function Al(e,t,s){const n=`我看完一間房，請把重點分成「必要(Must)」「加分(Nice)」「不要(Avoid)」各2–3點，總長≤2行；並在最後一行輸出 #tags: 以逗號分隔 3–5 個關鍵字（避免人名/品牌）。
喜歡：${e}
困擾：${t}
下一步：${s}`;return Ht([{role:"user",content:n}],{max_tokens:160})}let Aa=er();const Ra=()=>Aa;async function $a(e,t={}){const s=await Sa(),n=`${s.apiBaseUrl}${e}`,a=(t.method||"GET").toUpperCase(),o={Accept:"application/json","X-API-Version":"v1","X-App-Version":s.appVersion,"X-Session-Id":Aa,"X-Request-Id":er(),"Accept-Language":"zh-Hant-TW"},i=(()=>{const u=t.headers;if(!u)return{};if(u instanceof Headers){const m={};for(const[p,f]of u)m[p]=f;return m}return Array.isArray(u)?Object.fromEntries(u):u})();a==="POST"&&!i["Idempotency-Key"]&&!i["idempotency-key"]&&(i["Idempotency-Key"]=er());const l={...o,...i};if(s.mock){const{mockHandler:u}=await dl(async()=>{const{mockHandler:m}=await import("./index-DekheYw5.js");return{mockHandler:m}},__vite__mapDeps([0,1,2,3]));return u(e,{...t,headers:l})}const c=new AbortController,d=setTimeout(()=>c.abort(),8e3);try{const u=await fetch(n,{...t,headers:l,signal:c.signal});return u.ok?{ok:!0,data:await u.json()}:{ok:!1,error:{code:"API_ERROR",message:"API 請求失敗"}}}catch(u){return(u==null?void 0:u.name)==="AbortError"?{ok:!1,error:{code:"NETWORK_TIMEOUT",message:"請求超時"}}:{ok:!1,error:{code:"NETWORK_ERROR",message:u.message}}}finally{clearTimeout(d)}}const Pa=()=>$a("/api/v1/meta");function Rl({config:e}){const[t,s]=g.useState(!0),[n,a]=g.useState(!!e.mock),[o,i]=g.useState(e.latency??0),[l,c]=g.useState(e.error??0),[d,u]=g.useState(e.q??""),[m,p]=g.useState("—"),[f,v]=g.useState(e.mockSeed??"");if(g.useEffect(()=>{Pa().then(k=>p(k.ok&&k.data?k.data.backendVersion:"—"))},[]),!t)return null;const _=()=>{const k={...e,mock:n,latency:o,error:l,q:d,mockSeed:f,devtools:"1"};try{localStorage.setItem("maihouse_config",JSON.stringify(k))}catch{}location.reload()},y=()=>{const k=String(Date.now());v(k);try{localStorage.setItem("maihouse_config",JSON.stringify({...e,mockSeed:k,mock:n,latency:o,error:l,q:d,devtools:"1"}))}catch{}location.reload()};return r.jsxs("aside",{className:"fixed bottom-4 right-4 z-[var(--z-overlay)] w-[320px] rounded-[var(--r-lg)] bg-white p-4 text-sm shadow-[var(--shadow-card)]",children:[r.jsx("div",{className:"mb-2 font-medium",children:"Developer HUD"}),r.jsxs("div",{className:"space-y-1 text-[var(--text-secondary)]",children:[r.jsxs("div",{children:["API：",e.apiBaseUrl]}),r.jsxs("div",{children:["App：",e.appVersion]}),r.jsxs("div",{children:["Backend：",m]}),r.jsxs("div",{children:["Session：",Ra()]}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",checked:n,onChange:k=>a(k.target.checked)})," Mock"]}),r.jsxs("label",{className:"flex items-center gap-2",children:["Latency",r.jsx("input",{className:"w-20 rounded border p-1",type:"number",value:o,onChange:k=>i(+k.target.value||0)})]}),r.jsxs("label",{className:"flex items-center gap-2",children:["Error",r.jsx("input",{className:"w-20 rounded border p-1",step:"0.1",type:"number",value:l,onChange:k=>c(+k.target.value||0)})]}),r.jsxs("label",{className:"flex items-center gap-2",children:["q ",r.jsx("input",{className:"flex-1 rounded border p-1",value:d,onChange:k=>u(k.target.value)})]}),r.jsxs("label",{className:"flex items-center gap-2",children:["seed",r.jsx("input",{className:"flex-1 rounded border p-1",value:f,onChange:k=>v(k.target.value)})]})]}),r.jsxs("div",{className:"mt-3 flex justify-between",children:[r.jsx("button",{className:"rounded-[var(--r-pill)] bg-[var(--neutral-100)] px-3 py-1",onClick:()=>s(!1),children:"關閉"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{className:"rounded-[var(--r-pill)] bg-[var(--neutral-300)] px-3 py-1",onClick:y,children:"🎲 換數據"}),r.jsx("button",{className:"rounded-[var(--r-pill)] bg-[var(--brand)] px-3 py-1 text-[var(--brand-fg)]",onClick:_,children:"更新"})]})]})]})}const Oa="uag_queue",tr=1e4,$l=200,U=globalThis.__UAG__||(globalThis.__UAG__={queue:[],backoff:1e4,attempts:0});try{U.queue=JSON.parse(localStorage.getItem(Oa)||"[]")}catch{U.queue=[]}const Ma=()=>{try{localStorage.setItem(Oa,JSON.stringify(U.queue.slice(-tr)))}catch{}},yr=3e5;async function Fa(e){var s;const t=await $a("/api/v1/uag/events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){const n=new Set(e.map(a=>a.requestId));U.queue=U.queue.filter(a=>!n.has(a.requestId)),Ma(),U.attempts=0,U.backoff=1e4}else{U.attempts++;const n=(s=t==null?void 0:t.data)==null?void 0:s.retryAfterMs;U.backoff=Math.min(n??U.backoff*2,yr)}}function xs(){U.timer&&clearTimeout(U.timer),U.timer=setTimeout(Pl,U.backoff)}function Pl(){if(U.queue.length){const e=U.queue.slice(0,$l);Fa(e).catch(()=>{U.attempts++,U.backoff=Math.min(U.backoff*2,yr)}).finally(xs)}else xs()}xs();function Ol(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.floor(Math.random()*16);return(e==="x"?t:t&3|8).toString(16)})}function Kt(e,t,s){if(!(e!=null&&e.trim())||!(t!=null&&t.trim())){console.warn("[UAG] 無效的事件或頁面名稱，已忽略上報");return}const n={event:e,page:t,sessionId:Ra(),userId:null,ts:new Date().toISOString(),meta:{origin:"gh-pages"},requestId:Ol()};s&&(n.targetId=s),U.queue.push(n),U.queue.length>tr&&(U.queue=U.queue.slice(-tr)),Ma(),Fa([n]).catch(()=>{U.attempts++,U.backoff=Math.min(U.backoff*2,yr),xs()})}const Ml=({showSlogan:e=!0,className:t="",onClick:s,href:n="/maihouses/"})=>{const a=()=>r.jsxs("div",{className:`flex items-center gap-3 group cursor-pointer ${t}`,children:[r.jsxs("div",{className:"relative w-[42px] h-[42px] bg-gradient-to-br from-brand-700 to-[#005282] rounded-xl flex items-center justify-center shadow-lg shadow-brand-700/20 overflow-hidden transition-all duration-300 group-hover:scale-105 group-hover:shadow-brand-700/30",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-transparent via-white/10 to-transparent translate-y-full group-hover:translate-y-0 transition-transform duration-700 ease-out"}),r.jsxs("svg",{className:"w-[22px] h-[22px] text-white relative z-10 drop-shadow-sm transform transition-transform duration-300 group-hover:-translate-y-[1px]",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9.5L12 3L21 9.5V20.5C21 21.0523 20.5523 21.5 20 21.5H4C3.44772 21.5 3 21.0523 3 20.5V9.5Z"}),r.jsx("path",{d:"M9 21.5V13H15V21.5"})]}),r.jsx("div",{className:"absolute top-2 right-2 w-1.5 h-1.5 bg-[#FF6B6B] rounded-full shadow-[0_0_0_1.5px_#004E7C]"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex items-baseline gap-1",children:r.jsx("span",{className:"text-[24px] font-bold font-serif text-brand-700 tracking-wide leading-none",children:"邁房子"})}),e&&r.jsx("div",{className:"hidden sm:flex items-center ml-3 pl-3 border-l-2 border-brand-100/80 h-5",children:r.jsx("span",{className:"text-[15px] font-bold text-brand-500 tracking-[0.15em] uppercase group-hover:text-brand-700 transition-colors leading-none pt-[1px]",children:"讓家，不只是地址"})})]})]});return n?r.jsx("a",{href:n,onClick:s,className:"no-underline",children:r.jsx(a,{})}):r.jsx("div",{onClick:s,children:r.jsx(a,{})})};function Da({onOpenAIStudio:e}){return r.jsxs(r.Fragment,{children:[r.jsx("header",{className:"sticky top-0 z-50 bg-white/95 backdrop-blur-sm border-b border-brand-100 shadow-sm transition-all",children:r.jsxs("div",{className:"max-w-[1120px] mx-auto px-4 h-16 flex items-center justify-between",children:[r.jsx(Ml,{showSlogan:!0,onClick:()=>window.scrollTo({top:0,behavior:"smooth"})}),r.jsxs("nav",{className:"flex items-center gap-1 md:gap-2","aria-label":"主要動作",children:[r.jsxs("a",{href:"/maihouses/property.html",className:"hidden md:flex items-center gap-2 px-4 py-2.5 rounded-xl text-brand-700 font-bold text-[15px] hover:bg-brand-50/80 hover:text-brand-600 transition-all active:scale-[0.98]",children:[r.jsx(Lo,{size:18,strokeWidth:2.5,className:"opacity-80"}),r.jsx("span",{children:"房地產列表"})]}),r.jsxs("a",{href:"/maihouses/auth.html?mode=login",className:"hidden md:flex items-center gap-2 px-4 py-2.5 rounded-xl text-brand-700 font-bold text-[15px] hover:bg-brand-50/80 hover:text-brand-600 transition-all active:scale-[0.98]",children:[r.jsx(Zo,{size:18,strokeWidth:2.5,className:"opacity-80"}),r.jsx("span",{children:"登入"})]}),r.jsxs("a",{href:"/maihouses/auth.html?mode=signup",className:"ml-1 flex items-center gap-2 px-5 py-2.5 rounded-xl bg-brand-700 text-white font-bold text-[15px] shadow-md shadow-brand-700/10 border border-transparent hover:bg-brand-600 hover:shadow-lg hover:shadow-brand-700/20 hover:-translate-y-0.5 transition-all active:scale-[0.98]",children:[r.jsx(Uo,{size:18,strokeWidth:2.5}),r.jsx("span",{children:"免費註冊"})]})]})]})}),r.jsx("div",{className:"relative bg-brand-50 border-b border-brand-100/50",children:r.jsx("div",{className:"max-w-[1120px] mx-auto relative z-10 pt-24 pb-6 px-4",children:r.jsxs("div",{className:"max-w-3xl mx-auto relative",children:[r.jsxs("div",{className:"absolute -top-[44px] right-[5%] md:right-[10%] z-0 pointer-events-none select-none animate-float md:animate-float-desktop",children:[r.jsxs("div",{className:"absolute bottom-[92%] right-[55%] w-[260px] whitespace-normal md:w-auto md:max-w-none md:whitespace-nowrap md:bottom-[94%] md:right-[65%] bg-white border-2 border-brand-100 px-5 py-2 md:py-3 rounded-2xl rounded-br-none shadow-lg animate-fadeIn origin-bottom-right",children:[r.jsxs("p",{className:"text-[11px] md:text-sm font-bold text-ink-700 leading-relaxed text-left",children:["買房這麼大的事，先到 ",r.jsx("span",{className:"text-brand-700 font-black",children:"邁鄰居"}),"，為未來的家查口碑、找評價，最放心！"]}),r.jsx("div",{className:"absolute -bottom-2.5 right-3 w-5 h-5 bg-white border-r-2 border-b-2 border-brand-100 transform rotate-45"})]}),r.jsx("div",{className:"w-20 h-20 md:w-24 md:h-24 relative z-10",children:r.jsxs("svg",{viewBox:"0 0 200 240",className:"w-full h-full drop-shadow-sm",children:[r.jsx("path",{d:"M 85 40 L 85 15 L 100 30 L 115 15 L 115 40",stroke:"#00385a",strokeWidth:"5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M 40 80 L 100 40 L 160 80",stroke:"#00385a",strokeWidth:"6",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("rect",{x:"55",y:"80",width:"90",height:"100",stroke:"#00385a",strokeWidth:"6",fill:"#F6F9FF",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M 78 110 Q 85 105 92 110",stroke:"#00385a",strokeWidth:"4",fill:"none",strokeLinecap:"round"}),r.jsx("path",{d:"M 108 110 Q 115 105 122 110",stroke:"#00385a",strokeWidth:"4",fill:"none",strokeLinecap:"round"}),r.jsx("circle",{cx:"85",cy:"125",r:"4",stroke:"#00385a",strokeWidth:"3",fill:"none"}),r.jsx("circle",{cx:"115",cy:"125",r:"4",stroke:"#00385a",strokeWidth:"3",fill:"none"}),r.jsx("path",{d:"M 55 130 L 35 100",stroke:"#00385a",strokeWidth:"5",fill:"none",strokeLinecap:"round"}),r.jsx("path",{d:"M 145 130 L 165 100",stroke:"#00385a",strokeWidth:"5",fill:"none",strokeLinecap:"round"})]})})]}),r.jsx("div",{className:"relative group z-20",children:r.jsxs("div",{className:"flex items-center h-[60px] pl-[28px] pr-2 rounded-full transition-all duration-300 bg-white border border-brand-100 shadow-[0_8px_30px_rgba(0,56,90,0.08)] group-hover:shadow-[0_12px_40px_rgba(0,56,90,0.12)] focus-within:border-brand-300 focus-within:ring-4 focus-within:ring-brand-50",children:[r.jsx("div",{className:"pr-4 text-gray-400 group-focus-within:text-gray-600 transition-colors",children:r.jsx(Bo,{size:22,strokeWidth:2.5})}),r.jsx("input",{type:"text",placeholder:"找評價最高的社區、捷運站周邊好屋...",className:"w-full h-full bg-transparent text-gray-700 font-bold text-lg placeholder:text-gray-400 placeholder:font-medium outline-none"}),r.jsx("button",{className:"h-[46px] px-8 bg-brand-700 text-white rounded-full font-bold text-base hover:bg-brand-600 transition-colors flex items-center justify-center tracking-wide shadow-md hover:shadow-lg active:translate-y-px whitespace-nowrap",children:"搜尋"})]})}),r.jsx("div",{className:"grid grid-cols-3 gap-2 mt-6 relative z-10",children:["社區評價","房仲專區","邁鄰居"].map(t=>{const s=t==="社區評價"?"/maihouses/community-wall_mvp.html":t==="房仲專區"?"https://maihouses.vercel.app/maihouses/uag":"#",n=t==="房仲專區"?"_blank":void 0;return r.jsx("a",{href:s,target:n,rel:n?"noopener noreferrer":void 0,className:"flex items-center justify-center py-3 rounded-2xl bg-brand-700 border border-brand-700 text-white font-bold text-lg tracking-wide shadow-sm transition-all duration-200 hover:bg-brand-600 hover:shadow-md hover:-translate-y-0.5 active:scale-[0.98]",children:t},t)})})]})})})]})}function Fl(){return r.jsxs("svg",{viewBox:"0 0 200 240",className:"w-full h-full drop-shadow-sm transform hover:scale-105 transition-transform duration-300 text-brand",children:[r.jsx("path",{d:"M 85 40 L 85 15 L 100 30 L 115 15 L 115 40",stroke:"currentColor",strokeWidth:"5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M 40 80 L 100 40 L 160 80",stroke:"currentColor",strokeWidth:"6",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("rect",{x:"55",y:"80",width:"90",height:"100",stroke:"currentColor",strokeWidth:"6",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M 78 110 Q 85 105 92 110",stroke:"currentColor",strokeWidth:"4",fill:"none",strokeLinecap:"round"}),r.jsx("path",{d:"M 108 110 Q 115 105 122 110",stroke:"currentColor",strokeWidth:"4",fill:"none",strokeLinecap:"round"}),r.jsx("circle",{cx:"85",cy:"125",r:"4",stroke:"currentColor",strokeWidth:"3",fill:"none"}),r.jsx("circle",{cx:"115",cy:"125",r:"4",stroke:"currentColor",strokeWidth:"3",fill:"none"}),r.jsx("path",{d:"M 55 130 L 25 110",stroke:"currentColor",strokeWidth:"5",fill:"none",strokeLinecap:"round"}),r.jsx("path",{d:"M 145 130 L 175 110",stroke:"currentColor",strokeWidth:"5",fill:"none",strokeLinecap:"round"}),r.jsx("path",{d:"M 85 180 L 85 215 L 75 215",stroke:"currentColor",strokeWidth:"5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M 115 180 L 115 215 L 125 215",stroke:"currentColor",strokeWidth:"5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})]})}const an=[{id:"01",title:"已電聯",desc:"紀錄談話內容",icon:hr},{id:"02",title:"已帶看",desc:"賞屋重點紀錄",icon:qo},{id:"03",title:"已出價",desc:"紀錄價格條件",icon:Yn},{id:"04",title:"已斡旋",desc:"議價過程紀錄",icon:Wo},{id:"05",title:"已成交",desc:"貸款相關事項",icon:Vo},{id:"06",title:"已交屋",desc:"確認圓滿交屋",icon:Qo}],Dl=[{id:"J",name:"J***｜景安和院 住戶",rating:5,tags:["#物業/管理"],content:"公設維護得乾淨，假日草皮有人整理。之前反映停車動線，管委會一週內就公告改善。"},{id:"W",name:"W***｜松濤苑 住戶",rating:4,tags:["#噪音"],content:"住起來整體舒服，但臨路面向在上下班尖峰車聲明顯，喜靜者建議考慮中高樓層。"},{id:"L",name:"L***｜遠揚柏悅 住戶",rating:4,tags:["#漏水/壁癌"],content:"頂樓排水設計不錯，颱風天沒有積水。不過垃圾車時間稍晚，偶爾有下水道味。"},{id:"A",name:"A***｜華固名邸 住戶",rating:5,tags:["#物業/管理"],content:"管理員很負責，包裹收發與公告都有效率；電梯偶爾故障但維修速度快。"},{id:"H",name:"H***｜寶輝花園廣場 住戶",rating:3,tags:["#停車/車位"],content:"地下室車位轉彎半徑偏小，新手要多注意；平日夜間社區整體很安靜。"},{id:"K",name:"K***｜潤泰峰匯 住戶",rating:4,tags:["#採光/日照"],content:"採光好、通風佳，夏天不會太悶熱；但西曬戶下午還是會稍微熱一些。"}],Ll=[{id:1,image:"https://images.unsplash.com/photo-1600585154526-990dced4db0d?q=80&w=1600&auto=format&fit=crop",badge:"捷運 5 分鐘",title:"新板特區｜三房含車位，採光面中庭",tags:["34.2 坪","3 房 2 廳","高樓層"],price:"1,288",location:"新北市板橋區 · 中山路一段",reviews:[{avatar:"A",name:"王小姐",role:"3年住戶",tag:"管理到位",text:"管委反應快，公設打理乾淨，晚上也安靜好睡。"},{avatar:"B",name:"林先生",role:"屋主",tag:"車位好停",text:"坡道寬、指示清楚，下班回家不太需要繞圈找位。"}]},{id:2,image:"https://images.unsplash.com/photo-1575517111478-7f6afd0973db?q=80&w=1600&auto=format&fit=crop",badge:"社區中庭",title:"松山民生社區｜邊間大兩房，採光佳",tags:["28.6 坪","2 房 2 廳","可寵物"],price:"1,052",location:"台北市松山區 · 民生東路五段",reviews:[{avatar:"C",name:"陳太太",role:"5年住戶",tag:"鄰里友善",text:"警衛熱心、包裹代收確實，社區群組很活躍。"},{avatar:"D",name:"賴先生",role:"上班族",tag:"生活便利",text:"走路 3 分鐘有超市與市場，下班買菜很方便。"}]},{id:3,image:"https://images.unsplash.com/photo-1515263487990-61b07816b324?q=80&w=1600&auto=format&fit=crop",badge:"學區宅",title:"新店七張｜電梯二房，附機車位",tags:["22.1 坪","2 房 1 廳","低公設比"],price:"838",location:"新北市新店區 · 北新路二段",reviews:[{avatar:"E",name:"張小姐",role:"上班族",tag:"通勤方便",text:"步行到捷運七張站約 6 分鐘，雨天也有騎樓遮蔽。"},{avatar:"F",name:"李先生",role:"家長",tag:"學區完整",text:"附近幼兒園到國中選擇多，放學接送動線順。"}]},{id:4,image:"https://images.unsplash.com/photo-1564013799919-ab600027ffc6?q=80&w=1600&auto=format&fit=crop",badge:"河岸景觀",title:"大直美堤｜景觀三房，沁涼通風",tags:["36.8 坪","3 房 2 廳","邊間"],price:"1,560",location:"台北市中山區 · 敦化北路",reviews:[{avatar:"G",name:"蘇先生",role:"住戶",tag:"景觀佳",text:"客廳看河景很放鬆，夏天自然風就很涼。"},{avatar:"H",name:"高小姐",role:"通勤族",tag:"交通便利",text:"離公車站 2 分鐘，轉乘捷運時間可控。"}]},{id:5,image:"https://images.unsplash.com/photo-1501183638710-841dd1904471?q=80&w=1600&auto=format&fit=crop",badge:"社區花園",title:"內湖東湖｜雙面採光，小家庭首選",tags:["27.4 坪","2 房 2 廳","含機車位"],price:"968",location:"台北市內湖區 · 康寧路三段",reviews:[{avatar:"I",name:"許太太",role:"家長",tag:"公園多",text:"社區旁邊就有親子公園，假日散步很方便。"},{avatar:"J",name:"黃先生",role:"工程師",tag:"環境安靜",text:"臨巷內，夜間車流少，對面鄰居素質也不錯。"}]},{id:6,image:"https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?q=80&w=1600&auto=format&fit=crop",badge:"捷運生活圈",title:"中和橋和站｜採光兩房，低管理費",tags:["24.9 坪","2 房 1 廳","社區新"],price:"898",location:"新北市中和區 · 中和路",reviews:[{avatar:"K",name:"簡小姐",role:"新婚",tag:"費用透明",text:"管委會公告清楚，管理費與車位費用都公開透明。"},{avatar:"L",name:"羅先生",role:"通勤族",tag:"通勤穩定",text:"尖峰等車可控，公車轉乘動線順，延誤較少。"}]}];function La(e){var t,s,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(s=La(e[t]))&&(n&&(n+=" "),n+=s)}else for(s in e)e[s]&&(n&&(n+=" "),n+=s);return n}function Zl(){for(var e,t,s=0,n="",a=arguments.length;s<a;s++)(e=arguments[s])&&(t=La(e))&&(n&&(n+=" "),n+=t);return n}const Ul=(e,t)=>{const s=new Array(e.length+t.length);for(let n=0;n<e.length;n++)s[n]=e[n];for(let n=0;n<t.length;n++)s[e.length+n]=t[n];return s},Bl=(e,t)=>({classGroupId:e,validator:t}),Za=(e=new Map,t=null,s)=>({nextPart:e,validators:t,classGroupId:s}),bs="-",on=[],ql="arbitrary..",Wl=e=>{const t=Ql(e),{conflictingClassGroups:s,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:i=>{if(i.startsWith("[")&&i.endsWith("]"))return Vl(i);const l=i.split(bs),c=l[0]===""&&l.length>1?1:0;return Ua(l,c,t)},getConflictingClassGroupIds:(i,l)=>{if(l){const c=n[i],d=s[i];return c?d?Ul(d,c):c:d||on}return s[i]||on}}},Ua=(e,t,s)=>{if(e.length-t===0)return s.classGroupId;const a=e[t],o=s.nextPart.get(a);if(o){const d=Ua(e,t+1,o);if(d)return d}const i=s.validators;if(i===null)return;const l=t===0?e.join(bs):e.slice(t).join(bs),c=i.length;for(let d=0;d<c;d++){const u=i[d];if(u.validator(l))return u.classGroupId}},Vl=e=>e.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const t=e.slice(1,-1),s=t.indexOf(":"),n=t.slice(0,s);return n?ql+n:void 0})(),Ql=e=>{const{theme:t,classGroups:s}=e;return Gl(s,t)},Gl=(e,t)=>{const s=Za();for(const n in e){const a=e[n];wr(a,s,n,t)}return s},wr=(e,t,s,n)=>{const a=e.length;for(let o=0;o<a;o++){const i=e[o];Hl(i,t,s,n)}},Hl=(e,t,s,n)=>{if(typeof e=="string"){Kl(e,t,s);return}if(typeof e=="function"){Jl(e,t,s,n);return}Yl(e,t,s,n)},Kl=(e,t,s)=>{const n=e===""?t:Ba(t,e);n.classGroupId=s},Jl=(e,t,s,n)=>{if(Xl(e)){wr(e(n),t,s,n);return}t.validators===null&&(t.validators=[]),t.validators.push(Bl(s,e))},Yl=(e,t,s,n)=>{const a=Object.entries(e),o=a.length;for(let i=0;i<o;i++){const[l,c]=a[i];wr(c,Ba(t,l),s,n)}},Ba=(e,t)=>{let s=e;const n=t.split(bs),a=n.length;for(let o=0;o<a;o++){const i=n[o];let l=s.nextPart.get(i);l||(l=Za(),s.nextPart.set(i,l)),s=l}return s},Xl=e=>"isThemeGetter"in e&&e.isThemeGetter===!0,ec=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,s=Object.create(null),n=Object.create(null);const a=(o,i)=>{s[o]=i,t++,t>e&&(t=0,n=s,s=Object.create(null))};return{get(o){let i=s[o];if(i!==void 0)return i;if((i=n[o])!==void 0)return a(o,i),i},set(o,i){o in s?s[o]=i:a(o,i)}}},sr="!",ln=":",tc=[],cn=(e,t,s,n,a)=>({modifiers:e,hasImportantModifier:t,baseClassName:s,maybePostfixModifierPosition:n,isExternal:a}),sc=e=>{const{prefix:t,experimentalParseClassName:s}=e;let n=a=>{const o=[];let i=0,l=0,c=0,d;const u=a.length;for(let _=0;_<u;_++){const y=a[_];if(i===0&&l===0){if(y===ln){o.push(a.slice(c,_)),c=_+1;continue}if(y==="/"){d=_;continue}}y==="["?i++:y==="]"?i--:y==="("?l++:y===")"&&l--}const m=o.length===0?a:a.slice(c);let p=m,f=!1;m.endsWith(sr)?(p=m.slice(0,-1),f=!0):m.startsWith(sr)&&(p=m.slice(1),f=!0);const v=d&&d>c?d-c:void 0;return cn(o,f,p,v)};if(t){const a=t+ln,o=n;n=i=>i.startsWith(a)?o(i.slice(a.length)):cn(tc,!1,i,void 0,!0)}if(s){const a=n;n=o=>s({className:o,parseClassName:a})}return n},rc=e=>{const t=new Map;return e.orderSensitiveModifiers.forEach((s,n)=>{t.set(s,1e6+n)}),s=>{const n=[];let a=[];for(let o=0;o<s.length;o++){const i=s[o],l=i[0]==="[",c=t.has(i);l||c?(a.length>0&&(a.sort(),n.push(...a),a=[]),n.push(i)):a.push(i)}return a.length>0&&(a.sort(),n.push(...a)),n}},nc=e=>({cache:ec(e.cacheSize),parseClassName:sc(e),sortModifiers:rc(e),...Wl(e)}),ac=/\s+/,oc=(e,t)=>{const{parseClassName:s,getClassGroupId:n,getConflictingClassGroupIds:a,sortModifiers:o}=t,i=[],l=e.trim().split(ac);let c="";for(let d=l.length-1;d>=0;d-=1){const u=l[d],{isExternal:m,modifiers:p,hasImportantModifier:f,baseClassName:v,maybePostfixModifierPosition:_}=s(u);if(m){c=u+(c.length>0?" "+c:c);continue}let y=!!_,k=n(y?v.substring(0,_):v);if(!k){if(!y){c=u+(c.length>0?" "+c:c);continue}if(k=n(v),!k){c=u+(c.length>0?" "+c:c);continue}y=!1}const O=p.length===0?"":p.length===1?p[0]:o(p).join(":"),z=f?O+sr:O,w=z+k;if(i.indexOf(w)>-1)continue;i.push(w);const N=a(k,y);for(let S=0;S<N.length;++S){const T=N[S];i.push(z+T)}c=u+(c.length>0?" "+c:c)}return c},ic=(...e)=>{let t=0,s,n,a="";for(;t<e.length;)(s=e[t++])&&(n=qa(s))&&(a&&(a+=" "),a+=n);return a},qa=e=>{if(typeof e=="string")return e;let t,s="";for(let n=0;n<e.length;n++)e[n]&&(t=qa(e[n]))&&(s&&(s+=" "),s+=t);return s},lc=(e,...t)=>{let s,n,a,o;const i=c=>{const d=t.reduce((u,m)=>m(u),e());return s=nc(d),n=s.cache.get,a=s.cache.set,o=l,l(c)},l=c=>{const d=n(c);if(d)return d;const u=oc(c,s);return a(c,u),u};return o=i,(...c)=>o(ic(...c))},cc=[],Y=e=>{const t=s=>s[e]||cc;return t.isThemeGetter=!0,t},Wa=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Va=/^\((?:(\w[\w-]*):)?(.+)\)$/i,dc=/^\d+\/\d+$/,uc=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,hc=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,mc=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,pc=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,fc=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,xt=e=>dc.test(e),F=e=>!!e&&!Number.isNaN(Number(e)),Me=e=>!!e&&Number.isInteger(Number(e)),As=e=>e.endsWith("%")&&F(e.slice(0,-1)),Ie=e=>uc.test(e),gc=()=>!0,xc=e=>hc.test(e)&&!mc.test(e),Qa=()=>!1,bc=e=>pc.test(e),vc=e=>fc.test(e),yc=e=>!E(e)&&!I(e),wc=e=>$t(e,Ka,Qa),E=e=>Wa.test(e),Ye=e=>$t(e,Ja,xc),Rs=e=>$t(e,Sc,F),dn=e=>$t(e,Ga,Qa),jc=e=>$t(e,Ha,vc),as=e=>$t(e,Ya,bc),I=e=>Va.test(e),Ot=e=>Pt(e,Ja),_c=e=>Pt(e,Cc),un=e=>Pt(e,Ga),kc=e=>Pt(e,Ka),Nc=e=>Pt(e,Ha),os=e=>Pt(e,Ya,!0),$t=(e,t,s)=>{const n=Wa.exec(e);return n?n[1]?t(n[1]):s(n[2]):!1},Pt=(e,t,s=!1)=>{const n=Va.exec(e);return n?n[1]?t(n[1]):s:!1},Ga=e=>e==="position"||e==="percentage",Ha=e=>e==="image"||e==="url",Ka=e=>e==="length"||e==="size"||e==="bg-size",Ja=e=>e==="length",Sc=e=>e==="number",Cc=e=>e==="family-name",Ya=e=>e==="shadow",zc=()=>{const e=Y("color"),t=Y("font"),s=Y("text"),n=Y("font-weight"),a=Y("tracking"),o=Y("leading"),i=Y("breakpoint"),l=Y("container"),c=Y("spacing"),d=Y("radius"),u=Y("shadow"),m=Y("inset-shadow"),p=Y("text-shadow"),f=Y("drop-shadow"),v=Y("blur"),_=Y("perspective"),y=Y("aspect"),k=Y("ease"),O=Y("animate"),z=()=>["auto","avoid","all","avoid-page","page","left","right","column"],w=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],N=()=>[...w(),I,E],S=()=>["auto","hidden","clip","visible","scroll"],T=()=>["auto","contain","none"],j=()=>[I,E,c],Z=()=>[xt,"full","auto",...j()],P=()=>[Me,"none","subgrid",I,E],J=()=>["auto",{span:["full",Me,I,E]},Me,I,E],pe=()=>[Me,"auto",I,E],ye=()=>["auto","min","max","fr",I,E],ft=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],V=()=>["start","end","center","stretch","center-safe","end-safe"],we=()=>["auto",...j()],Ke=()=>[xt,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...j()],$=()=>[e,I,E],Ar=()=>[...w(),un,dn,{position:[I,E]}],Rr=()=>["no-repeat",{repeat:["","x","y","space","round"]}],$r=()=>["auto","cover","contain",kc,wc,{size:[I,E]}],Es=()=>[As,Ot,Ye],ae=()=>["","none","full",d,I,E],fe=()=>["",F,Ot,Ye],Yt=()=>["solid","dashed","dotted","double"],Pr=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ee=()=>[F,As,un,dn],Or=()=>["","none",v,I,E],Xt=()=>["none",F,I,E],es=()=>["none",F,I,E],Is=()=>[F,I,E],ts=()=>[xt,"full",...j()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Ie],breakpoint:[Ie],color:[gc],container:[Ie],"drop-shadow":[Ie],ease:["in","out","in-out"],font:[yc],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Ie],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Ie],shadow:[Ie],spacing:["px",F],text:[Ie],"text-shadow":[Ie],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",xt,E,I,y]}],container:["container"],columns:[{columns:[F,E,I,l]}],"break-after":[{"break-after":z()}],"break-before":[{"break-before":z()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:N()}],overflow:[{overflow:S()}],"overflow-x":[{"overflow-x":S()}],"overflow-y":[{"overflow-y":S()}],overscroll:[{overscroll:T()}],"overscroll-x":[{"overscroll-x":T()}],"overscroll-y":[{"overscroll-y":T()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:Z()}],"inset-x":[{"inset-x":Z()}],"inset-y":[{"inset-y":Z()}],start:[{start:Z()}],end:[{end:Z()}],top:[{top:Z()}],right:[{right:Z()}],bottom:[{bottom:Z()}],left:[{left:Z()}],visibility:["visible","invisible","collapse"],z:[{z:[Me,"auto",I,E]}],basis:[{basis:[xt,"full","auto",l,...j()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[F,xt,"auto","initial","none",E]}],grow:[{grow:["",F,I,E]}],shrink:[{shrink:["",F,I,E]}],order:[{order:[Me,"first","last","none",I,E]}],"grid-cols":[{"grid-cols":P()}],"col-start-end":[{col:J()}],"col-start":[{"col-start":pe()}],"col-end":[{"col-end":pe()}],"grid-rows":[{"grid-rows":P()}],"row-start-end":[{row:J()}],"row-start":[{"row-start":pe()}],"row-end":[{"row-end":pe()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":ye()}],"auto-rows":[{"auto-rows":ye()}],gap:[{gap:j()}],"gap-x":[{"gap-x":j()}],"gap-y":[{"gap-y":j()}],"justify-content":[{justify:[...ft(),"normal"]}],"justify-items":[{"justify-items":[...V(),"normal"]}],"justify-self":[{"justify-self":["auto",...V()]}],"align-content":[{content:["normal",...ft()]}],"align-items":[{items:[...V(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...V(),{baseline:["","last"]}]}],"place-content":[{"place-content":ft()}],"place-items":[{"place-items":[...V(),"baseline"]}],"place-self":[{"place-self":["auto",...V()]}],p:[{p:j()}],px:[{px:j()}],py:[{py:j()}],ps:[{ps:j()}],pe:[{pe:j()}],pt:[{pt:j()}],pr:[{pr:j()}],pb:[{pb:j()}],pl:[{pl:j()}],m:[{m:we()}],mx:[{mx:we()}],my:[{my:we()}],ms:[{ms:we()}],me:[{me:we()}],mt:[{mt:we()}],mr:[{mr:we()}],mb:[{mb:we()}],ml:[{ml:we()}],"space-x":[{"space-x":j()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":j()}],"space-y-reverse":["space-y-reverse"],size:[{size:Ke()}],w:[{w:[l,"screen",...Ke()]}],"min-w":[{"min-w":[l,"screen","none",...Ke()]}],"max-w":[{"max-w":[l,"screen","none","prose",{screen:[i]},...Ke()]}],h:[{h:["screen","lh",...Ke()]}],"min-h":[{"min-h":["screen","lh","none",...Ke()]}],"max-h":[{"max-h":["screen","lh",...Ke()]}],"font-size":[{text:["base",s,Ot,Ye]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,I,Rs]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",As,E]}],"font-family":[{font:[_c,E,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,I,E]}],"line-clamp":[{"line-clamp":[F,"none",I,Rs]}],leading:[{leading:[o,...j()]}],"list-image":[{"list-image":["none",I,E]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",I,E]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:$()}],"text-color":[{text:$()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Yt(),"wavy"]}],"text-decoration-thickness":[{decoration:[F,"from-font","auto",I,Ye]}],"text-decoration-color":[{decoration:$()}],"underline-offset":[{"underline-offset":[F,"auto",I,E]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:j()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",I,E]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",I,E]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:Ar()}],"bg-repeat":[{bg:Rr()}],"bg-size":[{bg:$r()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Me,I,E],radial:["",I,E],conic:[Me,I,E]},Nc,jc]}],"bg-color":[{bg:$()}],"gradient-from-pos":[{from:Es()}],"gradient-via-pos":[{via:Es()}],"gradient-to-pos":[{to:Es()}],"gradient-from":[{from:$()}],"gradient-via":[{via:$()}],"gradient-to":[{to:$()}],rounded:[{rounded:ae()}],"rounded-s":[{"rounded-s":ae()}],"rounded-e":[{"rounded-e":ae()}],"rounded-t":[{"rounded-t":ae()}],"rounded-r":[{"rounded-r":ae()}],"rounded-b":[{"rounded-b":ae()}],"rounded-l":[{"rounded-l":ae()}],"rounded-ss":[{"rounded-ss":ae()}],"rounded-se":[{"rounded-se":ae()}],"rounded-ee":[{"rounded-ee":ae()}],"rounded-es":[{"rounded-es":ae()}],"rounded-tl":[{"rounded-tl":ae()}],"rounded-tr":[{"rounded-tr":ae()}],"rounded-br":[{"rounded-br":ae()}],"rounded-bl":[{"rounded-bl":ae()}],"border-w":[{border:fe()}],"border-w-x":[{"border-x":fe()}],"border-w-y":[{"border-y":fe()}],"border-w-s":[{"border-s":fe()}],"border-w-e":[{"border-e":fe()}],"border-w-t":[{"border-t":fe()}],"border-w-r":[{"border-r":fe()}],"border-w-b":[{"border-b":fe()}],"border-w-l":[{"border-l":fe()}],"divide-x":[{"divide-x":fe()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":fe()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...Yt(),"hidden","none"]}],"divide-style":[{divide:[...Yt(),"hidden","none"]}],"border-color":[{border:$()}],"border-color-x":[{"border-x":$()}],"border-color-y":[{"border-y":$()}],"border-color-s":[{"border-s":$()}],"border-color-e":[{"border-e":$()}],"border-color-t":[{"border-t":$()}],"border-color-r":[{"border-r":$()}],"border-color-b":[{"border-b":$()}],"border-color-l":[{"border-l":$()}],"divide-color":[{divide:$()}],"outline-style":[{outline:[...Yt(),"none","hidden"]}],"outline-offset":[{"outline-offset":[F,I,E]}],"outline-w":[{outline:["",F,Ot,Ye]}],"outline-color":[{outline:$()}],shadow:[{shadow:["","none",u,os,as]}],"shadow-color":[{shadow:$()}],"inset-shadow":[{"inset-shadow":["none",m,os,as]}],"inset-shadow-color":[{"inset-shadow":$()}],"ring-w":[{ring:fe()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:$()}],"ring-offset-w":[{"ring-offset":[F,Ye]}],"ring-offset-color":[{"ring-offset":$()}],"inset-ring-w":[{"inset-ring":fe()}],"inset-ring-color":[{"inset-ring":$()}],"text-shadow":[{"text-shadow":["none",p,os,as]}],"text-shadow-color":[{"text-shadow":$()}],opacity:[{opacity:[F,I,E]}],"mix-blend":[{"mix-blend":[...Pr(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Pr()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[F]}],"mask-image-linear-from-pos":[{"mask-linear-from":ee()}],"mask-image-linear-to-pos":[{"mask-linear-to":ee()}],"mask-image-linear-from-color":[{"mask-linear-from":$()}],"mask-image-linear-to-color":[{"mask-linear-to":$()}],"mask-image-t-from-pos":[{"mask-t-from":ee()}],"mask-image-t-to-pos":[{"mask-t-to":ee()}],"mask-image-t-from-color":[{"mask-t-from":$()}],"mask-image-t-to-color":[{"mask-t-to":$()}],"mask-image-r-from-pos":[{"mask-r-from":ee()}],"mask-image-r-to-pos":[{"mask-r-to":ee()}],"mask-image-r-from-color":[{"mask-r-from":$()}],"mask-image-r-to-color":[{"mask-r-to":$()}],"mask-image-b-from-pos":[{"mask-b-from":ee()}],"mask-image-b-to-pos":[{"mask-b-to":ee()}],"mask-image-b-from-color":[{"mask-b-from":$()}],"mask-image-b-to-color":[{"mask-b-to":$()}],"mask-image-l-from-pos":[{"mask-l-from":ee()}],"mask-image-l-to-pos":[{"mask-l-to":ee()}],"mask-image-l-from-color":[{"mask-l-from":$()}],"mask-image-l-to-color":[{"mask-l-to":$()}],"mask-image-x-from-pos":[{"mask-x-from":ee()}],"mask-image-x-to-pos":[{"mask-x-to":ee()}],"mask-image-x-from-color":[{"mask-x-from":$()}],"mask-image-x-to-color":[{"mask-x-to":$()}],"mask-image-y-from-pos":[{"mask-y-from":ee()}],"mask-image-y-to-pos":[{"mask-y-to":ee()}],"mask-image-y-from-color":[{"mask-y-from":$()}],"mask-image-y-to-color":[{"mask-y-to":$()}],"mask-image-radial":[{"mask-radial":[I,E]}],"mask-image-radial-from-pos":[{"mask-radial-from":ee()}],"mask-image-radial-to-pos":[{"mask-radial-to":ee()}],"mask-image-radial-from-color":[{"mask-radial-from":$()}],"mask-image-radial-to-color":[{"mask-radial-to":$()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":w()}],"mask-image-conic-pos":[{"mask-conic":[F]}],"mask-image-conic-from-pos":[{"mask-conic-from":ee()}],"mask-image-conic-to-pos":[{"mask-conic-to":ee()}],"mask-image-conic-from-color":[{"mask-conic-from":$()}],"mask-image-conic-to-color":[{"mask-conic-to":$()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:Ar()}],"mask-repeat":[{mask:Rr()}],"mask-size":[{mask:$r()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",I,E]}],filter:[{filter:["","none",I,E]}],blur:[{blur:Or()}],brightness:[{brightness:[F,I,E]}],contrast:[{contrast:[F,I,E]}],"drop-shadow":[{"drop-shadow":["","none",f,os,as]}],"drop-shadow-color":[{"drop-shadow":$()}],grayscale:[{grayscale:["",F,I,E]}],"hue-rotate":[{"hue-rotate":[F,I,E]}],invert:[{invert:["",F,I,E]}],saturate:[{saturate:[F,I,E]}],sepia:[{sepia:["",F,I,E]}],"backdrop-filter":[{"backdrop-filter":["","none",I,E]}],"backdrop-blur":[{"backdrop-blur":Or()}],"backdrop-brightness":[{"backdrop-brightness":[F,I,E]}],"backdrop-contrast":[{"backdrop-contrast":[F,I,E]}],"backdrop-grayscale":[{"backdrop-grayscale":["",F,I,E]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[F,I,E]}],"backdrop-invert":[{"backdrop-invert":["",F,I,E]}],"backdrop-opacity":[{"backdrop-opacity":[F,I,E]}],"backdrop-saturate":[{"backdrop-saturate":[F,I,E]}],"backdrop-sepia":[{"backdrop-sepia":["",F,I,E]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":j()}],"border-spacing-x":[{"border-spacing-x":j()}],"border-spacing-y":[{"border-spacing-y":j()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",I,E]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[F,"initial",I,E]}],ease:[{ease:["linear","initial",k,I,E]}],delay:[{delay:[F,I,E]}],animate:[{animate:["none",O,I,E]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[_,I,E]}],"perspective-origin":[{"perspective-origin":N()}],rotate:[{rotate:Xt()}],"rotate-x":[{"rotate-x":Xt()}],"rotate-y":[{"rotate-y":Xt()}],"rotate-z":[{"rotate-z":Xt()}],scale:[{scale:es()}],"scale-x":[{"scale-x":es()}],"scale-y":[{"scale-y":es()}],"scale-z":[{"scale-z":es()}],"scale-3d":["scale-3d"],skew:[{skew:Is()}],"skew-x":[{"skew-x":Is()}],"skew-y":[{"skew-y":Is()}],transform:[{transform:[I,E,"","none","gpu","cpu"]}],"transform-origin":[{origin:N()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:ts()}],"translate-x":[{"translate-x":ts()}],"translate-y":[{"translate-y":ts()}],"translate-z":[{"translate-z":ts()}],"translate-none":["translate-none"],accent:[{accent:$()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:$()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",I,E]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":j()}],"scroll-mx":[{"scroll-mx":j()}],"scroll-my":[{"scroll-my":j()}],"scroll-ms":[{"scroll-ms":j()}],"scroll-me":[{"scroll-me":j()}],"scroll-mt":[{"scroll-mt":j()}],"scroll-mr":[{"scroll-mr":j()}],"scroll-mb":[{"scroll-mb":j()}],"scroll-ml":[{"scroll-ml":j()}],"scroll-p":[{"scroll-p":j()}],"scroll-px":[{"scroll-px":j()}],"scroll-py":[{"scroll-py":j()}],"scroll-ps":[{"scroll-ps":j()}],"scroll-pe":[{"scroll-pe":j()}],"scroll-pt":[{"scroll-pt":j()}],"scroll-pr":[{"scroll-pr":j()}],"scroll-pb":[{"scroll-pb":j()}],"scroll-pl":[{"scroll-pl":j()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",I,E]}],fill:[{fill:["none",...$()]}],"stroke-w":[{stroke:[F,Ot,Ye,Rs]}],stroke:[{stroke:["none",...$()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Ec=lc(zc);function Ic(...e){return Ec(Zl(e))}const Tc=(e,t)=>{const s=e.split(".").map(a=>+a||0),n=t.split(".").map(a=>+a||0);for(let a=0;a<3;a++){const o=s[a]??0,i=n[a]??0;if(o<i)return-1;if(o>i)return 1}return 0},jr=_s.forwardRef(({className:e,variant:t="default",children:s,...n},a)=>{const o="transition-all duration-200 bg-white border border-border-light",i={default:"mh-card p-4 md:p-6",hero:"mh-card mh-card--hero p-6 md:p-10 bg-gradient-to-br from-white to-brand-50",ai:"mh-ai-card"};return r.jsx("section",{ref:a,className:Ic(o,i[t],e),...n,children:s})});jr.displayName="HomeCard";const Xa=_s.memo(({index:e,title:t,desc:s,icon:n,isLast:a})=>r.jsxs("div",{className:"group relative flex md:flex-col items-center md:items-center gap-4 md:gap-4 p-2 rounded-xl hover:bg-bg-soft transition-colors duration-300 cursor-default",children:[r.jsxs("div",{className:"relative z-10 flex-shrink-0",children:[r.jsx("div",{className:"w-12 h-12 rounded-full bg-white border-2 border-border-light text-text-muted flex items-center justify-center group-hover:border-brand group-hover:text-brand group-hover:scale-110 transition-all duration-300 shadow-sm",children:r.jsx(n,{size:20})}),r.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 rounded-full bg-brand text-white text-[10px] font-bold flex items-center justify-center ring-2 ring-white",children:e+1})]}),r.jsxs("div",{className:"flex-1 md:text-center",children:[r.jsx("h4",{className:"text-base font-black text-text-ink mb-1 group-hover:text-brand transition-colors",children:t}),r.jsx("p",{className:"text-xs text-text-muted font-medium leading-relaxed",children:s})]}),r.jsx("div",{className:"md:hidden ml-auto text-border-light group-hover:text-brand transition-colors",children:!a&&r.jsx(Go,{size:16,className:"opacity-0 group-hover:opacity-20"})})]}));Xa.displayName="HeroStep";function Ac(){return r.jsxs(jr,{variant:"hero",className:"group/container relative overflow-hidden",children:[r.jsxs("div",{className:"relative z-10 mb-10 flex flex-col items-center gap-6 md:flex-row md:gap-10",children:[r.jsx("div",{className:"relative h-32 w-28 shrink-0",children:r.jsx(Fl,{})}),r.jsxs("div",{className:"flex-1 text-center md:text-left",children:[r.jsxs("div",{className:"mb-3 inline-flex items-center gap-2 rounded-full border border-[var(--brand)]/20 bg-[var(--bg-page)] px-3 py-1 text-xs font-bold text-[var(--brand)]",children:[r.jsx(Ho,{size:14}),r.jsx("span",{children:"全程透明．安心留痕"})]}),r.jsx("h3",{className:"mb-3 text-2xl font-black tracking-tight text-[var(--brand)] md:text-3xl",children:"安心留痕保障"}),r.jsxs("p",{className:"max-w-2xl text-sm font-medium leading-relaxed text-[var(--text-secondary)] md:text-base",children:["介紹改從第一次電話聯絡開始，買賣雙方的每一通聯絡紀錄、每一句承諾與每項協議， 都會經過雙方確認並完整留痕。",r.jsx("br",{className:"hidden md:block"}),"讓整個交易過程都有跡可循，保障雙方權益，直到圓滿交屋。"]})]}),r.jsxs("a",{href:"/#policy",className:"hidden shrink-0 items-center gap-2 rounded-xl border-2 border-[var(--brand)] bg-white px-5 py-2.5 text-sm font-bold text-[var(--brand)] shadow-sm transition-all hover:bg-[var(--brand)] hover:text-white md:flex",children:["履保規範 ",r.jsx(Ko,{size:16})]})]}),r.jsxs("div",{className:"relative mt-4 pl-2 md:pl-0",children:[r.jsx("div",{className:"absolute left-0 top-8 -z-0 hidden h-0.5 w-full bg-border-light md:block"}),r.jsx("div",{className:"absolute inset-y-0 left-8 -z-0 w-0.5 bg-border-light md:hidden"}),r.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-6 md:gap-2",children:an.map((e,t)=>r.jsx(Xa,{...e,index:t,isLast:t===an.length-1},e.id))})]})]})}function Rc(){return r.jsxs("div",{className:"w-36 h-36 mb-6 text-brand-200 -mt-8 relative",children:[r.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-28 h-28 bg-brand-100/50 rounded-full blur-2xl -z-10"}),r.jsxs("svg",{viewBox:"0 0 200 240",className:"w-full h-full drop-shadow-sm animate-float",children:[r.jsx("path",{d:"M 85 40 L 85 15 L 100 30 L 115 15 L 115 40",stroke:"currentColor",strokeWidth:"5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M 40 80 L 100 40 L 160 80",stroke:"currentColor",strokeWidth:"6",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("rect",{x:"55",y:"80",width:"90",height:"100",stroke:"currentColor",strokeWidth:"6",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M 78 110 Q 85 105 92 110",stroke:"currentColor",strokeWidth:"4",fill:"none",strokeLinecap:"round"}),r.jsx("path",{d:"M 108 110 Q 115 105 122 110",stroke:"currentColor",strokeWidth:"4",fill:"none",strokeLinecap:"round"}),r.jsx("circle",{cx:"85",cy:"125",r:"4",stroke:"currentColor",strokeWidth:"3",fill:"none"}),r.jsx("circle",{cx:"115",cy:"125",r:"4",stroke:"currentColor",strokeWidth:"3",fill:"none"}),r.jsx("path",{d:"M 55 130 L 25 110",stroke:"currentColor",strokeWidth:"5",fill:"none",strokeLinecap:"round"}),r.jsx("path",{d:"M 145 130 L 175 110",stroke:"currentColor",strokeWidth:"5",fill:"none",strokeLinecap:"round"}),r.jsx("path",{d:"M 85 180 L 85 215 L 75 215",stroke:"currentColor",strokeWidth:"5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M 115 180 L 115 215 L 125 215",stroke:"currentColor",strokeWidth:"5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})]})]})}function $c({role:e,content:t,timestamp:s}){return r.jsx("div",{className:`flex ${e==="user"?"justify-end":"justify-start"} animate-fadeIn`,children:r.jsxs("div",{className:`max-w-[85%] rounded-2xl px-5 py-3.5 text-[15px] font-medium leading-relaxed shadow-sm ${e==="user"?"bg-brand-700 text-white rounded-br-sm":"bg-white text-ink-900 border border-brand-100 rounded-bl-sm"}`,children:[r.jsx("div",{className:"whitespace-pre-wrap",children:t}),s&&r.jsx("div",{className:`mt-1.5 text-[11px] font-bold ${e==="user"?"text-brand-300":"text-brand-600/60"} text-right`,children:new Date(s).toLocaleTimeString("zh-TW",{hour:"2-digit",minute:"2-digit"})})]})})}const Pc=["3房以內","30坪以下","近捷運","新成屋"];function eo(){const[e,t]=g.useState([]),[s,n]=g.useState(""),[a,o]=g.useState(!1),i=g.useRef(null);g.useEffect(()=>{i.current&&(i.current.scrollTop=i.current.scrollHeight)},[e]);const l=async(c=s)=>{if(!c.trim()||a)return;const d={role:"user",content:c.trim(),timestamp:new Date().toISOString()};t(m=>[...m,d]),n(""),o(!0);const u={role:"assistant",content:"",timestamp:new Date().toISOString()};t(m=>[...m,u]);try{await Ht([...e,d],m=>{t(p=>{const f=[...p],v=f[f.length-1];return v&&v.role==="assistant"&&(v.content+=m),f})})}catch(m){console.error(m),t(p=>{const f=[...p],v=f[f.length-1];return v&&(v.content="抱歉，AI 服務目前暫時不可用，請稍後再試。"),f})}finally{o(!1)}};return r.jsxs("section",{className:"group relative bg-gradient-to-br from-white via-[#F8FAFC] to-[#00385a08] rounded-[24px] border border-brand-100 shadow-[0_8px_24px_rgba(0,56,90,0.06)] overflow-hidden hover:shadow-[0_12px_32px_rgba(0,56,90,0.1)] transition-all duration-300 isolate",children:[r.jsx("div",{className:"absolute -top-24 -right-24 w-80 h-80 bg-brand-100/30 rounded-full blur-3xl pointer-events-none mix-blend-multiply"}),r.jsx("div",{className:"absolute -bottom-24 -left-24 w-96 h-96 bg-brand-700/5 rounded-full blur-3xl pointer-events-none mix-blend-multiply"}),r.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(to_right,#00385a08_1px,transparent_1px),linear-gradient(to_bottom,#00385a08_1px,transparent_1px)] bg-[size:24px_24px] [mask-image:radial-gradient(ellipse_80%_50%_at_50%_0%,#000_70%,transparent_100%)] pointer-events-none z-0"}),r.jsx("div",{className:"h-1.5 w-full bg-gradient-to-r from-brand-700 via-brand-600 to-brand-500 relative z-20"}),r.jsxs("div",{className:"p-5 md:p-8 md:pt-6 relative z-10",children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-3",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-12 h-12 rounded-2xl bg-white/80 border border-brand-100 flex items-center justify-center text-brand-700 relative overflow-hidden shrink-0 shadow-sm backdrop-blur-sm group-hover:scale-105 transition-transform duration-300",children:r.jsx(Jo,{size:28,strokeWidth:2})}),r.jsxs("div",{children:[r.jsxs("h3",{className:"font-black text-brand-700 text-xl tracking-tight flex items-center gap-2",children:["社區鄰居管家",r.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-gradient-to-r from-brand-700 to-brand-600 text-white text-[10px] font-bold tracking-wider uppercase shadow-sm",children:[r.jsx(Xn,{size:10})," AI Beta"]})]}),r.jsx("p",{className:"text-xs text-ink-600 font-bold mt-0.5 tracking-wide",children:"全天候待命 · 分析房價 · 區域諮詢"})]})]}),r.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:Pc.map(c=>r.jsx("button",{onClick:()=>l(c),className:"px-3.5 py-1.5 rounded-full bg-white border border-brand-100 text-brand-700 text-xs font-bold hover:bg-brand-700 hover:text-white hover:border-brand-700 transition-all active:scale-95 shadow-sm hover:shadow-md backdrop-blur-sm",children:c},c))})]}),r.jsxs("div",{ref:i,className:"h-[380px] overflow-y-auto rounded-2xl bg-white/50 border border-brand-100/60 p-5 shadow-inner mb-4 flex flex-col gap-4 scroll-smooth backdrop-blur-md",role:"log","aria-live":"polite",children:[e.length===0?r.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center text-center p-4 opacity-80",children:[r.jsx(Rc,{}),r.jsx("p",{className:"mb-2 font-black text-brand-700 text-base",children:"歡迎來到邁房子！我是邁邁 🤖"}),r.jsxs("p",{className:"text-sm leading-relaxed text-ink-600 max-w-xs mx-auto font-medium",children:["買房不只看物件，更要看生活。",r.jsx("br",{}),"告訴我您的預算或想住的區域，讓我幫您分析！"]})]}):e.map((c,d)=>r.jsx($c,{role:c.role,content:c.content,timestamp:c.timestamp},d)),a&&r.jsx("div",{className:"flex justify-start animate-fadeIn",children:r.jsxs("div",{className:"rounded-2xl rounded-bl-sm px-4 py-3 bg-white border border-brand-100 text-brand-600 text-sm flex items-center gap-2 shadow-sm",children:[r.jsx("span",{className:"font-bold",children:"邁邁正在思考"}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("span",{className:"w-1.5 h-1.5 bg-brand-500 rounded-full animate-[bounce_1.4s_infinite_in-out_both]"}),r.jsx("span",{className:"w-1.5 h-1.5 bg-brand-500 rounded-full animate-[bounce_1.4s_infinite_in-out_both_0.2s]"}),r.jsx("span",{className:"w-1.5 h-1.5 bg-brand-500 rounded-full animate-[bounce_1.4s_infinite_in-out_both_0.4s]"})]})]})})]}),r.jsxs("div",{className:"relative group/input",children:[r.jsx("input",{type:"text",className:"w-full pl-5 pr-14 py-4 rounded-xl border-2 border-brand-100 bg-white/80 text-ink-900 font-bold text-[15px] placeholder:text-ink-400/80 transition-all focus:outline-none focus:border-brand-500 focus:ring-4 focus:ring-brand-50/50 hover:border-brand-300 shadow-sm backdrop-blur-sm",placeholder:"輸入需求，例如：新北板橋 2000萬內 3房...",value:s,onChange:c=>n(c.target.value),onKeyDown:c=>c.key==="Enter"&&!c.shiftKey&&l(),disabled:a}),r.jsx("button",{onClick:()=>l(),disabled:a||!s.trim(),className:"absolute right-2 top-2 bottom-2 aspect-square rounded-lg bg-brand-700 text-white flex items-center justify-center shadow-md transition-all hover:bg-brand-600 hover:shadow-lg hover:-translate-y-0.5 active:translate-y-0 active:scale-95 disabled:cursor-not-allowed disabled:opacity-50 disabled:hover:transform-none disabled:shadow-none",children:r.jsx(Yo,{size:20,strokeWidth:2.5,className:"-ml-0.5 translate-y-[1px]"})})]})]})]})}const to=_s.memo(({id:e,name:t,rating:s,tags:n,content:a})=>r.jsxs("article",{className:"flex gap-3 border border-[#E6EDF7] rounded-2xl p-3.5 bg-white relative hover:shadow-[0_4px_12px_rgba(0,56,90,0.08)] transition-all duration-200 hover:-translate-y-0.5",children:[r.jsx("div",{className:"w-[38px] h-[38px] rounded-full bg-gradient-to-b from-[#F2F5F8] to-[#E1E6EB] border border-[#E6EDF7] flex items-center justify-center font-black text-[#00385a] text-[15px] shrink-0 shadow-[inset_0_1px_2px_rgba(255,255,255,0.8),0_2px_4px_rgba(0,56,90,0.05)]",children:e}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[r.jsx("div",{className:"font-black text-[15px] text-[#0A2246] flex items-center gap-1.5",children:t}),r.jsx("div",{className:"flex gap-0.5","aria-label":`${s} stars`,children:Array.from({length:5}).map((o,i)=>r.jsx("span",{className:`text-xs ${i<s?"text-[#00385a]":"text-[#E6EDF7]"}`,children:"★"},i))})]}),r.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:n.map(o=>r.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-md bg-[#F6F9FF] border border-[#E6EDF7] text-[#00385a] font-bold tracking-wide",children:o},o))}),r.jsx("p",{className:"text-[13px] leading-relaxed text-[#4B5563] font-medium text-justify",children:a})]})]}));to.displayName="ReviewCard";function Oc(){return r.jsxs(jr,{className:"bg-white/96 backdrop-blur-md border border-[#E6EDF7] shadow-[0_4px_20px_rgba(0,56,90,0.03)] p-3",children:[r.jsxs("div",{className:"bg-gradient-to-r from-[#00385a] to-[#005585] rounded-2xl px-4 py-3 mb-4 flex justify-between items-center shadow-[0_2px_8px_rgba(0,56,90,0.15)] relative overflow-hidden",children:[r.jsx("div",{className:"absolute -right-6 -top-6 w-24 h-24 bg-white/5 rounded-full blur-2xl pointer-events-none"}),r.jsxs("div",{className:"flex items-center gap-2.5 relative z-10",children:[r.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-[#E63946] shadow-[0_0_8px_rgba(230,57,70,0.6)]"}),r.jsx("h3",{className:"text-lg font-black m-0 text-white tracking-wide text-shadow-sm",children:"社區評價"}),r.jsx("span",{className:"text-[11px] font-bold text-[#00385a] bg-white/95 backdrop-blur-sm px-2.5 py-0.5 rounded-full shadow-sm border border-white/20",children:"聚合"})]})]}),r.jsx("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:Dl.map(e=>r.jsx(to,{...e},e.id))}),r.jsxs("a",{className:"mt-4 flex items-center gap-2.5 bg-gradient-to-b from-white to-[#F6F9FF] border border-[#E6EDF7] p-3.5 rounded-xl font-black text-[#00385a] no-underline relative lg:justify-center lg:text-center group hover:shadow-[0_4px_12px_rgba(0,56,90,0.08)] hover:border-[#00385a]/20 transition-all duration-200 active:translate-y-px",href:"/maihouses/community-wall_mvp.html","aria-label":"點我看更多社區評價",children:[r.jsx("span",{className:"text-[15px] tracking-wide lg:mx-auto group-hover:text-[#004E7C] transition-colors",children:"查看更多真實住戶評價"}),r.jsx("span",{className:"ml-auto bg-[#00385a] text-white rounded-lg text-xs font-bold px-3 py-1.5 lg:absolute lg:right-[14px] lg:top-1/2 lg:-translate-y-1/2 lg:ml-0 group-hover:bg-[#004E7C] transition-colors shadow-sm",children:"前往社區牆 →"})]})]})}function Mc({property:e}){return r.jsxs("article",{className:"bg-white border border-[#E6EDF7] rounded-2xl overflow-hidden relative transition-all duration-[180ms] ease-out shadow-none hover:shadow-[0_10px_26px_rgba(13,39,94,0.12)] hover:-translate-y-0.5 hover:border-[#1749d738] group isolate",children:[r.jsx("div",{className:"absolute inset-0 pointer-events-none bg-[radial-gradient(60%_60%_at_80%_-10%,rgba(23,73,215,0.12),transparent_60%)] opacity-80"}),r.jsxs("a",{href:`/property/${e.id}`,className:"block aspect-[4/3] bg-[#e9ecf5] relative overflow-hidden",children:[r.jsx("img",{src:e.image,alt:"物件封面",className:"w-full h-full object-cover block transform scale-100 transition-transform duration-[600ms] cubic-bezier(0.2,0.65,0.2,1) group-hover:scale-105"}),r.jsx("span",{className:"absolute left-2.5 top-2.5 bg-black/75 text-white text-xs font-extrabold px-2 py-1 rounded-full tracking-[0.2px] shadow-[0_4px_10px_rgba(0,0,0,0.18)]",children:e.badge})]}),r.jsxs("div",{className:"p-3 pb-3.5",children:[r.jsx("div",{className:"font-extrabold text-base leading-[1.35] my-0.5 mb-2 tracking-[0.3px] text-[#0A2246] lg:text-[21px]",children:e.title}),r.jsx("div",{className:"flex flex-wrap gap-2 items-center text-[#6C7B91] text-[13px] mb-1.5",children:e.tags.map((t,s)=>r.jsx("span",{className:"px-2.5 py-0.5 rounded-full bg-[#F6F9FF] border border-[#E6EDF7] font-extrabold text-[#2A2F3A] transition-all duration-120 ease-out group-hover:-translate-y-px group-hover:shadow-[0_4px_10px_rgba(0,56,90,0.10)]",children:t},s))}),r.jsxs("div",{className:"text-[19px] font-black text-[#111] my-2 mb-1 tracking-[0.2px]",children:["NT$ ",e.price," 萬"]}),r.jsx("div",{className:"text-[13px] text-[#6C7B91]",children:e.location}),r.jsxs("div",{className:"mt-2.5 px-3 py-2.5 border border-[#E6EDF7] rounded-xl bg-gradient-to-b from-[#F6F9FF] to-white",children:[r.jsx("div",{className:"flex items-center gap-2 text-[13px] font-black mb-2 text-black/85 before:content-['★'] before:text-xs before:leading-none before:text-[#00385a] before:drop-shadow-[0_1px_0_rgba(0,56,90,0.12)]",children:"住戶真實留言"}),e.reviews.map((t,s)=>r.jsxs("div",{className:`flex gap-2.5 items-start py-2 ${s!==0?"border-t border-dashed border-black/10":""}`,children:[r.jsx("div",{className:"w-[30px] h-[30px] rounded-full grid place-items-center text-xs font-black bg-gradient-to-b from-[#F2F5F8] to-[#E1E6EB] text-[#00385a] flex-none shadow-[inset_0_0_0_1px_rgba(0,56,90,0.15)]",children:t.avatar}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5 text-xs text-black/60",children:[r.jsxs("span",{className:"font-black text-black/85",children:[t.name," · ",t.role]}),r.jsx("span",{className:"w-1 h-1 rounded-full bg-black/20 inline-block"}),r.jsx("span",{className:"px-2 py-0.5 rounded-full bg-[#00385a]/10 text-[#00385a] font-black",children:t.tag})]}),r.jsx("div",{className:"text-[13px] leading-[1.6] text-black/85",children:t.text})]})]},s)),r.jsx("button",{type:"button",className:"mt-2.5 w-full px-3 py-2.5 rounded-xl border border-[#00385a]/30 bg-gradient-to-b from-white to-[#F5F7FA] cursor-pointer text-[13px] font-black text-[#00385a] transition-all duration-150 ease-out hover:from-white hover:to-[#E8F0FF] hover:shadow-[0_6px_14px_rgba(0,56,90,0.18)] active:translate-y-px",children:"註冊後看更多評價"})]})]})]})}function Fc(){return r.jsxs("div",{className:"w-full",children:[r.jsxs("div",{className:"flex items-center gap-2.5 my-[18px] mb-3","aria-label":"智能房源推薦",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 border border-[#E6EDF7] rounded-full bg-gradient-to-b from-white to-[#F6F9FF] text-[#00385a] font-black text-sm tracking-[0.2px]",children:[r.jsx("span",{className:"w-[18px] h-[18px] rounded-md grid place-items-center bg-gradient-to-b from-[#00385a] to-[#004E7C] text-white text-xs font-black shadow-[0_2px_6px_rgba(0,56,90,0.18)]",children:"★"}),r.jsx("span",{className:"leading-none text-base md:text-lg md:font-bold",children:"〔智能房源推薦〕"}),r.jsx("span",{className:"ml-1.5 text-sm text-[#6C7B91] font-bold",children:"依瀏覽行為與社區口碑輔助排序"})]}),r.jsx("div",{className:"h-1.5 rounded-full flex-1 bg-gradient-to-r from-[#00385a] via-[#004E7C] to-[#7EA5FF] bg-[length:200%_100%] opacity-25 ml-2.5 animate-mhRecoBar","aria-hidden":"true"})]}),r.jsx("div",{className:"grid grid-cols-1 gap-[18px] md:grid-cols-2 lg:grid-cols-3","aria-label":"房源清單",children:Ll.map(e=>r.jsx(Mc,{property:e},e.id))})]})}const Dc=()=>{const[e,t]=g.useState(!1),s=g.useMemo(()=>Gt(),[]),n=g.useMemo(()=>_l(3),[]),a=g.useMemo(()=>Nl(s.milestones),[s.milestones]);if(g.useEffect(()=>{const{isFirstVisit:u}=yl(),m=n&&n.length>0||!!a||!!s.lastMood,p=!u&&!jl()&&m;t(p),p&&ue(he.WarmbarView,{tags:n,milestone:!!a,lastMood:s.lastMood})},[n,a,s.lastMood]),!e)return null;const o=u=>u==="stress"?"最近辛苦了":u==="rest"?"慢慢來就好":"好久不見",i=n&&n.length>0?`上次你提到「${n.join("・")}」`:null,l=a||(i?`${o(s.lastMood)}，${i}`:`${o(s.lastMood)}，這幾天過得怎麼樣`),c=()=>{ue(he.WarmbarContinue,{tags:n,milestone:!!a});const u=a?"最近有點紀念日的感覺，想輕鬆聊聊。":n&&n.length>0?`還記得我們聊過 ${n.join("、")}，你有新想法嗎？`:"想跟你聊聊近況～";window.dispatchEvent(new CustomEvent("mai:chat:start",{detail:{text:u}}))},d=()=>{wl(),t(!1),ue(he.WarmbarDismiss,{})};return r.jsxs("div",{className:"w-full bg-[#F5F8FF] text-[#0a2246] text-sm leading-[34px] h-[34px] text-center tracking-wide border-b border-[#E6ECFF] flex items-center justify-center gap-3",role:"status","aria-live":"polite",children:[r.jsx("span",{children:l}),r.jsx("button",{className:"px-2.5 py-0.5 rounded-full border border-[#1749D7] bg-[#1749D7] text-white cursor-pointer leading-6 h-[26px] hover:bg-[#123cb3] transition-colors",onClick:c,children:"接著聊"}),r.jsx("button",{className:"px-2.5 py-0.5 rounded-full border border-[#C9D5FF] bg-white text-[#1749D7] cursor-pointer leading-6 h-[26px] hover:bg-gray-50 transition-colors",onClick:d,children:"今天不再顯示"})]})};function Lc({config:e}){const[t,s]=g.useState(null);g.useEffect(()=>{Pa().then(a=>{a.ok&&a.data&&(a.data.maintenance||Tc(a.data.backendVersion,e.minBackend)<0)&&(console.warn("版本不相容或維護中"),s("版本不相容或維護中"))})},[e.minBackend]),g.useEffect(()=>{const a=o=>{var i;try{Kt("unhandled_promise_rejection","/",((i=o.reason)==null?void 0:i.message)||String(o.reason))}catch{}};return globalThis.addEventListener("unhandledrejection",a),()=>globalThis.removeEventListener("unhandledrejection",a)},[]);const n=e.features||{};return r.jsxs(r.Fragment,{children:[r.jsx(Da,{}),r.jsx(Dc,{}),t&&r.jsx("div",{className:"mx-auto mt-4 max-w-container rounded-md bg-yellow-500 p-3 text-sm text-white",children:t}),r.jsxs("main",{className:"relative mx-auto max-w-container space-y-6 p-4 md:space-y-8 md:p-6",children:[n.heroAssure!==!1&&r.jsx(Ac,{}),n.smartAsk!==!1&&r.jsx(eo,{}),r.jsx(Oc,{}),n.propertyGrid!==!1&&r.jsx(Fc,{})]})]})}const Zc="https://mtqnjmoisrvjofdxhwhi.supabase.co",Uc="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im10cW5qbW9pc3J2am9mZHhod2hpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM1MjE1MDEsImV4cCI6MjA3OTA5NzUwMX0.P2o5n09PQChfryl-WLT7v6wRVWhDK6Oik7ajjcwyNrc",H=gi(Zc,Uc,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}});async function Bc(e,t){const{data:s,error:n}=await H.auth.signUp({email:e,password:t});if(n)throw n;return s}async function qc(e,t){const{data:s,error:n}=await H.auth.signInWithPassword({email:e,password:t});if(n)throw n;return s}async function so(){const{data:e,error:t}=await H.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${globalThis.location.origin}/`,queryParams:{access_type:"offline",prompt:"consent"}}});if(t)throw t;return e}function Wc(){const e=ur(),[t,s]=g.useState(""),[n,a]=g.useState(""),[o,i]=g.useState(""),[l,c]=g.useState(!1),[d,u]=g.useState(!1),m=async f=>{f.preventDefault(),i(""),u(!0);try{try{Kt("register_submit","/auth/register")}catch(v){console.warn("Analytics failed",v)}await Bc(t,n),c(!0),setTimeout(()=>e("/auth/login"),2e3)}catch(v){i(v.message||"註冊失敗")}finally{u(!1)}},p=async()=>{try{u(!0),await so()}catch(f){i(f.message||"Google 註冊失敗"),u(!1)}};return r.jsxs("section",{className:"mx-auto mt-8 max-w-md rounded-[var(--r-lg)] bg-white p-6 shadow-[var(--shadow-card)]",children:[r.jsx("h1",{className:"mb-4 text-xl font-semibold",children:"註冊"}),o&&r.jsx("div",{className:"mb-4 rounded-[var(--r-md)] bg-red-50 border border-red-200 p-3 text-red-600 text-sm",children:o}),l&&r.jsx("div",{className:"mb-4 rounded-[var(--r-md)] bg-green-50 border border-green-200 p-3 text-green-600 text-sm",children:"註冊成功! 請檢查您的信箱確認帳號,稍後將跳轉到登入頁面..."}),r.jsxs("form",{onSubmit:m,className:"space-y-3 relative z-10",children:[r.jsx("input",{id:"register-email",name:"email",className:"w-full rounded-[var(--r-md)] border border-[var(--border-default)] p-2",type:"email",placeholder:"Email","aria-label":"Email",value:t,onChange:f=>s(f.target.value),required:!0,autoComplete:"email"}),r.jsx("input",{id:"register-password",name:"password",className:"w-full rounded-[var(--r-md)] border border-[var(--border-default)] p-2",type:"password",placeholder:"密碼 (至少6個字元)","aria-label":"密碼",value:n,onChange:f=>a(f.target.value),minLength:6,required:!0,autoComplete:"new-password"}),r.jsx("button",{type:"submit",disabled:d||l,className:"w-full rounded-[var(--r-pill)] bg-[var(--brand)] px-4 py-2 text-[var(--brand-fg)] disabled:opacity-50 disabled:cursor-not-allowed",children:d?"註冊中...":l?"註冊成功":"註冊"})]}),r.jsxs("div",{className:"relative my-4",children:[r.jsx("div",{className:"absolute inset-0 flex items-center",children:r.jsx("div",{className:"w-full border-t border-[var(--border-default)]"})}),r.jsx("div",{className:"relative flex justify-center text-sm",children:r.jsx("span",{className:"bg-white px-2 text-[var(--text-secondary)]",children:"或"})})]}),r.jsx("button",{type:"button",onClick:p,disabled:d||l,className:"relative z-10 w-full rounded-[var(--r-pill)] border border-[var(--border-default)] bg-white px-4 py-2 text-[var(--text-primary)] hover:bg-gray-50 disabled:opacity-50",children:r.jsxs("span",{className:"flex items-center justify-center gap-2",children:[r.jsxs("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",children:[r.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),r.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),r.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),r.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"使用 Google 註冊"]})})]})}function ro(){const[e,t]=g.useState(null),[s,n]=g.useState(null),[a,o]=g.useState(!0);return g.useEffect(()=>{H.auth.getSession().then(({data:{session:l}})=>{t(l),n((l==null?void 0:l.user)??null),o(!1)});const{data:{subscription:i}}=H.auth.onAuthStateChange((l,c)=>{t(c),n((c==null?void 0:c.user)??null),o(!1)});return()=>i.unsubscribe()},[]),{session:e,user:s,loading:a}}function Vc(){const e=ur(),{user:t}=ro(),[s,n]=g.useState(""),[a,o]=g.useState(""),[i,l]=g.useState(""),[c,d]=g.useState(!1);g.useEffect(()=>{t&&e("/")},[t,e]);const u=async p=>{p.preventDefault(),l(""),d(!0);try{try{Kt("login_submit","/auth/login")}catch(f){console.warn("Analytics failed",f)}await qc(s,a)}catch(f){l(f.message||"登入失敗"),d(!1)}},m=async()=>{try{d(!0),await so()}catch(p){l(p.message||"Google 登入失敗"),d(!1)}};return r.jsxs("div",{className:"min-h-screen bg-[var(--bg-page)] font-sans",children:[r.jsx(Da,{}),r.jsx("main",{className:"container mx-auto px-4 py-12 md:py-20 flex justify-center items-center",children:r.jsxs("div",{className:"w-full max-w-[420px] bg-white rounded-[24px] shadow-[0_20px_40px_-12px_rgba(0,0,0,0.1)] p-8 md:p-10 border border-slate-100",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("h1",{className:"text-2xl font-bold text-[var(--brand)] mb-2",children:"歡迎回來"}),r.jsx("p",{className:"text-[var(--text-secondary)] text-sm",children:"登入以繼續使用邁房子服務"})]}),i&&r.jsxs("div",{className:"mb-6 rounded-xl bg-red-50 border border-red-100 p-4 text-red-600 text-sm flex items-center gap-2",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5 flex-shrink-0",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z",clipRule:"evenodd"})}),i]}),r.jsxs("form",{onSubmit:u,className:"space-y-5",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"login-email",className:"block text-sm font-bold text-[var(--text-primary)] mb-1.5 ml-1",children:"Email"}),r.jsx("input",{id:"login-email",name:"email",className:"w-full rounded-xl border border-slate-200 bg-slate-50 p-3 text-[var(--text-primary)] placeholder:text-slate-400 focus:bg-white focus:border-[var(--brand-light)] focus:ring-4 focus:ring-[var(--brand-light)]/10 transition-all outline-none",type:"email",placeholder:"name@example.com","aria-label":"Email",value:s,onChange:p=>n(p.target.value),required:!0,autoComplete:"email"})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-1.5 ml-1",children:[r.jsx("label",{htmlFor:"login-password",className:"block text-sm font-bold text-[var(--text-primary)]",children:"密碼"}),r.jsx("a",{href:"#",className:"text-xs font-semibold text-[var(--brand-light)] hover:text-[var(--brand)] transition-colors",children:"忘記密碼？"})]}),r.jsx("input",{id:"login-password",name:"password",className:"w-full rounded-xl border border-slate-200 bg-slate-50 p-3 text-[var(--text-primary)] placeholder:text-slate-400 focus:bg-white focus:border-[var(--brand-light)] focus:ring-4 focus:ring-[var(--brand-light)]/10 transition-all outline-none",type:"password",placeholder:"••••••••","aria-label":"密碼",value:a,onChange:p=>o(p.target.value),required:!0,autoComplete:"current-password"})]}),r.jsx("button",{type:"submit",disabled:c,className:"w-full rounded-full bg-[var(--brand)] px-4 py-3.5 text-white font-bold text-[15px] shadow-lg shadow-[var(--brand)]/20 hover:bg-[#002d4a] hover:shadow-xl hover:shadow-[var(--brand)]/30 hover:-translate-y-0.5 active:translate-y-0 active:shadow-md transition-all disabled:opacity-70 disabled:cursor-not-allowed disabled:transform-none",children:c?r.jsxs("span",{className:"flex items-center justify-center gap-2",children:[r.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"登入中..."]}):"登入"})]}),r.jsxs("div",{className:"relative my-8",children:[r.jsx("div",{className:"absolute inset-0 flex items-center",children:r.jsx("div",{className:"w-full border-t border-slate-200"})}),r.jsx("div",{className:"relative flex justify-center text-sm",children:r.jsx("span",{className:"bg-white px-4 text-slate-400 font-medium",children:"或"})})]}),r.jsxs("button",{type:"button",onClick:m,disabled:c,className:"w-full rounded-full border border-slate-200 bg-white px-4 py-3 text-[var(--text-primary)] font-bold text-[15px] hover:bg-slate-50 hover:border-slate-300 transition-all active:bg-slate-100 disabled:opacity-70 flex items-center justify-center gap-3 group",children:[r.jsxs("svg",{className:"h-5 w-5 group-hover:scale-110 transition-transform",viewBox:"0 0 24 24",children:[r.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),r.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),r.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),r.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"使用 Google 登入"]}),r.jsxs("div",{className:"mt-8 text-center text-[15px] text-[var(--text-secondary)]",children:["還沒有帳號？ ",r.jsx(ps,{to:"/auth/register",className:"text-[var(--brand-light)] font-bold hover:text-[var(--brand)] hover:underline transition-colors",children:"立即註冊"})]})]})})]})}function Qc(){return r.jsxs("section",{className:"mx-auto mt-8 max-w-container rounded-[var(--r-lg)] bg-white p-6 shadow-[var(--shadow-card)]",children:[r.jsx("h1",{className:"text-xl font-semibold",children:"社區牆"}),r.jsx("p",{className:"mt-2 text-sm text-[var(--text-secondary)]",children:"此頁為示意佈局，實作請接後端。"})]})}function Gc(){return r.jsxs("section",{className:"mx-auto mt-8 max-w-container rounded-[var(--r-lg)] bg-white p-6 shadow-[var(--shadow-card)]",children:[r.jsx("h1",{className:"text-xl font-semibold",children:"推薦社區"}),r.jsx("p",{className:"mt-2 text-sm text-[var(--text-secondary)]",children:"依據您的偏好，為您推薦可能喜歡的社區。"})]})}function Hc(e,t,s){const n=t/12/100,a=s*12;return n===0?e/a:e*n/(1-Math.pow(1+n,-a))}const Kc=()=>{const[e,t]=g.useState(1500),[s,n]=g.useState(30),[a,o]=g.useState(2.25),[i,l]=g.useState(20),[c,d]=g.useState(""),u=g.useMemo(()=>Math.max(0,e*(1-s/100)),[e,s]),m=g.useMemo(()=>Math.round(Hc(u*1e4,a,i)),[u,a,i]),p=3e3,f=g.useMemo(()=>typeof c!="number"||c<=0?null:Math.round((m+p)/c*100),[c,m]),v=()=>{const y=`概算（僅供參考）：
總價${e}萬，頭期${s}% → 貸款約${u.toFixed(0)}萬；${i}年利率${a}% → 月付約 ${m} 元；管理費約 ${p} 元。`+(f!==null?`
月負擔率約 ${f}%（含管理費）。`:"");navigator.clipboard.writeText(y).then(()=>ue(he.BudgetCopy,{}))},_=f===null?"這個數字僅供參考，別給自己太大壓力。":f>=50?"負擔率偏高了，先別急著決定；我們可以討論更有彈性的做法。":f>=35?"負擔率有點高，可再看看地點/年限的權衡。":"看起來在可接受範圍內，但仍建議保留彈性。";return r.jsxs("div",{style:{border:"1px solid #eee",borderRadius:12,padding:12,background:"#fff"},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:8},children:"預算規劃（Lite）"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5,1fr)",gap:8},children:[r.jsxs("label",{children:["總價(萬)",r.jsx("input",{type:"number",value:e,onChange:y=>t(Number(y.target.value)),style:{width:"100%",padding:6,borderRadius:8,border:"1px solid #ddd"}})]}),r.jsxs("label",{children:["頭期(%)",r.jsx("input",{type:"number",value:s,onChange:y=>n(Number(y.target.value)),style:{width:"100%",padding:6,borderRadius:8,border:"1px solid #ddd"}})]}),r.jsxs("label",{children:["利率(%)",r.jsx("input",{type:"number",value:a,onChange:y=>o(Number(y.target.value)),style:{width:"100%",padding:6,borderRadius:8,border:"1px solid #ddd"}})]}),r.jsxs("label",{children:["年限",r.jsx("input",{type:"number",value:i,onChange:y=>l(Number(y.target.value)),style:{width:"100%",padding:6,borderRadius:8,border:"1px solid #ddd"}})]}),r.jsxs("label",{children:["月收入(可選)",r.jsx("input",{type:"number",value:typeof c=="number"?c:"",onChange:y=>{const k=Number(y.target.value);d(Number.isFinite(k)?k:"")},style:{width:"100%",padding:6,borderRadius:8,border:"1px solid #ddd"}})]})]}),r.jsxs("div",{style:{marginTop:10,fontSize:14,color:"#0a2246"},children:["概算（僅供參考）：月付約 ",r.jsx("b",{children:m.toLocaleString()})," 元；貸款本金約 ",r.jsx("b",{children:u.toFixed(0)})," 萬。",f!==null&&r.jsxs(r.Fragment,{children:["　｜　月負擔率約 ",r.jsxs("b",{children:[f,"%"]}),"（含管理費）"]})]}),r.jsx("div",{style:{marginTop:8,color:"#6b7280"},children:_}),r.jsx("button",{onClick:v,style:{marginTop:8,padding:"6px 10px",borderRadius:8,border:"1px solid #1749D7",background:"#fff",color:"#1749D7"},children:"複製概算模板"})]})},Jc=({onAdopt:e})=>{const[t,s]=g.useState(""),[n,a]=g.useState("agent"),[o,i]=g.useState("detail"),[l,c]=g.useState(null),[d,u]=g.useState(null),[m,p]=g.useState(!1),[f,v]=g.useState(!1),_=async()=>{const k=t.trim();if(k){p(!0);try{const z=(await El(k,{audience:n,intent:o})).split(/\n+/).map(S=>S.trim()).filter(Boolean),w=z.find(S=>/^V1/.test(S))||"",N=z.find(S=>/^V2/.test(S))||"";c(w.replace(/^V1[:：]\s?/,"")),u(N.replace(/^V2[:：]\s?/,"")),ue(he.RewriteGen,{audience:n,intent:o})}finally{p(!1)}}},y=k=>{e==null||e(k),v(!0),ue(he.RewriteAdopt,{audience:n,intent:o}),setTimeout(()=>v(!1),2500)};return r.jsxs("div",{style:{border:"1px solid #eee",borderRadius:12,padding:12,background:"#fff"},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"禮貌改寫小幫手"}),r.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:8},children:[r.jsxs("label",{children:["對象",r.jsxs("select",{value:n,onChange:k=>a(k.target.value),style:{marginLeft:6,padding:6,borderRadius:8,border:"1px solid #ddd"},children:[r.jsx("option",{value:"agent",children:"仲介"}),r.jsx("option",{value:"owner",children:"屋主"})]})]}),r.jsxs("label",{children:["目的",r.jsxs("select",{value:o,onChange:k=>i(k.target.value),style:{marginLeft:6,padding:6,borderRadius:8,border:"1px solid #ddd"},children:[r.jsx("option",{value:"detail",children:"詢問細節"}),r.jsx("option",{value:"view",children:"預約看房"}),r.jsx("option",{value:"pet",children:"可否養寵物"}),r.jsx("option",{value:"price",children:"價格/議價"})]})]})]}),r.jsx("textarea",{rows:3,placeholder:"貼上你想發的訊息（我會根據對象/目的幫你潤飾）",value:t,onChange:k=>s(k.target.value),style:{width:"100%",padding:8,borderRadius:8,border:"1px solid #ddd"}}),r.jsx("div",{style:{display:"flex",gap:8,marginTop:8},children:r.jsx("button",{onClick:_,disabled:m,style:{padding:"8px 12px",borderRadius:8,background:"#1749D7",color:"#fff",border:"1px solid #1749D7"},children:m?"生成中…":"禮貌改寫"})}),(l||d)&&r.jsxs("div",{style:{marginTop:10,display:"grid",gap:8},children:[l&&r.jsxs("div",{style:{border:"1px solid #E6ECFF",borderRadius:8,padding:8},children:[r.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"版本一"}),r.jsx("div",{style:{marginBottom:6},children:l}),r.jsx("button",{onClick:()=>y(l),style:{padding:"6px 10px",borderRadius:8,border:"1px solid #1749D7",background:"#fff",color:"#1749D7"},children:"採用（複製/送出）"})]}),d&&r.jsxs("div",{style:{border:"1px solid #E6ECFF",borderRadius:8,padding:8},children:[r.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"版本二"}),r.jsx("div",{style:{marginBottom:6},children:d}),r.jsx("button",{onClick:()=>y(d),style:{padding:"6px 10px",borderRadius:8,border:"1px solid #1749D7",background:"#fff",color:"#1749D7"},children:"採用（複製/送出）"})]}),f&&r.jsx("div",{style:{color:"#16a34a"},children:"已準備好訊息，祝溝通順利 🤞"})]})]})},no="mai-notes-v1";function Yc(){try{const e=localStorage.getItem(no);return e?JSON.parse(e):[]}catch{return[]}}function Xc(e){localStorage.setItem(no,JSON.stringify(e))}function rr(e,t){const s=Yc(),n={id:Math.random().toString(36).slice(2),createdAt:Date.now(),note:e,...t&&{echo:t}};return s.unshift(n),Xc(s),n}const ed=()=>{const[e,t]=g.useState(""),[s,n]=g.useState(null),[a,o]=g.useState(!1),[i,l]=g.useState(!1),c=async()=>{const d=e.trim();if(d){o(!0);try{const u=await Il(d);n(u),rr(d,u),ue(he.NoteSaved,{})}catch{rr(d)}finally{o(!1)}}};return r.jsxs("div",{style:{border:"1px solid #eee",borderRadius:12,padding:12,background:"#fff"},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"收藏備註（感受）"}),r.jsx("textarea",{rows:3,placeholder:"寫下這間帶給你的感覺…",value:e,onChange:d=>t(d.target.value),onFocus:()=>l(!0),onBlur:()=>l(!1),style:{width:"100%",padding:8,borderRadius:8,border:"1px solid #ddd"}}),i&&r.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:"慢慢寫，我在。"}),r.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[r.jsx("button",{onClick:c,disabled:a,style:{padding:"8px 12px",borderRadius:8,background:"#1749D7",color:"#fff",border:"1px solid #1749D7"},children:a?"生成中…":"存入便條（含回聲）"}),s&&r.jsxs("span",{style:{color:"#6b7280"},children:["AI 回聲：",s]})]})]})};function td(e){const t=e.split(`
`).find(n=>n.trim().startsWith("#tags"));return t?t.replace(/^#tags\s*[:：]\s*/i,"").split(",").map(n=>n.trim()).filter(Boolean).slice(0,5):[]}const sd=()=>{const[e,t]=g.useState(""),[s,n]=g.useState(""),[a,o]=g.useState(""),[i,l]=g.useState(null),[c,d]=g.useState(!1),u=async()=>{d(!0);try{const p=await Al(e,s,a);l(p);const f=td(p);f.length&&bl(f),ue(he.DebriefGen,{tags:f})}finally{d(!1)}},m=()=>{const p=`【看屋小結】
喜歡：${e}
困擾：${s}
下一步：${a}
---
${i??""}`;rr(p),ue(he.DebriefSave,{})};return r.jsxs("div",{style:{border:"1px solid #eee",borderRadius:12,padding:12,background:"#fff"},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"看屋後三問（Mini Debrief）"}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("input",{value:e,onChange:p=>t(p.target.value),placeholder:"第一直覺如何？（例：採光很好）",style:{padding:8,borderRadius:8,border:"1px solid #ddd"}}),r.jsx("input",{value:s,onChange:p=>n(p.target.value),placeholder:"哪裡卡卡的？（例：廚房太小）",style:{padding:8,borderRadius:8,border:"1px solid #ddd"}}),r.jsx("input",{value:a,onChange:p=>o(p.target.value),placeholder:"下一步想做什麼？（例：再看一間對比）",style:{padding:8,borderRadius:8,border:"1px solid #ddd"}})]}),r.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[r.jsx("button",{onClick:u,disabled:c,style:{padding:"8px 12px",borderRadius:8,background:"#1749D7",color:"#fff",border:"1px solid #1749D7"},children:c?"整理中…":"生成 Must/Nice/Avoid + #tags"}),i&&r.jsx("button",{onClick:m,style:{padding:"8px 12px",borderRadius:8,border:"1px solid #1749D7",background:"#fff",color:"#1749D7"},children:"存到便條"})]}),i&&r.jsx("div",{style:{marginTop:10,whiteSpace:"pre-wrap",color:"#0a2246"},children:i})]})},rd=["持分","使用分區","公設比","地上權","都更","容積率"],hn=({text:e})=>{const[t,s]=g.useState(!1),[n,a]=g.useState(""),[o,i]=g.useState(!1),l=async()=>{if(!n){i(!0);try{const d=await Tl(e);a(d),ue(he.ELI5Open,{term:e})}finally{i(!1)}}};g.useEffect(()=>{const u=`mai-eli5-suggest-${new Date().toISOString().slice(0,10)}`;rd.some(p=>e.includes(p))&&!localStorage.getItem(u)&&(localStorage.setItem(u,"1"),s(!0),l())},[]);const c=async()=>{const d=!t;s(d),d&&await l()};return r.jsxs("span",{style:{display:"inline-flex",alignItems:"center",position:"relative"},children:[r.jsx("button",{"aria-label":"白話解釋",onClick:c,style:{marginLeft:6,width:18,height:18,borderRadius:999,border:"1px solid #C9D5FF",background:"#F5F8FF",color:"#1749D7",fontSize:12,cursor:"pointer"},children:"?"}),t&&r.jsxs("div",{style:{position:"absolute",top:"120%",left:0,background:"#fff",border:"1px solid #E6ECFF",borderRadius:8,padding:10,width:280,boxShadow:"0 10px 24px rgba(0,0,0,0.08)",zIndex:50},children:[r.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"白話解釋（僅供參考，非法律意見）"}),r.jsx("div",{style:{whiteSpace:"pre-wrap"},children:o?"生成中…":n})]})]})};function nd(){return r.jsxs("section",{className:"mx-auto mt-8 max-w-container space-y-6 rounded-[var(--r-lg)] bg-white p-6 shadow-[var(--shadow-card)]",children:[r.jsx("h1",{className:"text-xl font-semibold",children:"物件詳情"}),r.jsx("p",{className:"mt-2 text-sm text-[var(--text-secondary)]",children:"示意頁。"}),r.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:[r.jsx("h2",{className:"mb-3 text-lg font-medium",children:"房貸負擔試算"}),r.jsx(Kc,{})]}),r.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:[r.jsx("h2",{className:"mb-3 text-lg font-medium",children:"禮貌改寫訊息"}),r.jsx(Jc,{})]}),r.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:[r.jsx("h2",{className:"mb-3 text-lg font-medium",children:"看房筆記"}),r.jsx(ed,{})]}),r.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:[r.jsx("h2",{className:"mb-3 text-lg font-medium",children:"看房心得"}),r.jsx(sd,{})]}),r.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:[r.jsx("h2",{className:"mb-3 text-lg font-medium",children:"專有名詞解釋"}),r.jsxs("p",{className:"text-sm text-gray-600",children:["這個物件的",r.jsx(hn,{text:"容積率"})," 和",r.jsx(hn,{text:"建蔽率"})," 都符合法規標準。"]})]})]})}const ad={5:30*1e3},nr=e=>({id:e,currentStep:1,isPaid:!1,steps:{1:{name:"已電聯",agentStatus:"pending",buyerStatus:"pending",data:{},locked:!1},2:{name:"已帶看",agentStatus:"pending",buyerStatus:"pending",locked:!1,data:{risks:{water:!1,wall:!1,structure:!1,other:!1}}},3:{name:"已出價",agentStatus:"pending",buyerStatus:"pending",data:{},locked:!1},4:{name:"已斡旋",agentStatus:"pending",buyerStatus:"pending",data:{},locked:!1},5:{name:"已成交",agentStatus:"pending",buyerStatus:"pending",locked:!1,paymentStatus:"pending",paymentDeadline:null,data:{}},6:{name:"已交屋",agentStatus:"pending",buyerStatus:"pending",locked:!1,checklist:[],data:{}}},supplements:[]}),mn=e=>{if(typeof window>"u")return nr(e);const t=sessionStorage.getItem(`mock_tx_${e}`);return t?JSON.parse(t):nr(e)},pn=e=>{typeof window<"u"&&sessionStorage.setItem(`mock_tx_${e.id}`,JSON.stringify(e))},is={fetchData:async e=>mn(e),dispatch:async(e,t,s,n)=>{var l,c,d;await new Promise(u=>setTimeout(u,600));const a=mn(t),o=JSON.parse(JSON.stringify(a)),i=parseInt(n.step||o.currentStep);try{switch(e){case"submit":if(s!=="agent")throw new Error("權限不足");o.steps[i]&&(o.steps[i].data={...o.steps[i].data,...n.data},o.steps[i].agentStatus="submitted");break;case"confirm":if(s!=="buyer")throw new Error("權限不足");if(o.steps[i]&&(o.steps[i].buyerStatus="confirmed",n.note&&(o.steps[i].data={...o.steps[i].data,buyerNote:n.note})),i===5)o.steps[5]&&(o.steps[5].paymentStatus="initiated",o.steps[5].paymentDeadline=Date.now()+(ad[5]||3e4));else if(i===6){if(!((c=(l=o.steps[6])==null?void 0:l.checklist)==null?void 0:c.every(f=>f.checked)))throw new Error("檢查項目未完成");o.steps[6]&&(o.steps[6].locked=!0)}else o.steps[i]&&(o.steps[i].locked=!0),o.currentStep+=1;break;case"payment":if(s!=="agent")throw new Error("權限不足");if(((d=o.steps[5])==null?void 0:d.paymentStatus)!=="initiated")throw new Error("非付款狀態");o.isPaid=!0,o.steps[5]&&(o.steps[5].paymentStatus="completed",o.steps[5].locked=!0),o.currentStep=6,o.steps[6]&&(o.steps[6].checklist=[{id:"utilities",label:"🚰 水電瓦斯功能正常",checked:!1},{id:"security",label:"🪟 門窗鎖具開關正常",checked:!1},{id:"keys",label:"🔑 鑰匙門禁卡點交",checked:!1},{id:"condition",label:"🧱 房屋現況確認 (漏水/壁癌等)",checked:!1}]);break;case"checklist":const u=o.steps[6];if(u&&u.checklist){const p=u.checklist.find(f=>f.id===n.itemId);p&&(p.checked=n.checked)}break;case"supplement":o.supplements.push({role:s,content:n.content,timestamp:Date.now()});break;case"reset":const m=nr(t);return pn(m),{success:!0,tx:m}}return pn(o),{success:!0,tx:o}}catch(u){return{success:!1,error:u.message}}}},$s={fetchData:async(e,t)=>{try{const s=await fetch(`/api/trust/status?id=${e}`);if(s.ok)return await s.json();if(s.status===401||s.status===403)throw new Error("UNAUTHORIZED");return null}catch(s){if(s.message==="UNAUTHORIZED")throw s;return console.error(s),null}},dispatch:async(e,t,s,n)=>{try{const a=await fetch(`/api/trust/${e}?id=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(a.status===401||a.status===403)return{success:!1,error:"UNAUTHORIZED"};const o=await a.json();return o.error?{success:!1,error:o.error}:{success:!0,tx:o.state||o}}catch(a){return{success:!1,error:a.message}}}};function od(){const[e,t]=g.useState(!1),[s,n]=g.useState(""),[a,o]=g.useState("agent"),[i,l]=g.useState(null),[c,d]=g.useState(!0),[u,m]=g.useState(!1),[p,f]=g.useState("--:--:--"),[v,_]=g.useState(!1);g.useEffect(()=>{if(typeof window>"u")return;(async()=>{const w=window.location.hash;if(w.includes("token=")){const N=w.split("token=")[1];window.history.replaceState(null,"",window.location.pathname);try{await fetch("/api/trust/session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:N})})}catch(S){console.error("Session exchange failed",S),Se.error("無效的連結或憑證")}}try{const N=await fetch("/api/trust/me");if(N.ok){const S=await N.json();o(S.role),n(S.caseId),t(!1),_(!1),await k(S.caseId)}else d(!1)}catch(N){console.error(N),d(!1)}})()},[]);const y=g.useCallback(async()=>{t(!0),_(!1);const z="MOCK-DEMO-01";n(z),o("agent");const w=await is.fetchData(z);l(w),Se.success("已進入演示模式 (資料僅暫存於瀏覽器)")},[]),k=g.useCallback(async z=>{const w=z||s;if(w&&!(v&&!e)){d(!0);try{let N;e?N=await is.fetchData(w):N=await $s.fetchData(w,""),N&&(l(N),_(!1))}catch(N){console.error(N),N.message==="UNAUTHORIZED"&&(_(!0),Se.error("連線逾時，請重新登入"))}finally{d(!1)}}},[e,s,v]);g.useEffect(()=>{if(!e&&s&&!v){const z=setInterval(()=>k(),5e3);return()=>clearInterval(z)}},[s,e,k,v]),g.useEffect(()=>{const z=setInterval(()=>{var w,N;if(((N=(w=i==null?void 0:i.steps)==null?void 0:w[5])==null?void 0:N.paymentStatus)==="initiated"&&i.steps[5].paymentDeadline){const S=i.steps[5].paymentDeadline-Date.now();if(S<=0)f("已逾期"),e||k();else{const T=Math.floor(S/36e5),j=Math.floor(S%36e5/6e4),Z=Math.floor(S%6e4/1e3);f(`${T}:${j.toString().padStart(2,"0")}:${Z.toString().padStart(2,"0")}`)}}},1e3);return()=>clearInterval(z)},[i,e,k]);const O=g.useCallback(async(z,w={})=>{if(!u){m(!0);try{const N=e?is:$s;let S;return e?S=await is.dispatch(z,s,a,w):S=await $s.dispatch(z,s,"",w),S.success?(S.tx&&l(S.tx),await k(),Se.success("成功"),!0):(S.error==="UNAUTHORIZED"?(_(!0),Se.error("連線逾時，請重新登入")):Se.error(S.error||"操作失敗"),!1)}catch(N){return console.error(N),Se.error("發生未預期的錯誤"),!1}finally{m(!1)}}},[e,s,a,k,u]);return{isMock:e,caseId:s,setCaseId:n,role:a,setRole:o,setToken:()=>{},token:"",tx:i,setTx:l,loading:c,isBusy:u,timeLeft:p,startMockMode:y,dispatchAction:O,fetchData:k}}function fn(){Jn();const{isMock:e,caseId:t,role:s,setRole:n,tx:a,loading:o,isBusy:i,timeLeft:l,startMockMode:c,dispatchAction:d}=od(),[u,m]=g.useState(""),[p,f]=g.useState("");typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname.includes("127.0.0.1"));const v=async(T,j={})=>{await d(T,j)&&(m(""),f(""))},_=T=>v("submit",{step:T,data:{note:u}}),y=T=>v("confirm",{step:T,note:u}),k=()=>{confirm("確認模擬付款？")&&v("payment")},O=(T,j)=>{s==="buyer"&&v("checklist",{itemId:T,checked:j})},z=()=>v("supplement",{content:p}),w=()=>{confirm("重置所有進度？")&&v("reset")},N=()=>{n(s==="agent"?"buyer":"agent")};if(!a&&!o)return r.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-slate-100 p-4 font-sans",children:r.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-xl max-w-sm w-full text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx(Fr,{size:32})}),r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"安心留痕 Trust Room"}),r.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"目前未檢測到有效的登入憑證 (Token)。您可以進入演示模式來測試功能。"}),r.jsxs("button",{onClick:c,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl transition shadow-lg flex items-center justify-center gap-2",children:[r.jsx(Fr,{size:18}),"啟動演示模式 (Demo Mode)"]}),r.jsx("p",{className:"text-xs text-gray-400 mt-4",children:"此模式下資料不會保存到資料庫。"})]})});if(!a)return r.jsx("div",{className:"p-8 text-center",children:"載入中..."});const S=T=>{switch(T){case"1":return r.jsx(hr,{size:14});case"2":return r.jsx(oi,{size:14});case"3":return r.jsx(Yn,{size:14});case"4":return r.jsx(ai,{size:14});case"5":return r.jsx(ni,{size:14});case"6":return r.jsx(Dt,{size:14});default:return r.jsx(ri,{size:14})}};return r.jsxs("div",{className:"max-w-md mx-auto min-h-screen bg-white shadow-2xl relative pb-24 font-sans text-gray-800",children:[r.jsx(ea,{position:"top-center"}),r.jsxs("header",{className:`${e?"bg-indigo-900":"bg-slate-900"} text-white p-4 sticky top-0 z-50 flex justify-between items-center shadow-lg transition-colors`,children:[r.jsxs("div",{children:[r.jsxs("h1",{className:"font-bold text-lg tracking-wide flex items-center gap-2",children:["MaiHouses ",r.jsx("span",{className:`text-xs px-1 rounded ${e?"bg-yellow-500 text-black":"bg-blue-600"}`,children:e?"DEMO":"V10"})]}),r.jsxs("div",{className:"flex items-center text-[10px] text-gray-400 gap-2",children:[r.jsxs("span",{children:["案號: ",t]}),o&&r.jsx("span",{className:"animate-pulse",children:"●"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:w,className:"bg-white/10 hover:bg-white/20 w-8 h-8 rounded flex items-center justify-center transition",children:r.jsx(Xo,{size:14})}),r.jsxs("button",{onClick:N,className:`px-3 py-1 rounded-md text-xs font-bold border border-white/20 flex items-center gap-1 transition ${s==="agent"?"bg-blue-600":"bg-green-600"}`,children:[s==="agent"?r.jsx(ei,{size:12}):r.jsx(ti,{size:12}),s==="agent"?"房仲":"買方"]})]})]}),r.jsxs("div",{className:"p-4 bg-slate-50 border-b sticky top-[60px] z-40",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsxs("span",{className:"text-xs font-bold text-slate-700",children:["進度 ",a.currentStep,"/6"]}),a.isPaid&&r.jsx("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-0.5 rounded-full font-bold",children:"已履約"})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:r.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-700",style:{width:`${a.currentStep/6*100}%`}})})]}),r.jsxs("div",{className:"p-4 space-y-0",children:[Object.entries(a.steps).map(([T,j])=>{var ft;const Z=parseInt(T),P=Z===a.currentStep,J=Z<a.currentStep,pe=Z>a.currentStep;let ye="bg-gray-300 border-gray-300";return J||j.locked?ye="bg-green-500 border-green-500":P&&(ye="bg-blue-600 border-blue-600"),r.jsxs("div",{className:`relative pl-14 py-3 ${pe?"opacity-50 grayscale":""}`,children:[r.jsx("div",{className:`absolute left-0 top-3 z-10 w-10 h-10 rounded-full flex items-center justify-center border-4 border-white shadow-sm transition-colors text-white ${ye}`,children:S(T)}),T!=="6"&&r.jsx("div",{className:"absolute left-[24px] top-[50px] bottom-[-20px] w-[2px] bg-gray-200 z-0"}),r.jsxs("div",{className:`bg-white border rounded-xl p-4 shadow-sm transition-all ${P?"border-blue-500 ring-2 ring-blue-50":"border-gray-200"}`,children:[r.jsxs("div",{className:"flex justify-between items-start mb-3",children:[r.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[j.name,T==="5"&&j.paymentStatus==="initiated"&&!j.locked&&r.jsx("span",{className:"text-[10px] text-orange-500 bg-orange-50 px-2 rounded animate-pulse",children:"付款中"}),T==="5"&&j.paymentStatus==="expired"&&r.jsx("span",{className:"text-[10px] text-red-500 bg-red-50 px-2 rounded",children:"逾期"})]}),j.locked&&r.jsx(si,{size:14,className:"text-green-600"})]}),T==="2"&&j.data.note&&r.jsxs("div",{className:"mb-3 p-3 bg-gray-50 rounded border border-gray-100",children:[r.jsx("p",{className:"text-xs font-bold text-gray-500 mb-2 border-b pb-1",children:"📢 房仲帶看紀錄"}),r.jsx("div",{className:"text-sm whitespace-pre-wrap",children:j.data.note})]}),T==="5"&&j.paymentStatus==="initiated"&&!j.locked&&r.jsxs("div",{className:"mb-4 text-center p-4 bg-orange-50 rounded-lg border border-orange-200",children:[r.jsx("div",{className:"text-2xl font-mono text-orange-600 font-bold mb-1",children:l}),r.jsx("div",{className:"text-xs text-orange-400 mb-3",children:"付款截止"}),s==="agent"?r.jsx("button",{onClick:k,disabled:i||l==="已逾期",className:`w-full text-white font-bold py-2 rounded shadow ${l==="已逾期"?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r from-orange-500 to-red-500 hover:shadow-lg"}`,children:l==="已逾期"?"付款已截止":i?"處理中...":"房仲代付 NT$ 2,000"}):r.jsx("div",{className:"text-xs text-gray-400",children:"等待房仲付款..."})]}),T==="6"&&!j.locked&&a.isPaid&&r.jsxs("div",{className:"space-y-2 mt-2",children:[(ft=j.checklist)==null?void 0:ft.map(V=>r.jsxs("div",{onClick:()=>O(V.id,!V.checked),className:`flex items-center p-4 border rounded transition cursor-pointer ${V.checked?"bg-indigo-50 border-indigo-200":"hover:bg-gray-50"}`,children:[r.jsx("div",{className:`w-5 h-5 border rounded flex items-center justify-center bg-white ${V.checked?"bg-indigo-600 border-indigo-600":""}`,children:V.checked&&r.jsx(ta,{size:12,className:"text-white"})}),r.jsx("span",{className:`ml-3 text-sm ${V.checked?"text-indigo-800 font-bold":""}`,children:V.label})]},V.id)),r.jsx("button",{onClick:()=>y("6"),className:"w-full bg-indigo-600 text-white py-2 rounded font-bold mt-2",children:"完成交屋"})]}),!j.locked&&P&&T!=="5"&&T!=="6"&&r.jsxs("div",{children:[s==="agent"&&(j.agentStatus==="pending"?r.jsxs("div",{children:[r.jsx("textarea",{value:u,onChange:V=>m(V.target.value),className:"w-full border p-2 rounded text-sm mb-2 focus:ring-2 ring-blue-200 outline-none",placeholder:"輸入紀錄..."}),r.jsx("button",{onClick:()=>_(T),disabled:i,className:"w-full bg-slate-800 text-white py-2 rounded text-sm",children:i?"...":"送出"})]}):r.jsx("div",{className:"text-center text-xs text-gray-400 py-2 bg-gray-50 rounded",children:"等待買方確認..."})),s==="buyer"&&(j.agentStatus==="submitted"?r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"房仲已提交，請核對："}),r.jsx("div",{className:"p-2 bg-gray-50 rounded border text-sm mb-2 whitespace-pre-wrap",children:j.data.note||"（已提交表單）"}),r.jsx("textarea",{value:u,onChange:V=>m(V.target.value),className:"w-full border p-2 rounded text-sm mb-2 focus:ring-2 ring-green-200 outline-none",placeholder:"留言給房仲 (選填)..."}),r.jsx("button",{onClick:()=>y(T),disabled:i,className:"w-full bg-green-600 text-white py-2 rounded text-sm",children:i?"...":"確認無誤並送出"})]}):r.jsx("div",{className:"text-center text-xs text-gray-400 py-2",children:"等待房仲提交..."}))]}),j.data.buyerNote&&r.jsxs("div",{className:"mt-2 p-2 bg-green-50 rounded border border-green-100 text-xs",children:[r.jsx("span",{className:"font-bold text-green-700",children:"買方留言："})," ",j.data.buyerNote]}),T==="5"&&!j.locked&&j.paymentStatus==="pending"&&r.jsxs("div",{children:[s==="agent"&&j.agentStatus==="pending"&&r.jsx("button",{onClick:()=>_("5"),className:"w-full bg-slate-800 text-white py-2 rounded",children:"上傳合約並送出"}),s==="buyer"&&j.agentStatus==="submitted"&&r.jsx("button",{onClick:()=>y("5"),className:"w-full bg-green-600 text-white py-2 rounded",children:"確認合約 (將啟動付款)"})]}),a.supplements.length>0&&r.jsx("div",{className:"mt-4 pt-4 border-t border-dashed",children:a.supplements.map((V,we)=>r.jsxs("div",{className:"text-xs mb-1 p-2 bg-gray-50 rounded border border-gray-100 flex gap-2",children:[r.jsx("span",{className:"font-bold",children:V.role==="agent"?"👨‍💼":"👤"}),r.jsx("span",{className:"flex-1",children:V.content})]},we))})]})]},T)}),r.jsxs("div",{className:"mt-8 bg-white p-4 rounded-xl shadow-sm border",children:[r.jsx("h4",{className:"text-xs font-bold text-gray-500 mb-2",children:"📝 新增補充紀錄 (修正/勘誤)"}),r.jsx("p",{className:"text-[10px] text-gray-400 mb-2",children:"若之前的留言有誤，請在此新增補充說明。已送出的內容無法修改。"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{value:p,onChange:T=>f(T.target.value),className:"flex-1 border rounded px-3 py-2 text-sm",placeholder:"輸入備註..."}),r.jsx("button",{onClick:z,disabled:!p,className:"bg-gray-800 text-white px-4 rounded text-sm",children:"送出"})]})]})]})]})}function id(){return r.jsx("main",{className:"mx-auto max-w-container p-4 md:p-6",children:r.jsx(eo,{})})}let _e=class extends g.Component{constructor(){super(...arguments),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(t){console.error(t);try{Kt("error_boundary","*",String(t.message||t))}catch{}}render(){return this.state.hasError?r.jsx("div",{className:"rounded-[var(--r-lg)] bg-white p-4 text-[var(--danger)] shadow-[var(--shadow-card)]",children:"區塊錯誤，請重試。"}):this.props.children}};const ld=g.createContext(null),cd=({children:e})=>{const[t,s]=g.useState(()=>localStorage.getItem("mai-mood-v1")||"neutral"),n=l=>{s(l),localStorage.setItem("mai-mood-v1",l),vl(l),ue(he.MoodPick,{mood:l})},a=t==="stress"?"soothe":t==="rest"?"warm":"light",o=t==="stress"?2:t==="rest"?1:0,i=g.useMemo(()=>({mood:t,setMood:n,tone:a,throttleLevel:o}),[t]);return r.jsx(ld.Provider,{value:i,children:e})};function dd(){const[e,t]=g.useState(!1);g.useEffect(()=>{localStorage.getItem("cookie-consent")||t(!0)},[]);const s=()=>{localStorage.setItem("cookie-consent","true"),t(!1)};return e?r.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50 bg-gray-900 p-4 text-white shadow-lg md:p-6",children:r.jsxs("div",{className:"mx-auto flex max-w-container flex-col items-center justify-between gap-4 md:flex-row",children:[r.jsx("div",{className:"text-sm text-gray-300",children:"我們使用 Cookie 來改善您的瀏覽體驗並提供個人化內容。繼續瀏覽即表示您同意我們的隱私權政策。"}),r.jsx("div",{className:"flex gap-3",children:r.jsx("button",{onClick:s,className:"rounded-full bg-brand px-6 py-2 text-sm font-medium text-white transition-colors hover:bg-blue-600",children:"我同意"})})]})}):null}const ud=g.createContext(null),Ps={didCatch:!1,error:null};class hd extends g.Component{constructor(t){super(t),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=Ps}static getDerivedStateFromError(t){return{didCatch:!0,error:t}}resetErrorBoundary(){const{error:t}=this.state;if(t!==null){for(var s,n,a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];(s=(n=this.props).onReset)===null||s===void 0||s.call(n,{args:o,reason:"imperative-api"}),this.setState(Ps)}}componentDidCatch(t,s){var n,a;(n=(a=this.props).onError)===null||n===void 0||n.call(a,t,s)}componentDidUpdate(t,s){const{didCatch:n}=this.state,{resetKeys:a}=this.props;if(n&&s.error!==null&&md(t.resetKeys,a)){var o,i;(o=(i=this.props).onReset)===null||o===void 0||o.call(i,{next:a,prev:t.resetKeys,reason:"keys"}),this.setState(Ps)}}render(){const{children:t,fallbackRender:s,FallbackComponent:n,fallback:a}=this.props,{didCatch:o,error:i}=this.state;let l=t;if(o){const c={error:i,resetErrorBoundary:this.resetErrorBoundary};if(typeof s=="function")l=s(c);else if(n)l=g.createElement(n,c);else if(a!==void 0)l=a;else throw i}return g.createElement(ud.Provider,{value:{didCatch:o,error:i,resetErrorBoundary:this.resetErrorBoundary}},l)}}function md(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e.length!==t.length||e.some((s,n)=>!Object.is(s,t[n]))}const pd="_primary_10s9u_154",fd="_float_10s9u_1",gd="_pulse_10s9u_1",xd="_selected_10s9u_210",bd="_urgent_10s9u_288",vd="_shimmer_10s9u_1",x={"uag-page":"_uag-page_10s9u_26","uag-header":"_uag-header_10s9u_51","uag-header-inner":"_uag-header-inner_10s9u_58","uag-logo":"_uag-logo_10s9u_63","uag-logo-badge":"_uag-logo-badge_10s9u_64","uag-container":"_uag-container_10s9u_70","uag-grid":"_uag-grid_10s9u_71","k-span-2":"_k-span-2_10s9u_74","k-span-3":"_k-span-3_10s9u_75","k-span-4":"_k-span-4_10s9u_76","k-span-6":"_k-span-6_10s9u_77","uag-breadcrumb":"_uag-breadcrumb_10s9u_87","uag-badge--pro":"_uag-badge--pro_10s9u_101","uag-card":"_uag-card_10s9u_108","uag-card-header":"_uag-card-header_10s9u_122","uag-card-title":"_uag-card-title_10s9u_123","uag-card-sub":"_uag-card-sub_10s9u_128","uag-actions":"_uag-actions_10s9u_133","uag-btn":"_uag-btn_10s9u_144",primary:pd,"uag-badge":"_uag-badge_10s9u_101","uag-badge--s":"_uag-badge--s_10s9u_169","uag-badge--a":"_uag-badge--a_10s9u_170","uag-cluster":"_uag-cluster_10s9u_173","uag-bubble":"_uag-bubble_10s9u_199",float:fd,pulse:gd,selected:xd,"uag-bubble-grade":"_uag-bubble-grade_10s9u_222","uag-bubble-label":"_uag-bubble-label_10s9u_227","uag-action-panel":"_uag-action-panel_10s9u_240","ap-head":"_ap-head_10s9u_247","ap-body":"_ap-body_10s9u_253","ap-stats-group":"_ap-stats-group_10s9u_262","ai-box":"_ai-box_10s9u_263","action-zone":"_action-zone_10s9u_264","ap-stat":"_ap-stat_10s9u_262",urgent:bd,"btn-attack":"_btn-attack_10s9u_295",shimmer:vd,"monitor-table":"_monitor-table_10s9u_335","progress-bg":"_progress-bg_10s9u_358","progress-fill":"_progress-fill_10s9u_359","t-countdown":"_t-countdown_10s9u_360","listing-item":"_listing-item_10s9u_363","l-thumb":"_l-thumb_10s9u_369","l-title":"_l-title_10s9u_370","l-tags":"_l-tags_10s9u_371","l-tag":"_l-tag_10s9u_371","l-kpi":"_l-kpi_10s9u_373","feed-post":"_feed-post_10s9u_382","fp-title":"_fp-title_10s9u_384","fp-meta":"_fp-meta_10s9u_385","fp-body":"_fp-body_10s9u_386","mai-card":"_mai-card_10s9u_389","mai-head":"_mai-head_10s9u_403","mai-tag":"_mai-tag_10s9u_408","mai-title":"_mai-title_10s9u_409","mai-sub":"_mai-sub_10s9u_410","mai-body":"_mai-body_10s9u_411","mai-left":"_mai-left_10s9u_412","mai-price":"_mai-price_10s9u_413","mai-price-label":"_mai-price-label_10s9u_414","mai-price-value":"_mai-price-value_10s9u_415","mai-price-unit":"_mai-price-unit_10s9u_416","mai-stats":"_mai-stats_10s9u_417","mai-right":"_mai-right_10s9u_420","mai-thumb":"_mai-thumb_10s9u_421","mai-mini":"_mai-mini_10s9u_422","mai-actions":"_mai-actions_10s9u_424","mai-btn":"_mai-btn_10s9u_425","flow-stage":"_flow-stage_10s9u_445","uag-footer-bar":"_uag-footer-bar_10s9u_448"};function b(e,t,s){function n(l,c){var d;Object.defineProperty(l,"_zod",{value:l._zod??{},enumerable:!1}),(d=l._zod).traits??(d.traits=new Set),l._zod.traits.add(e),t(l,c);for(const u in i.prototype)u in l||Object.defineProperty(l,u,{value:i.prototype[u].bind(l)});l._zod.constr=i,l._zod.def=c}const a=(s==null?void 0:s.Parent)??Object;class o extends a{}Object.defineProperty(o,"name",{value:e});function i(l){var c;const d=s!=null&&s.Parent?new o:this;n(d,l),(c=d._zod).deferred??(c.deferred=[]);for(const u of d._zod.deferred)u();return d}return Object.defineProperty(i,"init",{value:n}),Object.defineProperty(i,Symbol.hasInstance,{value:l=>{var c,d;return s!=null&&s.Parent&&l instanceof s.Parent?!0:(d=(c=l==null?void 0:l._zod)==null?void 0:c.traits)==null?void 0:d.has(e)}}),Object.defineProperty(i,"name",{value:e}),i}class vt extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class ao extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const oo={};function ut(e){return oo}function yd(e){const t=Object.values(e).filter(n=>typeof n=="number");return Object.entries(e).filter(([n,a])=>t.indexOf(+n)===-1).map(([n,a])=>a)}function ar(e,t){return typeof t=="bigint"?t.toString():t}function _r(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function kr(e){return e==null}function Nr(e){const t=e.startsWith("^")?1:0,s=e.endsWith("$")?e.length-1:e.length;return e.slice(t,s)}function wd(e,t){const s=(e.toString().split(".")[1]||"").length,n=t.toString();let a=(n.split(".")[1]||"").length;if(a===0&&/\d?e-\d?/.test(n)){const c=n.match(/\d?e-(\d?)/);c!=null&&c[1]&&(a=Number.parseInt(c[1]))}const o=s>a?s:a,i=Number.parseInt(e.toFixed(o).replace(".","")),l=Number.parseInt(t.toFixed(o).replace(".",""));return i%l/10**o}const gn=Symbol("evaluating");function B(e,t,s){let n;Object.defineProperty(e,t,{get(){if(n!==gn)return n===void 0&&(n=gn,n=s()),n},set(a){Object.defineProperty(e,t,{value:a})},configurable:!0})}function mt(e,t,s){Object.defineProperty(e,t,{value:s,writable:!0,enumerable:!0,configurable:!0})}function pt(...e){const t={};for(const s of e){const n=Object.getOwnPropertyDescriptors(s);Object.assign(t,n)}return Object.defineProperties({},t)}function xn(e){return JSON.stringify(e)}const io="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function vs(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const jd=_r(()=>{var e;if(typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)!=null&&e.includes("Cloudflare")))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function Zt(e){if(vs(e)===!1)return!1;const t=e.constructor;if(t===void 0)return!0;const s=t.prototype;return!(vs(s)===!1||Object.prototype.hasOwnProperty.call(s,"isPrototypeOf")===!1)}function lo(e){return Zt(e)?{...e}:Array.isArray(e)?[...e]:e}const _d=new Set(["string","number","symbol"]);function Ns(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function He(e,t,s){const n=new e._zod.constr(t??e._zod.def);return(!t||s!=null&&s.parent)&&(n._zod.parent=e),n}function R(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if((t==null?void 0:t.message)!==void 0){if((t==null?void 0:t.error)!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function kd(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const Nd={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function Sd(e,t){const s=e._zod.def,n=pt(e._zod.def,{get shape(){const a={};for(const o in t){if(!(o in s.shape))throw new Error(`Unrecognized key: "${o}"`);t[o]&&(a[o]=s.shape[o])}return mt(this,"shape",a),a},checks:[]});return He(e,n)}function Cd(e,t){const s=e._zod.def,n=pt(e._zod.def,{get shape(){const a={...e._zod.def.shape};for(const o in t){if(!(o in s.shape))throw new Error(`Unrecognized key: "${o}"`);t[o]&&delete a[o]}return mt(this,"shape",a),a},checks:[]});return He(e,n)}function zd(e,t){if(!Zt(t))throw new Error("Invalid input to extend: expected a plain object");const s=e._zod.def.checks;if(s&&s.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const a=pt(e._zod.def,{get shape(){const o={...e._zod.def.shape,...t};return mt(this,"shape",o),o},checks:[]});return He(e,a)}function Ed(e,t){if(!Zt(t))throw new Error("Invalid input to safeExtend: expected a plain object");const s={...e._zod.def,get shape(){const n={...e._zod.def.shape,...t};return mt(this,"shape",n),n},checks:e._zod.def.checks};return He(e,s)}function Id(e,t){const s=pt(e._zod.def,{get shape(){const n={...e._zod.def.shape,...t._zod.def.shape};return mt(this,"shape",n),n},get catchall(){return t._zod.def.catchall},checks:[]});return He(e,s)}function Td(e,t,s){const n=pt(t._zod.def,{get shape(){const a=t._zod.def.shape,o={...a};if(s)for(const i in s){if(!(i in a))throw new Error(`Unrecognized key: "${i}"`);s[i]&&(o[i]=e?new e({type:"optional",innerType:a[i]}):a[i])}else for(const i in a)o[i]=e?new e({type:"optional",innerType:a[i]}):a[i];return mt(this,"shape",o),o},checks:[]});return He(t,n)}function Ad(e,t,s){const n=pt(t._zod.def,{get shape(){const a=t._zod.def.shape,o={...a};if(s)for(const i in s){if(!(i in o))throw new Error(`Unrecognized key: "${i}"`);s[i]&&(o[i]=new e({type:"nonoptional",innerType:a[i]}))}else for(const i in a)o[i]=new e({type:"nonoptional",innerType:a[i]});return mt(this,"shape",o),o},checks:[]});return He(t,n)}function bt(e,t=0){var s;if(e.aborted===!0)return!0;for(let n=t;n<e.issues.length;n++)if(((s=e.issues[n])==null?void 0:s.continue)!==!0)return!0;return!1}function co(e,t){return t.map(s=>{var n;return(n=s).path??(n.path=[]),s.path.unshift(e),s})}function ls(e){return typeof e=="string"?e:e==null?void 0:e.message}function ht(e,t,s){var a,o,i,l,c,d;const n={...e,path:e.path??[]};if(!e.message){const u=ls((i=(o=(a=e.inst)==null?void 0:a._zod.def)==null?void 0:o.error)==null?void 0:i.call(o,e))??ls((l=t==null?void 0:t.error)==null?void 0:l.call(t,e))??ls((c=s.customError)==null?void 0:c.call(s,e))??ls((d=s.localeError)==null?void 0:d.call(s,e))??"Invalid input";n.message=u}return delete n.inst,delete n.continue,t!=null&&t.reportInput||delete n.input,n}function Sr(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function Ut(...e){const[t,s,n]=e;return typeof t=="string"?{message:t,code:"custom",input:s,inst:n}:{...t}}const uo=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,ar,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},ho=b("$ZodError",uo),mo=b("$ZodError",uo,{Parent:Error});function Rd(e,t=s=>s.message){const s={},n=[];for(const a of e.issues)a.path.length>0?(s[a.path[0]]=s[a.path[0]]||[],s[a.path[0]].push(t(a))):n.push(t(a));return{formErrors:n,fieldErrors:s}}function $d(e,t=s=>s.message){const s={_errors:[]},n=a=>{for(const o of a.issues)if(o.code==="invalid_union"&&o.errors.length)o.errors.map(i=>n({issues:i}));else if(o.code==="invalid_key")n({issues:o.issues});else if(o.code==="invalid_element")n({issues:o.issues});else if(o.path.length===0)s._errors.push(t(o));else{let i=s,l=0;for(;l<o.path.length;){const c=o.path[l];l===o.path.length-1?(i[c]=i[c]||{_errors:[]},i[c]._errors.push(t(o))):i[c]=i[c]||{_errors:[]},i=i[c],l++}}};return n(e),s}const Cr=e=>(t,s,n,a)=>{const o=n?Object.assign(n,{async:!1}):{async:!1},i=t._zod.run({value:s,issues:[]},o);if(i instanceof Promise)throw new vt;if(i.issues.length){const l=new((a==null?void 0:a.Err)??e)(i.issues.map(c=>ht(c,o,ut())));throw io(l,a==null?void 0:a.callee),l}return i.value},zr=e=>async(t,s,n,a)=>{const o=n?Object.assign(n,{async:!0}):{async:!0};let i=t._zod.run({value:s,issues:[]},o);if(i instanceof Promise&&(i=await i),i.issues.length){const l=new((a==null?void 0:a.Err)??e)(i.issues.map(c=>ht(c,o,ut())));throw io(l,a==null?void 0:a.callee),l}return i.value},Ss=e=>(t,s,n)=>{const a=n?{...n,async:!1}:{async:!1},o=t._zod.run({value:s,issues:[]},a);if(o instanceof Promise)throw new vt;return o.issues.length?{success:!1,error:new(e??ho)(o.issues.map(i=>ht(i,a,ut())))}:{success:!0,data:o.value}},Pd=Ss(mo),Cs=e=>async(t,s,n)=>{const a=n?Object.assign(n,{async:!0}):{async:!0};let o=t._zod.run({value:s,issues:[]},a);return o instanceof Promise&&(o=await o),o.issues.length?{success:!1,error:new e(o.issues.map(i=>ht(i,a,ut())))}:{success:!0,data:o.value}},Od=Cs(mo),Md=e=>(t,s,n)=>{const a=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return Cr(e)(t,s,a)},Fd=e=>(t,s,n)=>Cr(e)(t,s,n),Dd=e=>async(t,s,n)=>{const a=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return zr(e)(t,s,a)},Ld=e=>async(t,s,n)=>zr(e)(t,s,n),Zd=e=>(t,s,n)=>{const a=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return Ss(e)(t,s,a)},Ud=e=>(t,s,n)=>Ss(e)(t,s,n),Bd=e=>async(t,s,n)=>{const a=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return Cs(e)(t,s,a)},qd=e=>async(t,s,n)=>Cs(e)(t,s,n),Wd=/^[cC][^\s-]{8,}$/,Vd=/^[0-9a-z]+$/,Qd=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Gd=/^[0-9a-vA-V]{20}$/,Hd=/^[A-Za-z0-9]{27}$/,Kd=/^[a-zA-Z0-9_-]{21}$/,Jd=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Yd=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,bn=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,Xd=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,eu="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function tu(){return new RegExp(eu,"u")}const su=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ru=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,nu=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,au=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,ou=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,po=/^[A-Za-z0-9_-]*$/,iu=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,lu=/^\+(?:[0-9]){6,14}[0-9]$/,fo="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",cu=new RegExp(`^${fo}$`);function go(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function du(e){return new RegExp(`^${go(e)}$`)}function uu(e){const t=go({precision:e.precision}),s=["Z"];e.local&&s.push(""),e.offset&&s.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const n=`${t}(?:${s.join("|")})`;return new RegExp(`^${fo}T(?:${n})$`)}const hu=e=>{const t=e?`[\\s\\S]{${(e==null?void 0:e.minimum)??0},${(e==null?void 0:e.maximum)??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},mu=/^-?\d+$/,pu=/^-?\d+(?:\.\d+)?/,fu=/^null$/i,gu=/^[^A-Z]*$/,xu=/^[^a-z]*$/,me=b("$ZodCheck",(e,t)=>{var s;e._zod??(e._zod={}),e._zod.def=t,(s=e._zod).onattach??(s.onattach=[])}),xo={number:"number",bigint:"bigint",object:"date"},bo=b("$ZodCheckLessThan",(e,t)=>{me.init(e,t);const s=xo[typeof t.value];e._zod.onattach.push(n=>{const a=n._zod.bag,o=(t.inclusive?a.maximum:a.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<o&&(t.inclusive?a.maximum=t.value:a.exclusiveMaximum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value<=t.value:n.value<t.value)||n.issues.push({origin:s,code:"too_big",maximum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),vo=b("$ZodCheckGreaterThan",(e,t)=>{me.init(e,t);const s=xo[typeof t.value];e._zod.onattach.push(n=>{const a=n._zod.bag,o=(t.inclusive?a.minimum:a.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>o&&(t.inclusive?a.minimum=t.value:a.exclusiveMinimum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value>=t.value:n.value>t.value)||n.issues.push({origin:s,code:"too_small",minimum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),bu=b("$ZodCheckMultipleOf",(e,t)=>{me.init(e,t),e._zod.onattach.push(s=>{var n;(n=s._zod.bag).multipleOf??(n.multipleOf=t.value)}),e._zod.check=s=>{if(typeof s.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof s.value=="bigint"?s.value%t.value===BigInt(0):wd(s.value,t.value)===0)||s.issues.push({origin:typeof s.value,code:"not_multiple_of",divisor:t.value,input:s.value,inst:e,continue:!t.abort})}}),vu=b("$ZodCheckNumberFormat",(e,t)=>{var i;me.init(e,t),t.format=t.format||"float64";const s=(i=t.format)==null?void 0:i.includes("int"),n=s?"int":"number",[a,o]=Nd[t.format];e._zod.onattach.push(l=>{const c=l._zod.bag;c.format=t.format,c.minimum=a,c.maximum=o,s&&(c.pattern=mu)}),e._zod.check=l=>{const c=l.value;if(s){if(!Number.isInteger(c)){l.issues.push({expected:n,format:t.format,code:"invalid_type",continue:!1,input:c,inst:e});return}if(!Number.isSafeInteger(c)){c>0?l.issues.push({input:c,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort}):l.issues.push({input:c,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort});return}}c<a&&l.issues.push({origin:"number",input:c,code:"too_small",minimum:a,inclusive:!0,inst:e,continue:!t.abort}),c>o&&l.issues.push({origin:"number",input:c,code:"too_big",maximum:o,inst:e})}}),yu=b("$ZodCheckMaxLength",(e,t)=>{var s;me.init(e,t),(s=e._zod.def).when??(s.when=n=>{const a=n.value;return!kr(a)&&a.length!==void 0}),e._zod.onattach.push(n=>{const a=n._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<a&&(n._zod.bag.maximum=t.maximum)}),e._zod.check=n=>{const a=n.value;if(a.length<=t.maximum)return;const i=Sr(a);n.issues.push({origin:i,code:"too_big",maximum:t.maximum,inclusive:!0,input:a,inst:e,continue:!t.abort})}}),wu=b("$ZodCheckMinLength",(e,t)=>{var s;me.init(e,t),(s=e._zod.def).when??(s.when=n=>{const a=n.value;return!kr(a)&&a.length!==void 0}),e._zod.onattach.push(n=>{const a=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>a&&(n._zod.bag.minimum=t.minimum)}),e._zod.check=n=>{const a=n.value;if(a.length>=t.minimum)return;const i=Sr(a);n.issues.push({origin:i,code:"too_small",minimum:t.minimum,inclusive:!0,input:a,inst:e,continue:!t.abort})}}),ju=b("$ZodCheckLengthEquals",(e,t)=>{var s;me.init(e,t),(s=e._zod.def).when??(s.when=n=>{const a=n.value;return!kr(a)&&a.length!==void 0}),e._zod.onattach.push(n=>{const a=n._zod.bag;a.minimum=t.length,a.maximum=t.length,a.length=t.length}),e._zod.check=n=>{const a=n.value,o=a.length;if(o===t.length)return;const i=Sr(a),l=o>t.length;n.issues.push({origin:i,...l?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:n.value,inst:e,continue:!t.abort})}}),zs=b("$ZodCheckStringFormat",(e,t)=>{var s,n;me.init(e,t),e._zod.onattach.push(a=>{const o=a._zod.bag;o.format=t.format,t.pattern&&(o.patterns??(o.patterns=new Set),o.patterns.add(t.pattern))}),t.pattern?(s=e._zod).check??(s.check=a=>{t.pattern.lastIndex=0,!t.pattern.test(a.value)&&a.issues.push({origin:"string",code:"invalid_format",format:t.format,input:a.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(n=e._zod).check??(n.check=()=>{})}),_u=b("$ZodCheckRegex",(e,t)=>{zs.init(e,t),e._zod.check=s=>{t.pattern.lastIndex=0,!t.pattern.test(s.value)&&s.issues.push({origin:"string",code:"invalid_format",format:"regex",input:s.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),ku=b("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=gu),zs.init(e,t)}),Nu=b("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=xu),zs.init(e,t)}),Su=b("$ZodCheckIncludes",(e,t)=>{me.init(e,t);const s=Ns(t.includes),n=new RegExp(typeof t.position=="number"?`^.{${t.position}}${s}`:s);t.pattern=n,e._zod.onattach.push(a=>{const o=a._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(n)}),e._zod.check=a=>{a.value.includes(t.includes,t.position)||a.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:a.value,inst:e,continue:!t.abort})}}),Cu=b("$ZodCheckStartsWith",(e,t)=>{me.init(e,t);const s=new RegExp(`^${Ns(t.prefix)}.*`);t.pattern??(t.pattern=s),e._zod.onattach.push(n=>{const a=n._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(s)}),e._zod.check=n=>{n.value.startsWith(t.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:n.value,inst:e,continue:!t.abort})}}),zu=b("$ZodCheckEndsWith",(e,t)=>{me.init(e,t);const s=new RegExp(`.*${Ns(t.suffix)}$`);t.pattern??(t.pattern=s),e._zod.onattach.push(n=>{const a=n._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(s)}),e._zod.check=n=>{n.value.endsWith(t.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:n.value,inst:e,continue:!t.abort})}}),Eu=b("$ZodCheckOverwrite",(e,t)=>{me.init(e,t),e._zod.check=s=>{s.value=t.tx(s.value)}});class Iu{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const n=t.split(`
`).filter(i=>i),a=Math.min(...n.map(i=>i.length-i.trimStart().length)),o=n.map(i=>i.slice(a)).map(i=>" ".repeat(this.indent*2)+i);for(const i of o)this.content.push(i)}compile(){const t=Function,s=this==null?void 0:this.args,a=[...((this==null?void 0:this.content)??[""]).map(o=>`  ${o}`)];return new t(...s,a.join(`
`))}}const Tu={major:4,minor:1,patch:12},G=b("$ZodType",(e,t)=>{var a;var s;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Tu;const n=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&n.unshift(e);for(const o of n)for(const i of o._zod.onattach)i(e);if(n.length===0)(s=e._zod).deferred??(s.deferred=[]),(a=e._zod.deferred)==null||a.push(()=>{e._zod.run=e._zod.parse});else{const o=(l,c,d)=>{let u=bt(l),m;for(const p of c){if(p._zod.def.when){if(!p._zod.def.when(l))continue}else if(u)continue;const f=l.issues.length,v=p._zod.check(l);if(v instanceof Promise&&(d==null?void 0:d.async)===!1)throw new vt;if(m||v instanceof Promise)m=(m??Promise.resolve()).then(async()=>{await v,l.issues.length!==f&&(u||(u=bt(l,f)))});else{if(l.issues.length===f)continue;u||(u=bt(l,f))}}return m?m.then(()=>l):l},i=(l,c,d)=>{if(bt(l))return l.aborted=!0,l;const u=o(c,n,d);if(u instanceof Promise){if(d.async===!1)throw new vt;return u.then(m=>e._zod.parse(m,d))}return e._zod.parse(u,d)};e._zod.run=(l,c)=>{if(c.skipChecks)return e._zod.parse(l,c);if(c.direction==="backward"){const u=e._zod.parse({value:l.value,issues:[]},{...c,skipChecks:!0});return u instanceof Promise?u.then(m=>i(m,l,c)):i(u,l,c)}const d=e._zod.parse(l,c);if(d instanceof Promise){if(c.async===!1)throw new vt;return d.then(u=>o(u,n,c))}return o(d,n,c)}}e["~standard"]={validate:o=>{var i;try{const l=Pd(e,o);return l.success?{value:l.data}:{issues:(i=l.error)==null?void 0:i.issues}}catch{return Od(e,o).then(c=>{var d;return c.success?{value:c.data}:{issues:(d=c.error)==null?void 0:d.issues}})}},vendor:"zod",version:1}}),Er=b("$ZodString",(e,t)=>{var s;G.init(e,t),e._zod.pattern=[...((s=e==null?void 0:e._zod.bag)==null?void 0:s.patterns)??[]].pop()??hu(e._zod.bag),e._zod.parse=(n,a)=>{if(t.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:e}),n}}),q=b("$ZodStringFormat",(e,t)=>{zs.init(e,t),Er.init(e,t)}),Au=b("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=Yd),q.init(e,t)}),Ru=b("$ZodUUID",(e,t)=>{if(t.version){const n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(n===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=bn(n))}else t.pattern??(t.pattern=bn());q.init(e,t)}),$u=b("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=Xd),q.init(e,t)}),Pu=b("$ZodURL",(e,t)=>{q.init(e,t),e._zod.check=s=>{try{const n=s.value.trim(),a=new URL(n);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(a.hostname)||s.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:iu.source,input:s.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(a.protocol.endsWith(":")?a.protocol.slice(0,-1):a.protocol)||s.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:s.value,inst:e,continue:!t.abort})),t.normalize?s.value=a.href:s.value=n;return}catch{s.issues.push({code:"invalid_format",format:"url",input:s.value,inst:e,continue:!t.abort})}}}),Ou=b("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=tu()),q.init(e,t)}),Mu=b("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=Kd),q.init(e,t)}),Fu=b("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=Wd),q.init(e,t)}),Du=b("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=Vd),q.init(e,t)}),Lu=b("$ZodULID",(e,t)=>{t.pattern??(t.pattern=Qd),q.init(e,t)}),Zu=b("$ZodXID",(e,t)=>{t.pattern??(t.pattern=Gd),q.init(e,t)}),Uu=b("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=Hd),q.init(e,t)}),Bu=b("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=uu(t)),q.init(e,t)}),qu=b("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=cu),q.init(e,t)}),Wu=b("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=du(t)),q.init(e,t)}),Vu=b("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=Jd),q.init(e,t)}),Qu=b("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=su),q.init(e,t),e._zod.onattach.push(s=>{const n=s._zod.bag;n.format="ipv4"})}),Gu=b("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=ru),q.init(e,t),e._zod.onattach.push(s=>{const n=s._zod.bag;n.format="ipv6"}),e._zod.check=s=>{try{new URL(`http://[${s.value}]`)}catch{s.issues.push({code:"invalid_format",format:"ipv6",input:s.value,inst:e,continue:!t.abort})}}}),Hu=b("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=nu),q.init(e,t)}),Ku=b("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=au),q.init(e,t),e._zod.check=s=>{const n=s.value.split("/");try{if(n.length!==2)throw new Error;const[a,o]=n;if(!o)throw new Error;const i=Number(o);if(`${i}`!==o)throw new Error;if(i<0||i>128)throw new Error;new URL(`http://[${a}]`)}catch{s.issues.push({code:"invalid_format",format:"cidrv6",input:s.value,inst:e,continue:!t.abort})}}});function yo(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const Ju=b("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=ou),q.init(e,t),e._zod.onattach.push(s=>{s._zod.bag.contentEncoding="base64"}),e._zod.check=s=>{yo(s.value)||s.issues.push({code:"invalid_format",format:"base64",input:s.value,inst:e,continue:!t.abort})}});function Yu(e){if(!po.test(e))return!1;const t=e.replace(/[-_]/g,n=>n==="-"?"+":"/"),s=t.padEnd(Math.ceil(t.length/4)*4,"=");return yo(s)}const Xu=b("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=po),q.init(e,t),e._zod.onattach.push(s=>{s._zod.bag.contentEncoding="base64url"}),e._zod.check=s=>{Yu(s.value)||s.issues.push({code:"invalid_format",format:"base64url",input:s.value,inst:e,continue:!t.abort})}}),eh=b("$ZodE164",(e,t)=>{t.pattern??(t.pattern=lu),q.init(e,t)});function th(e,t=null){try{const s=e.split(".");if(s.length!==3)return!1;const[n]=s;if(!n)return!1;const a=JSON.parse(atob(n));return!("typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||t&&(!("alg"in a)||a.alg!==t))}catch{return!1}}const sh=b("$ZodJWT",(e,t)=>{q.init(e,t),e._zod.check=s=>{th(s.value,t.alg)||s.issues.push({code:"invalid_format",format:"jwt",input:s.value,inst:e,continue:!t.abort})}}),wo=b("$ZodNumber",(e,t)=>{G.init(e,t),e._zod.pattern=e._zod.bag.pattern??pu,e._zod.parse=(s,n)=>{if(t.coerce)try{s.value=Number(s.value)}catch{}const a=s.value;if(typeof a=="number"&&!Number.isNaN(a)&&Number.isFinite(a))return s;const o=typeof a=="number"?Number.isNaN(a)?"NaN":Number.isFinite(a)?void 0:"Infinity":void 0;return s.issues.push({expected:"number",code:"invalid_type",input:a,inst:e,...o?{received:o}:{}}),s}}),rh=b("$ZodNumber",(e,t)=>{vu.init(e,t),wo.init(e,t)}),nh=b("$ZodNull",(e,t)=>{G.init(e,t),e._zod.pattern=fu,e._zod.values=new Set([null]),e._zod.parse=(s,n)=>{const a=s.value;return a===null||s.issues.push({expected:"null",code:"invalid_type",input:a,inst:e}),s}}),ah=b("$ZodUnknown",(e,t)=>{G.init(e,t),e._zod.parse=s=>s}),oh=b("$ZodNever",(e,t)=>{G.init(e,t),e._zod.parse=(s,n)=>(s.issues.push({expected:"never",code:"invalid_type",input:s.value,inst:e}),s)});function vn(e,t,s){e.issues.length&&t.issues.push(...co(s,e.issues)),t.value[s]=e.value}const ih=b("$ZodArray",(e,t)=>{G.init(e,t),e._zod.parse=(s,n)=>{const a=s.value;if(!Array.isArray(a))return s.issues.push({expected:"array",code:"invalid_type",input:a,inst:e}),s;s.value=Array(a.length);const o=[];for(let i=0;i<a.length;i++){const l=a[i],c=t.element._zod.run({value:l,issues:[]},n);c instanceof Promise?o.push(c.then(d=>vn(d,s,i))):vn(c,s,i)}return o.length?Promise.all(o).then(()=>s):s}});function ys(e,t,s,n){e.issues.length&&t.issues.push(...co(s,e.issues)),e.value===void 0?s in n&&(t.value[s]=void 0):t.value[s]=e.value}function jo(e){var n,a,o,i;const t=Object.keys(e.shape);for(const l of t)if(!((i=(o=(a=(n=e.shape)==null?void 0:n[l])==null?void 0:a._zod)==null?void 0:o.traits)!=null&&i.has("$ZodType")))throw new Error(`Invalid element at key "${l}": expected a Zod schema`);const s=kd(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(s)}}function _o(e,t,s,n,a,o){const i=[],l=a.keySet,c=a.catchall._zod,d=c.def.type;for(const u of Object.keys(t)){if(l.has(u))continue;if(d==="never"){i.push(u);continue}const m=c.run({value:t[u],issues:[]},n);m instanceof Promise?e.push(m.then(p=>ys(p,s,u,t))):ys(m,s,u,t)}return i.length&&s.issues.push({code:"unrecognized_keys",keys:i,input:t,inst:o}),e.length?Promise.all(e).then(()=>s):s}const lh=b("$ZodObject",(e,t)=>{G.init(e,t);const s=Object.getOwnPropertyDescriptor(t,"shape");if(!(s!=null&&s.get)){const l=t.shape;Object.defineProperty(t,"shape",{get:()=>{const c={...l};return Object.defineProperty(t,"shape",{value:c}),c}})}const n=_r(()=>jo(t));B(e._zod,"propValues",()=>{const l=t.shape,c={};for(const d in l){const u=l[d]._zod;if(u.values){c[d]??(c[d]=new Set);for(const m of u.values)c[d].add(m)}}return c});const a=vs,o=t.catchall;let i;e._zod.parse=(l,c)=>{i??(i=n.value);const d=l.value;if(!a(d))return l.issues.push({expected:"object",code:"invalid_type",input:d,inst:e}),l;l.value={};const u=[],m=i.shape;for(const p of i.keys){const v=m[p]._zod.run({value:d[p],issues:[]},c);v instanceof Promise?u.push(v.then(_=>ys(_,l,p,d))):ys(v,l,p,d)}return o?_o(u,d,l,c,n.value,e):u.length?Promise.all(u).then(()=>l):l}}),ch=b("$ZodObjectJIT",(e,t)=>{lh.init(e,t);const s=e._zod.parse,n=_r(()=>jo(t)),a=p=>{const f=new Iu(["shape","payload","ctx"]),v=n.value,_=z=>{const w=xn(z);return`shape[${w}]._zod.run({ value: input[${w}], issues: [] }, ctx)`};f.write("const input = payload.value;");const y=Object.create(null);let k=0;for(const z of v.keys)y[z]=`key_${k++}`;f.write("const newResult = {};");for(const z of v.keys){const w=y[z],N=xn(z);f.write(`const ${w} = ${_(z)};`),f.write(`
        if (${w}.issues.length) {
          payload.issues = payload.issues.concat(${w}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${N}, ...iss.path] : [${N}]
          })));
        }
        
        
        if (${w}.value === undefined) {
          if (${N} in input) {
            newResult[${N}] = undefined;
          }
        } else {
          newResult[${N}] = ${w}.value;
        }
        
      `)}f.write("payload.value = newResult;"),f.write("return payload;");const O=f.compile();return(z,w)=>O(p,z,w)};let o;const i=vs,l=!oo.jitless,d=l&&jd.value,u=t.catchall;let m;e._zod.parse=(p,f)=>{m??(m=n.value);const v=p.value;return i(v)?l&&d&&(f==null?void 0:f.async)===!1&&f.jitless!==!0?(o||(o=a(t.shape)),p=o(p,f),u?_o([],v,p,f,m,e):p):s(p,f):(p.issues.push({expected:"object",code:"invalid_type",input:v,inst:e}),p)}});function yn(e,t,s,n){for(const o of e)if(o.issues.length===0)return t.value=o.value,t;const a=e.filter(o=>!bt(o));return a.length===1?(t.value=a[0].value,a[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:s,errors:e.map(o=>o.issues.map(i=>ht(i,n,ut())))}),t)}const dh=b("$ZodUnion",(e,t)=>{G.init(e,t),B(e._zod,"optin",()=>t.options.some(a=>a._zod.optin==="optional")?"optional":void 0),B(e._zod,"optout",()=>t.options.some(a=>a._zod.optout==="optional")?"optional":void 0),B(e._zod,"values",()=>{if(t.options.every(a=>a._zod.values))return new Set(t.options.flatMap(a=>Array.from(a._zod.values)))}),B(e._zod,"pattern",()=>{if(t.options.every(a=>a._zod.pattern)){const a=t.options.map(o=>o._zod.pattern);return new RegExp(`^(${a.map(o=>Nr(o.source)).join("|")})$`)}});const s=t.options.length===1,n=t.options[0]._zod.run;e._zod.parse=(a,o)=>{if(s)return n(a,o);let i=!1;const l=[];for(const c of t.options){const d=c._zod.run({value:a.value,issues:[]},o);if(d instanceof Promise)l.push(d),i=!0;else{if(d.issues.length===0)return d;l.push(d)}}return i?Promise.all(l).then(c=>yn(c,a,e,o)):yn(l,a,e,o)}}),uh=b("$ZodIntersection",(e,t)=>{G.init(e,t),e._zod.parse=(s,n)=>{const a=s.value,o=t.left._zod.run({value:a,issues:[]},n),i=t.right._zod.run({value:a,issues:[]},n);return o instanceof Promise||i instanceof Promise?Promise.all([o,i]).then(([c,d])=>wn(s,c,d)):wn(s,o,i)}});function or(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(Zt(e)&&Zt(t)){const s=Object.keys(t),n=Object.keys(e).filter(o=>s.indexOf(o)!==-1),a={...e,...t};for(const o of n){const i=or(e[o],t[o]);if(!i.valid)return{valid:!1,mergeErrorPath:[o,...i.mergeErrorPath]};a[o]=i.data}return{valid:!0,data:a}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const s=[];for(let n=0;n<e.length;n++){const a=e[n],o=t[n],i=or(a,o);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};s.push(i.data)}return{valid:!0,data:s}}return{valid:!1,mergeErrorPath:[]}}function wn(e,t,s){if(t.issues.length&&e.issues.push(...t.issues),s.issues.length&&e.issues.push(...s.issues),bt(e))return e;const n=or(t.value,s.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return e.value=n.data,e}const hh=b("$ZodEnum",(e,t)=>{G.init(e,t);const s=yd(t.entries),n=new Set(s);e._zod.values=n,e._zod.pattern=new RegExp(`^(${s.filter(a=>_d.has(typeof a)).map(a=>typeof a=="string"?Ns(a):a.toString()).join("|")})$`),e._zod.parse=(a,o)=>{const i=a.value;return n.has(i)||a.issues.push({code:"invalid_value",values:s,input:i,inst:e}),a}}),mh=b("$ZodTransform",(e,t)=>{G.init(e,t),e._zod.parse=(s,n)=>{if(n.direction==="backward")throw new ao(e.constructor.name);const a=t.transform(s.value,s);if(n.async)return(a instanceof Promise?a:Promise.resolve(a)).then(i=>(s.value=i,s));if(a instanceof Promise)throw new vt;return s.value=a,s}});function jn(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const ph=b("$ZodOptional",(e,t)=>{G.init(e,t),e._zod.optin="optional",e._zod.optout="optional",B(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),B(e._zod,"pattern",()=>{const s=t.innerType._zod.pattern;return s?new RegExp(`^(${Nr(s.source)})?$`):void 0}),e._zod.parse=(s,n)=>{if(t.innerType._zod.optin==="optional"){const a=t.innerType._zod.run(s,n);return a instanceof Promise?a.then(o=>jn(o,s.value)):jn(a,s.value)}return s.value===void 0?s:t.innerType._zod.run(s,n)}}),fh=b("$ZodNullable",(e,t)=>{G.init(e,t),B(e._zod,"optin",()=>t.innerType._zod.optin),B(e._zod,"optout",()=>t.innerType._zod.optout),B(e._zod,"pattern",()=>{const s=t.innerType._zod.pattern;return s?new RegExp(`^(${Nr(s.source)}|null)$`):void 0}),B(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(s,n)=>s.value===null?s:t.innerType._zod.run(s,n)}),gh=b("$ZodDefault",(e,t)=>{G.init(e,t),e._zod.optin="optional",B(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(s,n)=>{if(n.direction==="backward")return t.innerType._zod.run(s,n);if(s.value===void 0)return s.value=t.defaultValue,s;const a=t.innerType._zod.run(s,n);return a instanceof Promise?a.then(o=>_n(o,t)):_n(a,t)}});function _n(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const xh=b("$ZodPrefault",(e,t)=>{G.init(e,t),e._zod.optin="optional",B(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(s,n)=>(n.direction==="backward"||s.value===void 0&&(s.value=t.defaultValue),t.innerType._zod.run(s,n))}),bh=b("$ZodNonOptional",(e,t)=>{G.init(e,t),B(e._zod,"values",()=>{const s=t.innerType._zod.values;return s?new Set([...s].filter(n=>n!==void 0)):void 0}),e._zod.parse=(s,n)=>{const a=t.innerType._zod.run(s,n);return a instanceof Promise?a.then(o=>kn(o,e)):kn(a,e)}});function kn(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const vh=b("$ZodCatch",(e,t)=>{G.init(e,t),B(e._zod,"optin",()=>t.innerType._zod.optin),B(e._zod,"optout",()=>t.innerType._zod.optout),B(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(s,n)=>{if(n.direction==="backward")return t.innerType._zod.run(s,n);const a=t.innerType._zod.run(s,n);return a instanceof Promise?a.then(o=>(s.value=o.value,o.issues.length&&(s.value=t.catchValue({...s,error:{issues:o.issues.map(i=>ht(i,n,ut()))},input:s.value}),s.issues=[]),s)):(s.value=a.value,a.issues.length&&(s.value=t.catchValue({...s,error:{issues:a.issues.map(o=>ht(o,n,ut()))},input:s.value}),s.issues=[]),s)}}),yh=b("$ZodPipe",(e,t)=>{G.init(e,t),B(e._zod,"values",()=>t.in._zod.values),B(e._zod,"optin",()=>t.in._zod.optin),B(e._zod,"optout",()=>t.out._zod.optout),B(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(s,n)=>{if(n.direction==="backward"){const o=t.out._zod.run(s,n);return o instanceof Promise?o.then(i=>cs(i,t.in,n)):cs(o,t.in,n)}const a=t.in._zod.run(s,n);return a instanceof Promise?a.then(o=>cs(o,t.out,n)):cs(a,t.out,n)}});function cs(e,t,s){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},s)}const wh=b("$ZodReadonly",(e,t)=>{G.init(e,t),B(e._zod,"propValues",()=>t.innerType._zod.propValues),B(e._zod,"values",()=>t.innerType._zod.values),B(e._zod,"optin",()=>t.innerType._zod.optin),B(e._zod,"optout",()=>t.innerType._zod.optout),e._zod.parse=(s,n)=>{if(n.direction==="backward")return t.innerType._zod.run(s,n);const a=t.innerType._zod.run(s,n);return a instanceof Promise?a.then(Nn):Nn(a)}});function Nn(e){return e.value=Object.freeze(e.value),e}const jh=b("$ZodCustom",(e,t)=>{me.init(e,t),G.init(e,t),e._zod.parse=(s,n)=>s,e._zod.check=s=>{const n=s.value,a=t.fn(n);if(a instanceof Promise)return a.then(o=>Sn(o,s,n,e));Sn(a,s,n,e)}});function Sn(e,t,s,n){if(!e){const a={code:"custom",input:s,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(a.params=n._zod.def.params),t.issues.push(Ut(a))}}class _h{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...s){const n=s[0];if(this._map.set(t,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,t)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(t){const s=this._map.get(t);return s&&typeof s=="object"&&"id"in s&&this._idmap.delete(s.id),this._map.delete(t),this}get(t){const s=t._zod.parent;if(s){const n={...this.get(s)??{}};delete n.id;const a={...n,...this._map.get(t)};return Object.keys(a).length?a:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function kh(){return new _h}const ds=kh();function Nh(e,t){return new e({type:"string",...R(t)})}function Sh(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...R(t)})}function Cn(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...R(t)})}function Ch(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...R(t)})}function zh(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...R(t)})}function Eh(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...R(t)})}function Ih(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...R(t)})}function Th(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...R(t)})}function Ah(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...R(t)})}function Rh(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...R(t)})}function $h(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...R(t)})}function Ph(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...R(t)})}function Oh(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...R(t)})}function Mh(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...R(t)})}function Fh(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...R(t)})}function Dh(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...R(t)})}function Lh(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...R(t)})}function Zh(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...R(t)})}function Uh(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...R(t)})}function Bh(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...R(t)})}function qh(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...R(t)})}function Wh(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...R(t)})}function Vh(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...R(t)})}function Qh(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...R(t)})}function Gh(e,t){return new e({type:"string",format:"date",check:"string_format",...R(t)})}function Hh(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...R(t)})}function Kh(e,t){return new e({type:"string",format:"duration",check:"string_format",...R(t)})}function Jh(e,t){return new e({type:"number",checks:[],...R(t)})}function Yh(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...R(t)})}function Xh(e,t){return new e({type:"null",...R(t)})}function em(e){return new e({type:"unknown"})}function tm(e,t){return new e({type:"never",...R(t)})}function zn(e,t){return new bo({check:"less_than",...R(t),value:e,inclusive:!1})}function Os(e,t){return new bo({check:"less_than",...R(t),value:e,inclusive:!0})}function En(e,t){return new vo({check:"greater_than",...R(t),value:e,inclusive:!1})}function Ms(e,t){return new vo({check:"greater_than",...R(t),value:e,inclusive:!0})}function In(e,t){return new bu({check:"multiple_of",...R(t),value:e})}function ko(e,t){return new yu({check:"max_length",...R(t),maximum:e})}function ws(e,t){return new wu({check:"min_length",...R(t),minimum:e})}function No(e,t){return new ju({check:"length_equals",...R(t),length:e})}function sm(e,t){return new _u({check:"string_format",format:"regex",...R(t),pattern:e})}function rm(e){return new ku({check:"string_format",format:"lowercase",...R(e)})}function nm(e){return new Nu({check:"string_format",format:"uppercase",...R(e)})}function am(e,t){return new Su({check:"string_format",format:"includes",...R(t),includes:e})}function om(e,t){return new Cu({check:"string_format",format:"starts_with",...R(t),prefix:e})}function im(e,t){return new zu({check:"string_format",format:"ends_with",...R(t),suffix:e})}function Jt(e){return new Eu({check:"overwrite",tx:e})}function lm(e){return Jt(t=>t.normalize(e))}function cm(){return Jt(e=>e.trim())}function dm(){return Jt(e=>e.toLowerCase())}function um(){return Jt(e=>e.toUpperCase())}function hm(e,t,s){return new e({type:"array",element:t,...R(s)})}function mm(e,t,s){return new e({type:"custom",check:"custom",fn:t,...R(s)})}function pm(e){const t=fm(s=>(s.addIssue=n=>{if(typeof n=="string")s.issues.push(Ut(n,s.value,t._zod.def));else{const a=n;a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=s.value),a.inst??(a.inst=t),a.continue??(a.continue=!t._zod.def.abort),s.issues.push(Ut(a))}},e(s.value,s)));return t}function fm(e,t){const s=new me({check:"custom",...R(t)});return s._zod.check=e,s}const gm=b("ZodISODateTime",(e,t)=>{Bu.init(e,t),W.init(e,t)});function xm(e){return Qh(gm,e)}const bm=b("ZodISODate",(e,t)=>{qu.init(e,t),W.init(e,t)});function vm(e){return Gh(bm,e)}const ym=b("ZodISOTime",(e,t)=>{Wu.init(e,t),W.init(e,t)});function wm(e){return Hh(ym,e)}const jm=b("ZodISODuration",(e,t)=>{Vu.init(e,t),W.init(e,t)});function _m(e){return Kh(jm,e)}const km=(e,t)=>{ho.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:s=>$d(e,s)},flatten:{value:s=>Rd(e,s)},addIssue:{value:s=>{e.issues.push(s),e.message=JSON.stringify(e.issues,ar,2)}},addIssues:{value:s=>{e.issues.push(...s),e.message=JSON.stringify(e.issues,ar,2)}},isEmpty:{get(){return e.issues.length===0}}})},ve=b("ZodError",km,{Parent:Error}),Nm=Cr(ve),Sm=zr(ve),Cm=Ss(ve),zm=Cs(ve),Em=Md(ve),Im=Fd(ve),Tm=Dd(ve),Am=Ld(ve),Rm=Zd(ve),$m=Ud(ve),Pm=Bd(ve),Om=qd(ve),K=b("ZodType",(e,t)=>(G.init(e,t),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...s)=>e.clone(pt(t,{checks:[...t.checks??[],...s.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]})),e.clone=(s,n)=>He(e,s,n),e.brand=()=>e,e.register=(s,n)=>(s.add(e,n),e),e.parse=(s,n)=>Nm(e,s,n,{callee:e.parse}),e.safeParse=(s,n)=>Cm(e,s,n),e.parseAsync=async(s,n)=>Sm(e,s,n,{callee:e.parseAsync}),e.safeParseAsync=async(s,n)=>zm(e,s,n),e.spa=e.safeParseAsync,e.encode=(s,n)=>Em(e,s,n),e.decode=(s,n)=>Im(e,s,n),e.encodeAsync=async(s,n)=>Tm(e,s,n),e.decodeAsync=async(s,n)=>Am(e,s,n),e.safeEncode=(s,n)=>Rm(e,s,n),e.safeDecode=(s,n)=>$m(e,s,n),e.safeEncodeAsync=async(s,n)=>Pm(e,s,n),e.safeDecodeAsync=async(s,n)=>Om(e,s,n),e.refine=(s,n)=>e.check(Sp(s,n)),e.superRefine=s=>e.check(Cp(s)),e.overwrite=s=>e.check(Jt(s)),e.optional=()=>$n(e),e.nullable=()=>Pn(e),e.nullish=()=>$n(Pn(e)),e.nonoptional=s=>vp(e,s),e.array=()=>Ft(e),e.or=s=>zo([e,s]),e.and=s=>up(e,s),e.transform=s=>On(e,mp(s)),e.default=s=>gp(e,s),e.prefault=s=>bp(e,s),e.catch=s=>wp(e,s),e.pipe=s=>On(e,s),e.readonly=()=>kp(e),e.describe=s=>{const n=e.clone();return ds.add(n,{description:s}),n},Object.defineProperty(e,"description",{get(){var s;return(s=ds.get(e))==null?void 0:s.description},configurable:!0}),e.meta=(...s)=>{if(s.length===0)return ds.get(e);const n=e.clone();return ds.add(n,s[0]),n},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),So=b("_ZodString",(e,t)=>{Er.init(e,t),K.init(e,t);const s=e._zod.bag;e.format=s.format??null,e.minLength=s.minimum??null,e.maxLength=s.maximum??null,e.regex=(...n)=>e.check(sm(...n)),e.includes=(...n)=>e.check(am(...n)),e.startsWith=(...n)=>e.check(om(...n)),e.endsWith=(...n)=>e.check(im(...n)),e.min=(...n)=>e.check(ws(...n)),e.max=(...n)=>e.check(ko(...n)),e.length=(...n)=>e.check(No(...n)),e.nonempty=(...n)=>e.check(ws(1,...n)),e.lowercase=n=>e.check(rm(n)),e.uppercase=n=>e.check(nm(n)),e.trim=()=>e.check(cm()),e.normalize=(...n)=>e.check(lm(...n)),e.toLowerCase=()=>e.check(dm()),e.toUpperCase=()=>e.check(um())}),Mm=b("ZodString",(e,t)=>{Er.init(e,t),So.init(e,t),e.email=s=>e.check(Sh(Fm,s)),e.url=s=>e.check(Th(Dm,s)),e.jwt=s=>e.check(Vh(ep,s)),e.emoji=s=>e.check(Ah(Lm,s)),e.guid=s=>e.check(Cn(Tn,s)),e.uuid=s=>e.check(Ch(us,s)),e.uuidv4=s=>e.check(zh(us,s)),e.uuidv6=s=>e.check(Eh(us,s)),e.uuidv7=s=>e.check(Ih(us,s)),e.nanoid=s=>e.check(Rh(Zm,s)),e.guid=s=>e.check(Cn(Tn,s)),e.cuid=s=>e.check($h(Um,s)),e.cuid2=s=>e.check(Ph(Bm,s)),e.ulid=s=>e.check(Oh(qm,s)),e.base64=s=>e.check(Bh(Jm,s)),e.base64url=s=>e.check(qh(Ym,s)),e.xid=s=>e.check(Mh(Wm,s)),e.ksuid=s=>e.check(Fh(Vm,s)),e.ipv4=s=>e.check(Dh(Qm,s)),e.ipv6=s=>e.check(Lh(Gm,s)),e.cidrv4=s=>e.check(Zh(Hm,s)),e.cidrv6=s=>e.check(Uh(Km,s)),e.e164=s=>e.check(Wh(Xm,s)),e.datetime=s=>e.check(xm(s)),e.date=s=>e.check(vm(s)),e.time=s=>e.check(wm(s)),e.duration=s=>e.check(_m(s))});function ne(e){return Nh(Mm,e)}const W=b("ZodStringFormat",(e,t)=>{q.init(e,t),So.init(e,t)}),Fm=b("ZodEmail",(e,t)=>{$u.init(e,t),W.init(e,t)}),Tn=b("ZodGUID",(e,t)=>{Au.init(e,t),W.init(e,t)}),us=b("ZodUUID",(e,t)=>{Ru.init(e,t),W.init(e,t)}),Dm=b("ZodURL",(e,t)=>{Pu.init(e,t),W.init(e,t)}),Lm=b("ZodEmoji",(e,t)=>{Ou.init(e,t),W.init(e,t)}),Zm=b("ZodNanoID",(e,t)=>{Mu.init(e,t),W.init(e,t)}),Um=b("ZodCUID",(e,t)=>{Fu.init(e,t),W.init(e,t)}),Bm=b("ZodCUID2",(e,t)=>{Du.init(e,t),W.init(e,t)}),qm=b("ZodULID",(e,t)=>{Lu.init(e,t),W.init(e,t)}),Wm=b("ZodXID",(e,t)=>{Zu.init(e,t),W.init(e,t)}),Vm=b("ZodKSUID",(e,t)=>{Uu.init(e,t),W.init(e,t)}),Qm=b("ZodIPv4",(e,t)=>{Qu.init(e,t),W.init(e,t)}),Gm=b("ZodIPv6",(e,t)=>{Gu.init(e,t),W.init(e,t)}),Hm=b("ZodCIDRv4",(e,t)=>{Hu.init(e,t),W.init(e,t)}),Km=b("ZodCIDRv6",(e,t)=>{Ku.init(e,t),W.init(e,t)}),Jm=b("ZodBase64",(e,t)=>{Ju.init(e,t),W.init(e,t)}),Ym=b("ZodBase64URL",(e,t)=>{Xu.init(e,t),W.init(e,t)}),Xm=b("ZodE164",(e,t)=>{eh.init(e,t),W.init(e,t)}),ep=b("ZodJWT",(e,t)=>{sh.init(e,t),W.init(e,t)}),Co=b("ZodNumber",(e,t)=>{wo.init(e,t),K.init(e,t),e.gt=(n,a)=>e.check(En(n,a)),e.gte=(n,a)=>e.check(Ms(n,a)),e.min=(n,a)=>e.check(Ms(n,a)),e.lt=(n,a)=>e.check(zn(n,a)),e.lte=(n,a)=>e.check(Os(n,a)),e.max=(n,a)=>e.check(Os(n,a)),e.int=n=>e.check(An(n)),e.safe=n=>e.check(An(n)),e.positive=n=>e.check(En(0,n)),e.nonnegative=n=>e.check(Ms(0,n)),e.negative=n=>e.check(zn(0,n)),e.nonpositive=n=>e.check(Os(0,n)),e.multipleOf=(n,a)=>e.check(In(n,a)),e.step=(n,a)=>e.check(In(n,a)),e.finite=()=>e;const s=e._zod.bag;e.minValue=Math.max(s.minimum??Number.NEGATIVE_INFINITY,s.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(s.maximum??Number.POSITIVE_INFINITY,s.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(s.format??"").includes("int")||Number.isSafeInteger(s.multipleOf??.5),e.isFinite=!0,e.format=s.format??null});function re(e){return Jh(Co,e)}const tp=b("ZodNumberFormat",(e,t)=>{rh.init(e,t),Co.init(e,t)});function An(e){return Yh(tp,e)}const sp=b("ZodNull",(e,t)=>{nh.init(e,t),K.init(e,t)});function rp(e){return Xh(sp,e)}const np=b("ZodUnknown",(e,t)=>{ah.init(e,t),K.init(e,t)});function Rn(){return em(np)}const ap=b("ZodNever",(e,t)=>{oh.init(e,t),K.init(e,t)});function op(e){return tm(ap,e)}const ip=b("ZodArray",(e,t)=>{ih.init(e,t),K.init(e,t),e.element=t.element,e.min=(s,n)=>e.check(ws(s,n)),e.nonempty=s=>e.check(ws(1,s)),e.max=(s,n)=>e.check(ko(s,n)),e.length=(s,n)=>e.check(No(s,n)),e.unwrap=()=>e.element});function Ft(e,t){return hm(ip,e,t)}const lp=b("ZodObject",(e,t)=>{ch.init(e,t),K.init(e,t),B(e,"shape",()=>t.shape),e.keyof=()=>Ir(Object.keys(e._zod.def.shape)),e.catchall=s=>e.clone({...e._zod.def,catchall:s}),e.passthrough=()=>e.clone({...e._zod.def,catchall:Rn()}),e.loose=()=>e.clone({...e._zod.def,catchall:Rn()}),e.strict=()=>e.clone({...e._zod.def,catchall:op()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=s=>zd(e,s),e.safeExtend=s=>Ed(e,s),e.merge=s=>Id(e,s),e.pick=s=>Sd(e,s),e.omit=s=>Cd(e,s),e.partial=(...s)=>Td(Eo,e,s[0]),e.required=(...s)=>Ad(Io,e,s[0])});function At(e,t){const s={type:"object",shape:e??{},...R(t)};return new lp(s)}const cp=b("ZodUnion",(e,t)=>{dh.init(e,t),K.init(e,t),e.options=t.options});function zo(e,t){return new cp({type:"union",options:e,...R(t)})}const dp=b("ZodIntersection",(e,t)=>{uh.init(e,t),K.init(e,t)});function up(e,t){return new dp({type:"intersection",left:e,right:t})}const ir=b("ZodEnum",(e,t)=>{hh.init(e,t),K.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const s=new Set(Object.keys(t.entries));e.extract=(n,a)=>{const o={};for(const i of n)if(s.has(i))o[i]=t.entries[i];else throw new Error(`Key ${i} not found in enum`);return new ir({...t,checks:[],...R(a),entries:o})},e.exclude=(n,a)=>{const o={...t.entries};for(const i of n)if(s.has(i))delete o[i];else throw new Error(`Key ${i} not found in enum`);return new ir({...t,checks:[],...R(a),entries:o})}});function Ir(e,t){const s=Array.isArray(e)?Object.fromEntries(e.map(n=>[n,n])):e;return new ir({type:"enum",entries:s,...R(t)})}const hp=b("ZodTransform",(e,t)=>{mh.init(e,t),K.init(e,t),e._zod.parse=(s,n)=>{if(n.direction==="backward")throw new ao(e.constructor.name);s.addIssue=o=>{if(typeof o=="string")s.issues.push(Ut(o,s.value,t));else{const i=o;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=s.value),i.inst??(i.inst=e),s.issues.push(Ut(i))}};const a=t.transform(s.value,s);return a instanceof Promise?a.then(o=>(s.value=o,s)):(s.value=a,s)}});function mp(e){return new hp({type:"transform",transform:e})}const Eo=b("ZodOptional",(e,t)=>{ph.init(e,t),K.init(e,t),e.unwrap=()=>e._zod.def.innerType});function $n(e){return new Eo({type:"optional",innerType:e})}const pp=b("ZodNullable",(e,t)=>{fh.init(e,t),K.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Pn(e){return new pp({type:"nullable",innerType:e})}const fp=b("ZodDefault",(e,t)=>{gh.init(e,t),K.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function gp(e,t){return new fp({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():lo(t)}})}const xp=b("ZodPrefault",(e,t)=>{xh.init(e,t),K.init(e,t),e.unwrap=()=>e._zod.def.innerType});function bp(e,t){return new xp({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():lo(t)}})}const Io=b("ZodNonOptional",(e,t)=>{bh.init(e,t),K.init(e,t),e.unwrap=()=>e._zod.def.innerType});function vp(e,t){return new Io({type:"nonoptional",innerType:e,...R(t)})}const yp=b("ZodCatch",(e,t)=>{vh.init(e,t),K.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function wp(e,t){return new yp({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const jp=b("ZodPipe",(e,t)=>{yh.init(e,t),K.init(e,t),e.in=t.in,e.out=t.out});function On(e,t){return new jp({type:"pipe",in:e,out:t})}const _p=b("ZodReadonly",(e,t)=>{wh.init(e,t),K.init(e,t),e.unwrap=()=>e._zod.def.innerType});function kp(e){return new _p({type:"readonly",innerType:e})}const Np=b("ZodCustom",(e,t)=>{jh.init(e,t),K.init(e,t)});function Sp(e,t={}){return mm(Np,e,t)}function Cp(e){return pm(e)}const zp=Ir(["S","A","B","C","F"]),Ep=Ir(["new","purchased"]),Ip=At({id:ne(),name:ne(),grade:zp,intent:re(),prop:ne(),visit:re(),price:re(),status:Ep,purchased_at:zo([ne(),re(),rp()]).optional(),purchased_by:ne().nullable().optional(),transaction_hash:ne().nullable().optional(),ai:ne(),remaining_hours:re().nullable().optional(),x:re().optional(),y:re().optional(),created_at:ne().optional()}).passthrough(),To=Ip.extend({remainingHours:re().optional()}),Ao=At({title:ne(),tags:Ft(ne()).optional().nullable(),view_count:re().optional(),click_count:re().optional(),fav_count:re().optional(),thumb_color:ne().optional(),view:re().optional(),click:re().optional(),fav:re().optional(),thumbColor:ne().optional()}).passthrough(),Ro=At({title:ne(),meta:ne(),body:ne(),created_at:ne().optional()}).passthrough(),$o=At({points:re(),quota:At({s:re(),a:re()})});At({user:$o,leads:Ft(To),listings:Ft(Ao),feed:Ft(Ro)});const Mn={TABLET:1024},Tr={S:120,A:72,B:336,C:336,F:336},Tp=(e,t)=>{if(!e)return 0;const s=Tr[t]||336,n=new Date(e).getTime(),a=(Date.now()-n)/(1e3*60*60);return Math.max(0,Math.min(s,s-a))},Ap=(e,t,s,n)=>{const a={points:e.points,quota:{s:e.quota_s,a:e.quota_a}},o=$o.safeParse(a);if(!o.success)throw console.error("Critical: User Data Validation Failed",o.error),new Error("Failed to load user profile");const i=t.map(d=>{let u=d.remaining_hours!=null?Number(d.remaining_hours):null;return u==null&&d.purchased_at&&d.status==="purchased"&&(u=Tp(d.purchased_at,d.grade)),{...d,grade:d.grade,status:d.status,...u!=null?{remainingHours:u}:{}}}).filter(d=>{const u=To.safeParse(d);return u.success?!0:(console.warn(`Skipping invalid lead (${d.id}):`,u.error.flatten()),!1)}),l=s.map(d=>({...d,title:d.title,tags:d.tags??[],view:d.view_count??0,click:d.click_count??0,fav:d.fav_count??0,thumbColor:d.thumb_color??"#e5e7eb"})).filter(d=>{const u=Ao.safeParse(d);return u.success?!0:(console.warn("Skipping invalid listing:",u.error.flatten()),!1)}),c=n.filter(d=>{const u=Ro.safeParse(d);return u.success?!0:(console.warn("Skipping invalid feed post:",u.error.flatten()),!1)});return{user:o.data,leads:i,listings:l,feed:c}};class js{static async fetchAppData(t){const[s,n,a,o]=await Promise.all([H.from("users").select("points, quota_s, quota_a").single(),H.from("leads").select("*"),H.from("listings").select("*").eq("agent_id",t),H.from("feed").select("*").order("created_at",{ascending:!1}).limit(5)]);if(s.error)throw s.error;if(n.error)throw n.error;if(a.error)throw a.error;if(o.error)throw o.error;return Ap(s.data,n.data,a.data,o.data)}static async fetchPropertyViewStats(t){try{const{data:s,error:n}=await H.rpc("get_agent_property_stats",{p_agent_id:t});return n?(console.warn("PropertyViewStats RPC error, using fallback:",n),await js.fetchPropertyViewStatsFallback(t)):s||[]}catch(s){return console.error("fetchPropertyViewStats error:",s),[]}}static async fetchPropertyViewStatsFallback(t){const{data:s,error:n}=await H.from("properties").select("public_id").eq("agent_id",t);if(n||!(s!=null&&s.length))return[];const a=s.map(d=>d.public_id),{data:o,error:i}=await H.from("uag_events").select("property_id, session_id, duration, actions").in("property_id",a);if(i||!o)return[];const l=new Map;for(const d of o){const u=d.property_id;l.has(u)||l.set(u,{property_id:u,view_count:0,unique_sessions:0,total_duration:0,line_clicks:0,call_clicks:0});const m=l.get(u);m.view_count++,m.total_duration+=d.duration||0;const p=d.actions;p!=null&&p.click_line&&m.line_clicks++,p!=null&&p.click_call&&m.call_clicks++}const c=new Map;for(const d of o)c.has(d.property_id)||c.set(d.property_id,new Set),c.get(d.property_id).add(d.session_id);for(const[d,u]of c){const m=l.get(d);m&&(m.unique_sessions=u.size)}return Array.from(l.values())}static async purchaseLead(t,s,n,a){const{error:o}=await H.rpc("purchase_lead",{p_user_id:t,p_lead_id:s,p_cost:n,p_grade:a});if(o)throw o}}const Rp={user:{points:1280,quota:{s:2,a:3}},leads:[{id:"S-5566",name:"買家 S-5566",grade:"S",intent:98,prop:"捷運宅",visit:15,price:20,status:"purchased",purchased_at:Date.now()-2*36e5,ai:"S 級熱度拉滿，請優先處理。",remainingHours:118},{id:"S-9011",name:"買家 S-9011",grade:"S",intent:93,prop:"高樓景觀宅",visit:11,price:20,status:"purchased",purchased_at:Date.now()-6*36e5,ai:"已連續三天造訪同社區。",remainingHours:114},{id:"A-7788",name:"買家 A-7788",grade:"A",intent:79,prop:"學區房",visit:6,price:10,status:"purchased",purchased_at:Date.now()-20*36e5,ai:"A 級學區需求穩定。",remainingHours:52},{id:"A-6600",name:"買家 A-6600",grade:"A",intent:74,prop:"預售捷運宅",visit:5,price:10,status:"purchased",purchased_at:Date.now()-10*36e5,ai:"適合搭配預售案一次推薦。",remainingHours:62},{id:"B218",name:"買家 B218",grade:"S",intent:92,prop:"捷運共構 3 房",visit:7,price:20,status:"new",ai:"🔥 強烈建議立即發送訊息！",x:25,y:25},{id:"A103",name:"買家 A103",grade:"S",intent:88,prop:"惠宇上晴 12F",visit:12,price:20,status:"new",ai:"建議立即發送獨家邀約！",x:15,y:45},{id:"S901",name:"買家 S901",grade:"S",intent:94,prop:"高樓景觀宅",visit:9,price:20,status:"new",ai:"重複詢問同一社區，請發送簡訊跟進。",x:40,y:32},{id:"S880",name:"買家 S880",grade:"S",intent:90,prop:"預售捷運宅",visit:8,price:20,status:"new",ai:"對捷運沿線有強烈偏好。",x:60,y:40},{id:"C055",name:"買家 C055",grade:"A",intent:75,prop:"南屯學區宅",visit:4,price:10,status:"new",ai:"A 級學區需求明確。",x:60,y:20},{id:"A230",name:"買家 A230",grade:"A",intent:71,prop:"次高樓層 3 房",visit:3,price:10,status:"new",ai:"已追蹤兩個以上相似物件。",x:70,y:30},{id:"A550",name:"買家 A550",grade:"A",intent:69,prop:"公園首排",visit:3,price:10,status:"new",ai:"假日時段瀏覽頻繁。",x:50,y:15},{id:"D330",name:"買家 D330",grade:"B",intent:62,prop:"捷運生活圈",visit:3,price:3,status:"new",ai:"建議發送訊息提供車位資訊。",x:40,y:60},{id:"B778",name:"買家 B778",grade:"B",intent:58,prop:"小坪數投資宅",visit:2,price:3,status:"new",ai:"屬於投資族群，可搭配多案推薦。",x:30,y:70},{id:"C021",name:"買家 C021",grade:"C",intent:48,prop:"老屋翻新",visit:2,price:1,status:"new",ai:"對低總價物件有興趣。",x:75,y:55},{id:"C990",name:"買家 C990",grade:"C",intent:42,prop:"套房",visit:1,price:1,status:"new",ai:"瀏覽時間短，建議先以訊息觸及。",x:82,y:65},{id:"H009",name:"買家 H009",grade:"F",intent:28,prop:"小坪數",visit:1,price:.5,status:"new",ai:"潛在客戶。",x:70,y:75},{id:"F778",name:"買家 F778",grade:"F",intent:22,prop:"套房出租",visit:1,price:.5,status:"new",ai:"互動較少，可作為備選追蹤。",x:55,y:80}],listings:[{title:"惠宇上晴｜12/15F 視野戶・雙平車",tags:["南屯區","近捷運","雙平車"],view:1284,click:214,fav:37,thumbColor:"#eef2ff"},{title:"捷運共構 3 房｜視野棟距佳",tags:["捷運共構","次高樓層"],view:986,click:163,fav:22,thumbColor:"#f0fdf4"},{title:"南屯捷運宅｜3房・高樓層",tags:["近學區","雙衛浴"],view:846,click:128,fav:15,thumbColor:"#fff7ed"}],feed:[{title:"成交故事｜12F 視野戶為什麼受歡迎",meta:"來自：社區牆・成交故事",body:"買方看重的是採光、棟距與公設使用率。"},{title:"住戶心得｜公設使用率與噪音表現",meta:"本週一・互動 41",body:"晚間 9 點後社區安靜。"}]},Fn=(e,t)=>e.grade==="S"&&t.quota.s<=0?{valid:!1,error:"S 級配額已用完"}:e.grade==="A"&&t.quota.a<=0?{valid:!1,error:"A 級配額已用完"}:{valid:!0};function $p(){var m,p;const{session:e}=ro(),[t,s]=g.useState(!0),n=vr();g.useEffect(()=>{if(typeof window>"u")return;const v=new URLSearchParams(window.location.search).get("mode");let _=!0;if(v==="mock"||v==="live")_=v==="mock",localStorage.setItem("uag_mode",v);else{const y=localStorage.getItem("uag_mode");(y==="mock"||y==="live")&&(_=y==="mock")}s(_)},[]);const a=()=>{{Je.error("生產環境無法切換模式");return}},{data:o,isLoading:i,error:l,refetch:c}=rl({queryKey:["uagData",t,(m=e==null?void 0:e.user)==null?void 0:m.id],queryFn:async()=>{var f;if(t)return Rp;if(!((f=e==null?void 0:e.user)!=null&&f.id))throw new Error("Not authenticated");return js.fetchAppData(e.user.id)},enabled:t||!!((p=e==null?void 0:e.user)!=null&&p.id),staleTime:1e3*10,refetchInterval:t?!1:3e4}),d=nl({mutationFn:async({leadId:f,cost:v,grade:_})=>{var y;if(t){await new Promise(k=>setTimeout(k,500));return}if(!((y=e==null?void 0:e.user)!=null&&y.id))throw new Error("Not authenticated");await js.purchaseLead(e.user.id,f,v,_)},onMutate:async({leadId:f,cost:v,grade:_})=>{var k,O;await n.cancelQueries({queryKey:["uagData"]});const y=n.getQueryData(["uagData",t,(k=e==null?void 0:e.user)==null?void 0:k.id]);if(y){const z=y.leads.find(N=>N.id===f);if(z){const{valid:N,error:S}=Fn(z,y.user);if(!N)throw new Error(S||"配額不足 (Optimistic Check)")}const w={...y,user:{...y.user,points:y.user.points-v,quota:{...y.user.quota,s:_==="S"?y.user.quota.s-1:y.user.quota.s,a:_==="A"?y.user.quota.a-1:y.user.quota.a}},leads:y.leads.map(N=>N.id===f?{...N,status:"purchased",remainingHours:Tr[_]||48}:N)};n.setQueryData(["uagData",t,(O=e==null?void 0:e.user)==null?void 0:O.id],w)}return{previousData:y}},onError:(f,v,_)=>{var y;_!=null&&_.previousData&&n.setQueryData(["uagData",t,(y=e==null?void 0:e.user)==null?void 0:y.id],_.previousData),Je.error(`購買失敗: ${f instanceof Error?f.message:"Unknown error"}`)},onSettled:()=>{n.invalidateQueries({queryKey:["uagData"]})}});return{data:o,isLoading:i,error:l,buyLead:async f=>{if(!o||d.isPending)return;const v=o.leads.find(O=>O.id===f);if(!v){Je.error("客戶不存在");return}if(v.status!=="new"){Je.error("此客戶已被購買");return}const{valid:_,error:y}=Fn(v,o.user);if(!_){Je.error(y||"配額不足");return}const k=v.price||10;if(o.user.points<k){Je.error("點數不足");return}d.mutate({leadId:f,cost:k,grade:v.grade},{onSuccess:()=>{Je.success("購買成功")}})},isBuying:d.isPending,useMock:t,toggleMode:a,refetch:c}}function Pp(e,t){let s;return(...n)=>{clearTimeout(s),s=setTimeout(()=>e(...n),t)}}function Op(){const[e,t]=g.useState({width:typeof window<"u"?window.innerWidth:0,height:typeof window<"u"?window.innerHeight:0});return g.useEffect(()=>{if(typeof window>"u")return;const s=Pp(()=>{t({width:window.innerWidth,height:window.innerHeight})},150);return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),e}function Mp(){const[e,t]=g.useState(null),{width:s}=Op();g.useEffect(()=>{s>Mn.TABLET&&e&&t(null)},[s,e]);const n=g.useCallback(o=>{t(o),requestAnimationFrame(()=>{var i;window.innerWidth<=Mn.TABLET&&((i=document.getElementById("action-panel-container"))==null||i.scrollIntoView({behavior:"smooth",block:"center"}))})},[]),a=g.useCallback(()=>t(null),[]);return{selectedLead:e,selectLead:n,close:a}}const Fp=()=>r.jsx("header",{className:x["uag-header"],children:r.jsxs("div",{className:x["uag-header-inner"],children:[r.jsxs("div",{className:x["uag-logo"],children:[r.jsx("div",{className:x["uag-logo-badge"],children:"邁"}),r.jsx("span",{children:"邁房子廣告後台"})]}),r.jsxs("div",{className:x["uag-breadcrumb"],children:[r.jsx("span",{children:"游杰倫 21世紀不動產河南店"}),r.jsx("span",{className:`${x["uag-badge"]} ${x["uag-badge--pro"]}`,children:"專業版 PRO"})]})]})}),Dp=({user:e,useMock:t,toggleMode:s})=>r.jsxs("div",{className:x["uag-footer-bar"],children:[r.jsxs("div",{style:{marginRight:"auto",fontSize:"12px",color:"var(--ink-300)"},children:["系統模式：",r.jsx("strong",{style:{color:t?"#f59e0b":"#16a34a"},children:t?"Local Mock":"Live API"}),r.jsx("button",{onClick:s,style:{marginLeft:"10px",fontSize:"10px",cursor:"pointer",border:"1px solid #ccc",padding:"2px 6px",borderRadius:"4px"},children:"切換模式"})]}),r.jsx("button",{className:x["uag-btn"],children:"方案設定"}),r.jsx("button",{className:`${x["uag-btn"]} ${x.primary}`,children:"加值點數"}),r.jsxs("span",{className:x["uag-badge"],style:{fontSize:"14px",background:"#fff8dc",color:"#92400e",borderColor:"#fcd34d"},children:["點數 ",r.jsx("span",{id:"user-points",children:e.points})]})]}),Lp=()=>r.jsxs("div",{className:"p-6 text-center",children:[r.jsx("div",{className:"animate-pulse flex space-x-4 justify-center",children:r.jsxs("div",{className:"flex-1 space-y-4 py-1 max-w-md",children:[r.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mx-auto"}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{className:"h-4 bg-gray-200 rounded"}),r.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6 mx-auto"})]})]})}),r.jsx("div",{className:"mt-4 text-gray-500",children:"載入中..."})]}),Zp=({error:e,resetErrorBoundary:t})=>r.jsxs("div",{role:"alert",className:"p-6 text-center text-red-600",children:[r.jsx("p",{className:"font-bold text-lg mb-2",children:"系統發生錯誤"}),r.jsx("pre",{className:"bg-red-50 p-4 rounded text-sm mb-4 overflow-auto max-w-lg mx-auto",children:e.message}),r.jsx("button",{onClick:t,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"重試"})]});function Up({leads:e,onSelectLead:t}){const s=e.filter(n=>n.status==="new");return r.jsxs("section",{className:`${x["uag-card"]} ${x["k-span-6"]}`,id:"radar-section",style:{minHeight:"450px"},children:[r.jsxs("div",{className:x["uag-card-header"],children:[r.jsxs("div",{children:[r.jsx("div",{className:x["uag-card-title"],children:"UAG 精準導客雷達"}),r.jsx("div",{className:x["uag-card-sub"],children:"S/A 級獨家聯絡權｜B/C/F 級點數兌換"})]}),r.jsx("div",{className:x["uag-actions"],style:{gap:"4px"}})]}),r.jsxs("div",{className:x["uag-cluster"],id:"radar-container",children:[r.jsx("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%)",width:"300px",height:"300px",border:"1px dashed #cbd5e1",borderRadius:"50%",pointerEvents:"none"}}),r.jsx("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%)",width:"150px",height:"150px",border:"1px dashed #cbd5e1",borderRadius:"50%",pointerEvents:"none"}}),r.jsxs("div",{style:{position:"absolute",left:"16px",top:"16px",background:"rgba(255,255,255,0.9)",padding:"6px 12px",borderRadius:"20px",fontSize:"12px",color:"#0f172a",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",border:"1px solid #e2e8f0",zIndex:5},children:[r.jsx("span",{style:{width:"8px",height:"8px",background:"#22c55e",borderRadius:"50%",display:"inline-block",marginRight:"4px"}}),r.jsx("span",{style:{fontWeight:700},children:"Live 監控中"})]}),s.map(n=>{const a=n.x!=null?n.x:50,o=n.y!=null?n.y:50,i=n.grade==="S"?120:n.grade==="A"?100:n.grade==="B"?90:n.grade==="C"?80:60,l=5+Math.random()*3+"s";return r.jsxs("div",{className:x["uag-bubble"],"data-grade":n.grade,role:"button","aria-label":`${n.name||n.id} - ${n.grade}級`,tabIndex:0,style:{"--w":i+"px","--float":l,left:a+"%",top:o+"%"},onClick:()=>t(n),onKeyDown:c=>{(c.key==="Enter"||c.key===" ")&&t(n)},children:[r.jsx("div",{className:x["uag-bubble-grade"],style:{background:`var(--grade-${n.grade.toLowerCase()})`,color:"#fff"},children:n.grade}),r.jsxs("div",{style:{textAlign:"center",lineHeight:1.2},children:[r.jsx("div",{style:{fontWeight:800,fontSize:"14px"},children:n.id}),r.jsxs("div",{style:{fontSize:"11px",color:"#64748b"},children:[n.intent,"%"]})]}),r.jsx("div",{className:x["uag-bubble-label"],children:n.prop})]},n.id)})]})]})}const hs=({label:e,value:t,highlight:s=!1})=>r.jsxs("div",{className:x["ap-stat"],children:[r.jsx("span",{children:e}),r.jsx("b",{style:s?{color:"var(--uag-brand)"}:{},children:t})]}),Bp=g.forwardRef(({selectedLead:e,onBuyLead:t,isProcessing:s},n)=>{const[a,o]=g.useState(!1);if(g.useEffect(()=>{o(!1)},[e]),!e)return r.jsx("section",{className:x["k-span-6"],id:"action-panel-container",ref:n,children:r.jsx("div",{className:x["uag-action-panel"],id:"action-panel",children:r.jsx("div",{style:{height:"100%",minHeight:"200px",display:"grid",placeItems:"center",color:"var(--ink-300)",textAlign:"center",padding:"40px 20px"},children:r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:"40px",marginBottom:"10px"},children:"👆"}),r.jsxs("div",{children:["請點擊上方雷達泡泡",r.jsx("br",{}),"查看分析與購買"]})]})})})});const i=e.grade==="S"||e.grade==="A",l=()=>{o(!0)},c=()=>{t(e.id),o(!1)},d=()=>{o(!1)};return r.jsx("section",{className:x["k-span-6"],id:"action-panel-container",ref:n,children:r.jsxs("div",{className:x["uag-action-panel"],id:"action-panel",children:[r.jsx("div",{className:x["ap-head"],children:r.jsxs("span",{className:`${x["uag-badge"]} ${x["uag-badge--"+e.grade.toLowerCase()]}`,children:[e.grade,"級｜",e.name]})}),r.jsxs("div",{className:x["ap-body"],children:[r.jsxs("div",{className:x["ap-stats-group"],children:[r.jsx(hs,{label:"關注房源",value:e.prop}),r.jsx(hs,{label:"意向分數",value:`${e.intent}%`,highlight:!0}),r.jsx(hs,{label:"瀏覽次數",value:`${e.visit} 次`}),r.jsx(hs,{label:"購買成本",value:`${e.price} 點`})]}),r.jsx("div",{className:`${x["ai-box"]} ${x.urgent}`,children:r.jsx("div",{children:e.ai})}),r.jsxs("div",{className:x["action-zone"],children:[i&&r.jsx("div",{style:{background:"#fff7ed",color:"#ea580c",fontWeight:700,fontSize:"12px",textAlign:"center",padding:"6px",borderRadius:"4px",border:"1px solid #ffedd5",marginBottom:"10px"},children:"✨ 此客戶包含獨家訊息聯絡權 ✨"}),a?r.jsxs("div",{style:{display:"flex",gap:"10px"},children:[r.jsx("button",{className:x["btn-attack"],style:{background:"#ef4444",flex:1},onClick:c,disabled:s,children:s?"處理中...":`確定花費 ${e.price} 點?`}),r.jsx("button",{className:x["btn-attack"],style:{background:"#94a3b8",flex:1},onClick:d,disabled:s,children:"取消"})]}):r.jsx("button",{className:x["btn-attack"],onClick:l,disabled:s,children:s?"處理中...":"🚀 獲取聯絡權限 (簡訊/站內信)"}),r.jsxs("div",{style:{textAlign:"center",fontSize:"11px",color:"#94a3b8",marginTop:"8px"},children:["符合個資法規範：僅能以簡訊/站內信聯繫",r.jsx("br",{}),"系統將自動發送您的名片與電話給客戶"]})]})]})]})})}),qp=e=>{const t=Tr[e.grade]??336,s=e.remainingHours??t,n=Math.max(0,Math.min(100,s/t*100)),a=e.grade==="S"||e.grade==="A";let o="";return a?o=`${s.toFixed(1)} 小時`:o=`${(s/24).toFixed(1)} 天`,{total:t,remaining:s,percent:n,isExclusive:a,timeDisplay:o}};function Wp({leads:e}){const t=e.filter(s=>s.status==="purchased");return r.jsxs("section",{className:`${x["uag-card"]} ${x["k-span-6"]}`,children:[r.jsxs("div",{className:x["uag-card-header"],children:[r.jsxs("div",{children:[r.jsx("div",{className:x["uag-card-title"],children:"已購客戶資產與保護監控"}),r.jsx("div",{className:x["uag-card-sub"],children:"S 級 120hr / A 級 72hr 獨家倒數｜B/C/F 級 14 天防撞"})]}),r.jsx("div",{className:x["uag-actions"],children:r.jsx("button",{className:x["uag-btn"],children:"匯出報表"})})]}),r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{className:x["monitor-table"],children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:"25%"},children:"客戶等級/名稱"}),r.jsx("th",{style:{width:"35%"},children:"保護期倒數"}),r.jsx("th",{style:{width:"20%"},children:"目前狀態"}),r.jsx("th",{style:{width:"20%"},children:"操作"})]})}),r.jsx("tbody",{id:"asset-list",children:t.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:4,style:{textAlign:"center",padding:"20px",color:"#94a3b8"},children:"尚無已購資產，請從上方雷達進攻。"})}):t.map(s=>{const{percent:n,isExclusive:a,timeDisplay:o}=qp(s),i=`var(--grade-${s.grade.toLowerCase()})`,l=a?"獨家鎖定中":"去重保護中";return r.jsxs("tr",{children:[r.jsx("td",{"data-label":"客戶等級/名稱",children:r.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[r.jsx("span",{style:{display:"inline-grid",placeItems:"center",width:"24px",height:"24px",borderRadius:"50%",fontSize:"11px",fontWeight:900,color:"#fff",marginRight:"8px",background:i},children:s.grade}),r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:800,color:"var(--ink-100)"},children:s.name}),r.jsx("div",{style:{fontSize:"11px",color:"var(--ink-300)"},children:s.prop})]})]})}),r.jsxs("td",{"data-label":"保護期倒數",children:[r.jsxs("div",{style:{fontSize:"11px",fontWeight:700,marginBottom:"2px",display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{style:{color:i},children:l}),r.jsx("span",{className:x["t-countdown"],children:o})]}),r.jsx("div",{className:x["progress-bg"],children:r.jsx("div",{className:x["progress-fill"],style:{width:`${n}%`,background:i}})})]}),r.jsx("td",{"data-label":"目前狀態",children:r.jsx("span",{className:x["uag-badge"],style:{background:"#f0fdf4",color:"#16a34a",border:"none"},children:"簡訊已發送"})}),r.jsx("td",{"data-label":"操作",children:r.jsx("button",{className:`${x["uag-btn"]} ${x.primary}`,style:{padding:"4px 12px",fontSize:"12px"},children:"寫紀錄 / 預約"})})]},s.id)})})]})})]})}function Vp({listings:e,feed:t}){return r.jsxs(r.Fragment,{children:[r.jsxs("section",{className:`${x["uag-card"]} ${x["k-span-3"]}`,children:[r.jsxs("div",{className:x["uag-card-header"],children:[r.jsxs("div",{children:[r.jsx("div",{className:x["uag-card-title"],children:"我的房源總覽"}),r.jsx("div",{className:x["uag-card-sub"],children:"即時掌握曝光、點擊與收藏"})]}),r.jsx("div",{className:x["uag-actions"],children:r.jsxs(ps,{to:"/property/upload",className:x["uag-btn"],style:{display:"inline-flex",alignItems:"center",gap:"4px",textDecoration:"none"},children:[r.jsx(ii,{size:14}),"上傳房源"]})})]}),r.jsx("div",{id:"listing-container",children:e.length===0?r.jsx("div",{style:{padding:"12px",fontSize:"13px",color:"#94a3b8"},children:"尚無房源資料。"}):e.map((s,n)=>{var a,o;return r.jsx("article",{className:x["listing-item"],children:n===0?r.jsxs(ps,{to:"/property/MH-100001",style:{display:"contents",textDecoration:"none",color:"inherit"},children:[r.jsx("div",{className:x["l-thumb"],style:{background:s.thumbColor}}),r.jsxs("div",{children:[r.jsx("div",{className:x["l-title"],children:s.title}),r.jsx("div",{className:x["l-tags"],children:(a=s.tags)==null?void 0:a.map((i,l)=>r.jsx("span",{className:x["l-tag"],children:i},l))}),r.jsxs("div",{className:x["l-kpi"],children:[r.jsxs("span",{children:["曝光 ",r.jsx("b",{children:s.view})]}),r.jsxs("span",{children:["點擊 ",r.jsx("b",{children:s.click})]}),r.jsxs("span",{children:["收藏 ",r.jsx("b",{children:s.fav})]})]})]})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:x["l-thumb"],style:{background:s.thumbColor}}),r.jsxs("div",{children:[r.jsx("div",{className:x["l-title"],children:s.title}),r.jsx("div",{className:x["l-tags"],children:(o=s.tags)==null?void 0:o.map((i,l)=>r.jsx("span",{className:x["l-tag"],children:i},l))}),r.jsxs("div",{className:x["l-kpi"],children:[r.jsxs("span",{children:["曝光 ",r.jsx("b",{children:s.view})]}),r.jsxs("span",{children:["點擊 ",r.jsx("b",{children:s.click})]}),r.jsxs("span",{children:["收藏 ",r.jsx("b",{children:s.fav})]})]})]})]})},n)})})]}),r.jsxs("section",{className:`${x["uag-card"]} ${x["k-span-3"]}`,children:[r.jsxs("div",{className:x["uag-card-header"],children:[r.jsxs("div",{children:[r.jsx("div",{className:x["uag-card-title"],children:"社區牆＆真實口碑"}),r.jsx("div",{className:x["uag-card-sub"],children:"用真實交流建立信任"})]}),r.jsx("div",{className:x["uag-actions"],children:r.jsx("button",{className:x["uag-btn"],children:"貼文"})})]}),r.jsx("div",{id:"feed-container",children:t.length===0?r.jsx("div",{style:{padding:"12px",fontSize:"13px",color:"#94a3b8"},children:"尚無社區牆互動。"}):t.map((s,n)=>r.jsxs("article",{className:x["feed-post"],children:[r.jsx("div",{className:x["fp-title"],children:s.title}),r.jsx("div",{className:x["fp-meta"],children:s.meta}),r.jsx("div",{className:x["fp-body"],children:s.body})]},n))})]})]})}function Qp({title:e="惠宇上晴 12F｜3房2廳2衛",subTitle:t="南屯區 · 67.3 坪 · 屋齡 5 年",price:s="NT$ 32,880,000",pricePerPing:n="參考：52.1 萬/坪",stats:a=[{label:"議價建議",value:"-2% ~ -6%"},{label:"貸款月付",value:"≈ 8.6 萬"},{label:"近三筆實登",value:"52.8 / 51.5 / 50.9"}],imageUrl:o="data:image/svg+xml;utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='320' height='200'%3E%3Crect width='100%25' height='100%25' fill='%23e5edff'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' fill='%231749d7'%3EMAIN%3C/text%3E%3C/svg%3E"}){const[i,l]=g.useState(e),[c,d]=g.useState(t),[u,m]=g.useState(s),[p,f]=g.useState(n),[v,_]=g.useState(a),[y,k]=g.useState(o),O=g.useRef(null),z=()=>{Se.success("系統提示：報告生成中...")},w=()=>{var S;(S=O.current)==null||S.click()},N=async S=>{var Z;const T=(Z=S.target.files)==null?void 0:Z[0];if(!T)return;const j=Se.loading("正在分析房仲頁面...");try{const P=new FileReader;P.onloadend=async()=>{const J=P.result;k(J),setTimeout(()=>{l("偵測結果：帝寶 18F｜豪宅規格"),d("大安區 · 120.5 坪 · 屋齡 10 年"),m("NT$ 188,000,000"),f("參考：156.0 萬/坪"),_([{label:"議價建議",value:"-5% ~ -8%"},{label:"貸款月付",value:"≈ 45.2 萬"},{label:"近三筆實登",value:"155.0 / 152.3 / 148.9"}]),Se.success("分析完成！已自動填入資訊",{id:j})},1500)},P.readAsDataURL(T)}catch{Se.error("分析失敗",{id:j})}};return r.jsxs("section",{className:`${x["uag-card"]} ${x["k-span-3"]}`,children:[r.jsxs("div",{className:x["uag-card-header"],children:[r.jsxs("div",{children:[r.jsx("div",{className:x["uag-card-title"],children:"手機報告生成器"}),r.jsx("div",{className:x["uag-card-sub"],children:"半屏小卡・行動優先"})]}),r.jsxs("div",{className:x["uag-actions"],children:[r.jsx("input",{type:"file",ref:O,style:{display:"none"},accept:"image/*",onChange:N}),r.jsx("button",{className:`${x["uag-btn"]} ${x.secondary}`,onClick:w,style:{marginRight:"8px"},children:"匯入房仲頁面"}),r.jsx("button",{className:`${x["uag-btn"]} ${x.primary}`,onClick:z,children:"生成報告"})]})]}),r.jsx("div",{className:x["card-body"],children:r.jsxs("section",{"aria-label":"手機報告生成小卡",className:x["mai-card"],children:[r.jsxs("header",{className:x["mai-head"],children:[r.jsx("span",{className:x["mai-tag"],children:"快速報告"}),r.jsx("h3",{className:x["mai-title"],children:i}),r.jsx("p",{className:x["mai-sub"],children:c})]}),r.jsxs("div",{className:x["mai-body"],children:[r.jsxs("div",{className:x["mai-left"],children:[r.jsxs("div",{className:x["mai-price"],children:[r.jsx("div",{className:x["mai-price-label"],children:"開價"}),r.jsx("div",{className:x["mai-price-value"],children:u}),r.jsx("div",{className:x["mai-price-unit"],children:p})]}),r.jsx("ul",{className:x["mai-stats"],children:v.map((S,T)=>r.jsxs("li",{children:[r.jsx("span",{children:S.label}),r.jsx("b",{children:S.value})]},T))})]}),r.jsxs("div",{className:x["mai-right"],children:[r.jsx("div",{className:x["mai-thumb"],children:r.jsx("img",{alt:"物件主圖",src:y,style:{width:"100%",height:"100%",objectFit:"cover"}})}),r.jsxs("div",{className:x["mai-mini"],children:[r.jsx("div",{style:{background:"#f0f4ff",borderRadius:"8px",aspectRatio:"3/2"}}),r.jsx("div",{style:{background:"#f0f4ff",borderRadius:"8px",aspectRatio:"3/2"}}),r.jsx("div",{style:{background:"#f0f4ff",borderRadius:"8px",aspectRatio:"3/2"}})]})]})]}),r.jsxs("div",{className:x["mai-actions"],children:[r.jsx("button",{className:`${x["mai-btn"]} ${x.primary}`,children:"一鍵生成報告"}),r.jsx("button",{className:`${x["mai-btn"]} ${x.line}`,children:"LINE 分享"})]})]})})]})}function Gp(){return r.jsxs("section",{className:`${x["uag-card"]} ${x["k-span-3"]}`,children:[r.jsxs("div",{className:x["uag-card-header"],children:[r.jsx("div",{className:x["uag-card-title"],children:"安心流程管理"}),r.jsx("div",{className:x["uag-card-sub"],children:"五階段・交易留痕"})]}),r.jsxs("div",{className:x["card-body"],children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5,1fr)",gap:"8px",marginBottom:"8px"},children:[r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{className:x["flow-stage"],style:{background:"#16a34a",color:"#fff"},children:"✓"}),r.jsx("div",{className:"small",style:{fontWeight:700,color:"#16a34a"},children:"M1 接洽"})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{className:x["flow-stage"],style:{background:"#16a34a",color:"#fff"},children:"✓"}),r.jsx("div",{className:"small",style:{fontWeight:700,color:"#16a34a"},children:"M2 帶看"})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{className:x["flow-stage"],style:{background:"#1749d7",color:"#fff"},children:"●"}),r.jsx("div",{className:"small",style:{fontWeight:700,color:"#1749d7"},children:"M3 出價"})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{className:x["flow-stage"],style:{background:"#e5e7eb",color:"#6b7280"},children:"・"}),r.jsx("div",{className:"small",style:{color:"#6b7a90"},children:"M4 簽約"})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{className:x["flow-stage"],style:{background:"#e5e7eb",color:"#6b7280"},children:"・"}),r.jsx("div",{className:"small",style:{color:"#6b7a90"},children:"M5 交屋"})]})]}),r.jsxs("div",{className:"timeline-wrap",children:[r.jsxs("div",{className:"timeline-header",style:{display:"grid",gridTemplateColumns:"90px 1fr 96px",gap:0,padding:"8px 12px",fontSize:"13px"},children:[r.jsx("div",{children:"時間"}),r.jsx("div",{children:"事件與參與者"}),r.jsx("div",{children:"留痕"})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"90px 1fr 96px",alignItems:"start",borderBottom:"1px solid var(--line-soft)",padding:"8px 12px"},children:[r.jsx("div",{className:"small",children:"10/30 22:10"}),r.jsxs("div",{children:[r.jsxs("div",{className:"small",style:{color:"var(--ink-100)"},children:[r.jsx("b",{children:"M1 初次接洽建立"}),"｜買方 A103"]}),r.jsx("div",{className:"small",style:{color:"var(--ink-300)"},children:"房源：惠宇上晴 12F"})]}),r.jsx("div",{children:r.jsx("div",{className:x["uag-badge"],style:{fontSize:"10px"},children:"hash: 9f2a…"})})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"90px 1fr 96px",alignItems:"start",borderBottom:"1px solid var(--line-soft)",padding:"8px 12px"},children:[r.jsx("div",{className:"small",children:"10/31 09:20"}),r.jsxs("div",{children:[r.jsxs("div",{className:"small",style:{color:"var(--ink-100)"},children:[r.jsx("b",{children:"M2 帶看雙方到場"}),"｜買方 A103"]}),r.jsx("div",{className:"small",style:{color:"var(--ink-300)"},children:"GeoTag: 南屯社區大廳"})]}),r.jsx("div",{children:r.jsx("div",{className:x["uag-badge"],style:{fontSize:"10px"},children:"sig: b7aa…"})})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"90px 1fr 96px",alignItems:"start",background:"#fefce8",padding:"8px 12px"},children:[r.jsx("div",{className:"small",children:"10/31 10:40"}),r.jsxs("div",{children:[r.jsxs("div",{className:"small",style:{color:"var(--ink-100)"},children:[r.jsx("b",{children:"M3 買方出價"}),"｜買方 A103"]}),r.jsx("div",{className:"small",style:{color:"var(--ink-300)"},children:"出價 NT$31,500,000"})]}),r.jsx("div",{children:r.jsx("div",{className:x["uag-badge"],style:{fontSize:"10px",background:"#fef3c7",color:"#92400e",border:"1px solid #f6d88a"},children:"hash: 1a7c…"})})]})]}),r.jsx("div",{style:{padding:"12px",borderTop:"1px solid var(--line-soft)",textAlign:"center"},children:r.jsx(ps,{to:"/assure",className:`${x["uag-btn"]} ${x.primary}`,style:{width:"100%",display:"block",textAlign:"center",textDecoration:"none"},children:"進入安心留痕 (Trust Room)"})})]})]})}function Hp(){const{data:e,isLoading:t,buyLead:s,isBuying:n,useMock:a,toggleMode:o}=$p(),{selectedLead:i,selectLead:l,close:c}=Mp(),d=g.useRef(null),u=async m=>{!e||n||(s(m),c())};return t?r.jsx(Lp,{}):e?r.jsxs("div",{className:x["uag-page"],children:[r.jsx(ea,{position:"top-center"}),r.jsx(Fp,{}),r.jsx("main",{className:x["uag-container"],children:r.jsxs("div",{className:x["uag-grid"],children:[r.jsx(Up,{leads:e.leads,onSelectLead:l}),r.jsx(Bp,{ref:d,selectedLead:i,onBuyLead:u,isProcessing:n}),r.jsx(Wp,{leads:e.leads}),r.jsx(Vp,{listings:e.listings,feed:e.feed}),r.jsx(Qp,{}),r.jsx(Gp,{})]})}),r.jsx(Dp,{user:e.user,useMock:a,toggleMode:o})]}):null}function Kp(){return r.jsx(Hi,{children:({reset:e})=>r.jsx(hd,{onReset:e,FallbackComponent:Zp,children:r.jsx(Hp,{})})})}const Jp=e=>{const t=Math.floor(e*.4),s=Math.floor(e*.3),n=Math.floor(e*.3);return[{label:"實名認證",value:t,icon:na},{label:"回覆速度",value:s,icon:sa},{label:"成交記錄",value:n,icon:ci}]},Yp=({isOpen:e,onClose:t,agentName:s})=>{const[n,a]=g.useState(null),[o,i]=g.useState(""),[l,c]=g.useState(!1),d=g.useMemo(()=>{const m=[],p=["日","一","二","三","四","五","六"];for(let f=1;f<=7;f++){const v=new Date;v.setDate(v.getDate()+f);const _=`${v.getMonth()+1}/${v.getDate()}`,y=p[v.getDay()]??"日",k=v.getDay()===0||v.getDay()===6?["10:00","11:00","14:00","15:00","16:00"]:["14:00","15:00","19:00"];m.push({date:_,day:y,times:k})}return m},[]);if(!e)return null;const u=()=>{!n||!o||(c(!0),setTimeout(()=>{t(),c(!1),a(null),i("")},2e3))};return r.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-end sm:items-center justify-center p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden shadow-2xl",children:[r.jsx("div",{className:"bg-gradient-to-r from-[#003366] to-[#00A8E8] p-4 text-white",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-bold text-lg",children:"預約看屋"}),r.jsxs("p",{className:"text-sm opacity-80",children:["選擇方便的時段，",s," 將為您安排"]})]}),r.jsx("button",{onClick:t,className:"p-1 hover:bg-white/20 rounded-full transition-colors",children:r.jsx(aa,{size:20})})]})}),l?r.jsxs("div",{className:"p-8 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx(na,{className:"text-green-500",size:32})}),r.jsx("h4",{className:"text-xl font-bold text-slate-800 mb-2",children:"預約成功！"}),r.jsx("p",{className:"text-slate-500",children:"經紀人將盡快與您聯繫確認"})]}):r.jsxs("div",{className:"p-4 overflow-y-auto max-h-[60vh]",children:[r.jsx("div",{className:"space-y-3 mb-4",children:d.slice(0,4).map(m=>r.jsxs("div",{children:[r.jsxs("div",{className:"text-xs font-medium text-slate-500 mb-2",children:[m.date," (週",m.day,")"]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:m.times.map(p=>{const f=`${m.date}-${p}`,v=n===f;return r.jsx("button",{onClick:()=>a(f),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-all ${v?"bg-[#003366] text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:p},f)})})]},m.date))}),r.jsxs("div",{className:"mt-4",children:[r.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"您的手機號碼"}),r.jsx("input",{type:"tel",value:o,onChange:m=>i(m.target.value),placeholder:"0912-345-678",className:"w-full p-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-[#003366] focus:border-transparent outline-none"})]}),r.jsxs("button",{onClick:u,disabled:!n||!o,className:`w-full mt-4 py-3 rounded-xl font-bold transition-all flex items-center justify-center gap-2 ${n&&o?"bg-[#003366] text-white hover:bg-[#004488]":"bg-slate-100 text-slate-400 cursor-not-allowed"}`,children:[r.jsx(pr,{size:18}),"確認預約"]})]})]})})},Xp=({agent:e,onLineClick:t,onCallClick:s})=>{const[n,a]=g.useState(!1),[o,i]=g.useState(!1),l=g.useMemo(()=>Math.random()>.3,[]),c=Jp(e.trustScore);return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-100 p-4",children:[r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx("img",{src:e.avatarUrl,alt:e.name,className:"w-16 h-16 rounded-full object-cover border-2 border-white shadow-md"}),r.jsxs("div",{className:`absolute -bottom-1 -right-1 ${l?"bg-green-500":"bg-slate-400"} text-white text-[10px] px-1.5 py-0.5 rounded-full flex items-center gap-0.5 border border-white`,children:[r.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${l?"bg-white animate-pulse":"bg-slate-300"}`}),r.jsx("span",{children:l?"在線":"離線"})]})]}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"flex justify-between items-start",children:r.jsxs("div",{children:[r.jsxs("h3",{className:"font-bold text-slate-800 text-lg flex items-center gap-2",children:[e.name,r.jsx("span",{className:"text-xs font-normal text-slate-500 bg-slate-100 px-2 py-0.5 rounded-full",children:e.company})]}),r.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[r.jsxs("p",{className:"text-xs text-slate-400",children:["經紀人編號：#",e.internalCode]}),r.jsxs("div",{className:"flex items-center gap-0.5 text-green-600 bg-green-50 px-1.5 py-0.5 rounded text-[10px]",children:[r.jsx(mr,{size:10}),r.jsx("span",{children:"已認證"})]})]})]})}),r.jsxs("div",{className:"flex items-center gap-4 mt-3",children:[r.jsxs("div",{className:"flex items-center gap-1.5 relative cursor-pointer",onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),children:[r.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-50 flex items-center justify-center text-[#003366]",children:r.jsx(li,{size:16,fill:"currentColor"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-bold text-[#003366]",children:e.trustScore}),r.jsx("div",{className:"text-[10px] text-slate-500",children:"信任分"})]}),n&&r.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-48 bg-slate-800 text-white text-xs rounded-lg p-3 shadow-xl z-10",children:[r.jsx("div",{className:"font-bold mb-2",children:"信任分數構成"}),c.map(d=>r.jsxs("div",{className:"flex items-center justify-between py-1",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(d.icon,{size:12,className:"text-green-400"}),r.jsx("span",{children:d.label})]}),r.jsxs("span",{className:"font-medium",children:["+",d.value]})]},d.label)),r.jsxs("div",{className:"border-t border-slate-600 mt-2 pt-2 flex justify-between font-bold",children:[r.jsx("span",{children:"總計"}),r.jsx("span",{className:"text-green-400",children:e.trustScore})]}),r.jsx("div",{className:"absolute top-full left-4 border-8 border-transparent border-t-slate-800"})]})]}),r.jsx("div",{className:"w-px h-8 bg-slate-100"}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("div",{className:"w-8 h-8 rounded-lg bg-orange-50 flex items-center justify-center text-orange-500",children:r.jsx(Fs,{size:16})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-bold text-slate-800",children:e.encouragementCount}),r.jsx("div",{className:"text-[10px] text-slate-500",children:"獲得鼓勵"})]})]})]}),l&&r.jsxs("div",{className:"mt-3 text-xs text-green-600 bg-green-50 px-2 py-1 rounded-lg inline-flex items-center gap-1",children:[r.jsx(sa,{size:12}),"平均 5 分鐘內回覆"]})]})]}),r.jsxs("div",{className:"mt-4 pt-3 border-t border-slate-50 space-y-2",children:[r.jsxs("button",{onClick:t,className:"w-full bg-[#06C755] text-white text-sm font-bold py-2.5 rounded-lg hover:bg-[#05B04A] transition-colors flex items-center justify-center gap-2 shadow-sm",children:[r.jsx(ra,{size:18}),"加 LINE 聊聊"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("button",{onClick:()=>i(!0),className:"flex-1 bg-[#003366] text-white text-sm font-medium py-2 rounded-lg hover:bg-[#004488] transition-colors flex items-center justify-center gap-1.5",children:[r.jsx(pr,{size:16}),"預約看屋"]}),r.jsxs("button",{onClick:s,className:"flex-1 bg-white border border-[#003366] text-[#003366] text-sm font-medium py-2 rounded-lg hover:bg-blue-50 transition-colors flex items-center justify-center gap-1.5",children:[r.jsx(hr,{size:16}),"致電諮詢"]})]})]})]}),r.jsx(Yp,{isOpen:o,onClose:()=>i(!1),agentName:e.name})]})},lr={id:"b0eebc99-9c0b-4ef8-bb6d-6bb9bd380a22",publicId:"MH-100001",title:"信義區101景觀全新裝潢大三房",price:3680,address:"台北市信義區",description:"這是一間位於信義區的優質好房，擁有絕佳的101景觀，全新裝潢，即可入住。周邊生活機能完善，交通便利，是您成家的最佳選擇。",images:["https://images.unsplash.com/photo-1600607687939-ce8a6c25118c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80"],agent:{id:"a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11",internalCode:1,name:"王小明",avatarUrl:"https://images.unsplash.com/photo-1560250097-0b93528c311a?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&q=80",company:"邁房子信義店",trustScore:92,encouragementCount:156}},cr={getPropertyByPublicId:async e=>{try{const{data:t,error:s}=await H.from("properties").select(`
          *,
          agent:agents (*)
        `).eq("public_id",e).single();return s||!t?(console.warn("查無正式資料，使用預設資料",s),e==="MH-100001"?lr:null):{id:t.id,publicId:t.public_id,title:t.title,price:Number(t.price),address:t.address,description:t.description,images:t.images||[],sourcePlatform:t.source_platform,agent:{id:t.agent.id,internalCode:t.agent.internal_code,name:t.agent.name,avatarUrl:t.agent.avatar_url||"https://via.placeholder.com/150",company:t.agent.company,trustScore:t.agent.trust_score,encouragementCount:t.agent.encouragement_count}}}catch(t){return console.error("Service Error:",t),lr}},createProperty:async(e,t)=>{const{data:s,error:n}=await H.from("properties").insert({title:e.title,price:e.price,address:e.address,description:e.description,images:e.images,source_platform:e.sourcePlatform,source_external_id:e.sourceExternalId,agent_id:t}).select().single();if(n)throw n;return s},uploadImages:async e=>{const t=e.map(async n=>{const a=n.name.split(".").pop(),o=`${crypto.randomUUID()}.${a}`,{error:i}=await H.storage.from("property-images").upload(o,n);if(i)return console.error("Image upload error:",i),null;const{data:l}=H.storage.from("property-images").getPublicUrl(o);return l.publicUrl});return(await Promise.all(t)).filter(n=>!!n)},createPropertyWithForm:async(e,t)=>{const{data:{user:s}}=await H.auth.getUser(),n=(s==null?void 0:s.id)||"a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11",{data:a,error:o}=await H.from("properties").insert({agent_id:n,title:e.title,price:Number(e.price),address:e.address,size:Number(e.size||0),age:Number(e.age||0),rooms:Number(e.rooms),halls:Number(e.halls),bathrooms:Number(e.bathrooms),floor_current:e.floorCurrent,floor_total:Number(e.floorTotal||0),property_type:e.type,advantage_1:e.advantage1,advantage_2:e.advantage2,disadvantage:e.disadvantage,description:e.description,images:t,features:[e.type,e.advantage1,e.advantage2].filter(Boolean),source_platform:e.sourceExternalId?"591":"MH",source_external_id:e.sourceExternalId||null}).select().single();if(o)throw o;return a}},ef=(e,t)=>{const s=g.useRef(Date.now()),n=g.useRef({click_photos:0,click_line:0,click_call:0,scroll_depth:0}),a=g.useRef(!1),o=g.useCallback(()=>{let l=localStorage.getItem("uag_session");return l||(l=`u_${Math.random().toString(36).substring(2,11)}`,localStorage.setItem("uag_session",l)),l},[]),i=g.useCallback(l=>{const c={session_id:o(),agent_id:t,fingerprint:btoa(JSON.stringify({screen:`${screen.width}x${screen.height}`,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,language:navigator.language})),event:{type:l,property_id:e,district:"unknown",duration:Math.round((Date.now()-s.current)/1e3),actions:{...n.current},focus:[]}},d=new Blob([JSON.stringify(c)],{type:"application/json"});navigator.sendBeacon("/api/uag-track",d)},[e,t,o]);return g.useEffect(()=>{const l=()=>{const c=Math.round((window.scrollY+window.innerHeight)/document.body.scrollHeight*100);c>n.current.scroll_depth&&(n.current.scroll_depth=c)};return window.addEventListener("scroll",l,{passive:!0}),()=>window.removeEventListener("scroll",l)},[]),g.useEffect(()=>{if(!e)return;i("page_view");const l=()=>{a.current||(a.current=!0,i("page_exit"))};return window.addEventListener("pagehide",l),window.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&l()}),()=>{window.removeEventListener("pagehide",l),l()}},[e,i]),{trackPhotoClick:()=>{n.current.click_photos++},trackLineClick:()=>{n.current.click_line=1,i("click_line")},trackCallClick:()=>{n.current.click_call=1,i("click_call")}}},tf=()=>{var m;const{id:e}=Oo(),[t]=Mo(),[s,n]=g.useState(!1),[a,o]=g.useState(lr),l=ef(e||"",(()=>{let p=t.get("aid");return p||(p=localStorage.getItem("uag_last_aid")),p&&p!=="unknown"&&localStorage.setItem("uag_last_aid",p),p||"unknown"})()),c=g.useMemo(()=>{var f;const p=((f=a.publicId)==null?void 0:f.charCodeAt(3))||0;return{currentViewers:Math.floor(p%5)+2,weeklyBookings:Math.floor(p%8)+5,isHot:p%3===0}},[a.publicId]);g.useEffect(()=>{(async()=>{if(e)try{const f=await cr.getPropertyByPublicId(e);f&&o(f)}catch(f){console.error("Fetch error:",f)}})()},[e]);const d="https://images.unsplash.com/photo-1600607687939-ce8a6c25118c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80";let u=a.images&&a.images.length>0&&a.images[0]?a.images[0]:d;return u&&u.includes("picsum")&&(u=d),r.jsxs("div",{className:"min-h-screen bg-[#f8fafc] font-sans text-slate-800",children:[r.jsxs("nav",{className:"sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b border-slate-100 h-16 flex items-center px-4 shadow-sm justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:r.jsx(oa,{size:20,className:"text-slate-600"})}),r.jsxs("div",{className:"flex items-center text-[#003366] font-extrabold text-xl gap-2",children:[r.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-[#003366] to-[#00A8E8] rounded-lg flex items-center justify-center text-white",children:r.jsx(Dt,{size:18})}),"邁房子"]})]}),r.jsxs("div",{className:"flex items-center text-xs font-mono text-slate-500 bg-slate-50 px-3 py-1.5 rounded-lg border border-slate-200",children:[r.jsx(di,{size:12,className:"mr-1 text-gray-400"}),"編號：",r.jsx("span",{className:"font-bold text-[#003366] ml-1",children:a.publicId})]})]}),r.jsxs("main",{className:"max-w-4xl mx-auto p-4 pb-24",children:[r.jsxs("div",{className:"aspect-video bg-slate-200 rounded-2xl overflow-hidden mb-6 relative group",children:[r.jsx("img",{src:u,alt:a.title,onError:p=>{p.currentTarget.src!==d&&(p.currentTarget.src=d)},className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"}),r.jsxs("div",{className:"absolute bottom-4 right-4 bg-black/50 backdrop-blur-md text-white text-xs px-3 py-1.5 rounded-full flex items-center gap-1",children:[r.jsx(Dt,{size:12}),r.jsxs("span",{children:["共 ",((m=a.images)==null?void 0:m.length)||0," 張照片"]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsx("h1",{className:"text-2xl font-bold text-slate-900 leading-tight",children:a.title}),r.jsx("button",{onClick:()=>n(!s),className:`p-2 rounded-full transition-all ${s?"bg-red-50 text-red-500":"bg-slate-50 text-slate-400 hover:bg-slate-100"}`,children:r.jsx(ui,{size:24,fill:s?"currentColor":"none"})})]}),r.jsxs("div",{className:"flex items-center gap-2 text-slate-500 mt-2 text-sm",children:[r.jsx(ia,{size:16}),a.address]}),r.jsxs("div",{className:"mt-4 flex items-baseline gap-2",children:[r.jsx("span",{className:"text-3xl font-extrabold text-[#003366]",children:a.price}),r.jsx("span",{className:"text-lg text-slate-500 font-medium",children:"萬"})]}),r.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[c.isHot&&r.jsxs("div",{className:"inline-flex items-center gap-1 text-xs font-medium text-orange-600 bg-orange-50 px-2 py-1 rounded-full animate-pulse",children:[r.jsx(Dr,{size:12}),"熱門物件"]}),r.jsxs("div",{className:"inline-flex items-center gap-1 text-xs text-slate-600 bg-slate-50 px-2 py-1 rounded-full",children:[r.jsx(Lr,{size:12,className:"text-blue-500"}),c.currentViewers," 人正在瀏覽"]}),r.jsxs("div",{className:"inline-flex items-center gap-1 text-xs text-slate-600 bg-slate-50 px-2 py-1 rounded-full",children:[r.jsx(hi,{size:12,className:"text-green-500"}),"本週 ",c.weeklyBookings," 組預約看屋"]})]})]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:["近捷運","全新裝潢","有車位","高樓層"].map(p=>r.jsx("span",{className:"px-3 py-1 bg-blue-50 text-[#003366] text-xs font-medium rounded-full",children:p},p))}),r.jsx("div",{className:"h-px bg-slate-100"}),r.jsxs("div",{className:"prose prose-slate max-w-none",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-3",children:"物件特色"}),r.jsx("p",{className:"text-slate-600 leading-relaxed whitespace-pre-line",children:a.description})]})]}),r.jsx("div",{className:"lg:col-span-1",children:r.jsxs("div",{className:"sticky top-24 space-y-4",children:[r.jsx(Xp,{agent:a.agent,onLineClick:l.trackLineClick,onCallClick:l.trackCallClick}),r.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 border border-blue-100",children:[r.jsxs("h4",{className:"font-bold text-[#003366] text-sm mb-2 flex items-center gap-2",children:[r.jsx(mr,{size:16}),"安心交易保障"]}),r.jsxs("ul",{className:"space-y-2",children:[r.jsxs("li",{className:"text-xs text-slate-600 flex items-center gap-2",children:[r.jsx("div",{className:"w-1 h-1 bg-blue-400 rounded-full"}),"產權調查確認"]}),r.jsxs("li",{className:"text-xs text-slate-600 flex items-center gap-2",children:[r.jsx("div",{className:"w-1 h-1 bg-blue-400 rounded-full"}),"履約保證專戶"]}),r.jsxs("li",{className:"text-xs text-slate-600 flex items-center gap-2",children:[r.jsx("div",{className:"w-1 h-1 bg-blue-400 rounded-full"}),"凶宅查詢過濾"]})]})]})]})})]})]}),r.jsxs("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-slate-100 p-3 lg:hidden z-50 pb-safe",children:[r.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2 text-xs",children:[r.jsxs("span",{className:"flex items-center gap-1 text-slate-500",children:[r.jsx(Lr,{size:12,className:"text-blue-500"}),c.currentViewers," 人正在瀏覽"]}),c.isHot&&r.jsxs("span",{className:"flex items-center gap-1 text-orange-500 font-medium",children:[r.jsx(Dr,{size:12}),"熱門"]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("button",{onClick:l.trackLineClick,className:"flex-[4] bg-[#06C755] text-white font-bold py-3 rounded-xl flex items-center justify-center gap-2 shadow-lg shadow-green-500/20",children:[r.jsx(ra,{size:20}),"加 LINE 諮詢"]}),r.jsxs("button",{onClick:l.trackCallClick,className:"flex-[6] bg-[#003366] text-white font-bold py-3 rounded-xl flex items-center justify-center gap-2 shadow-lg shadow-blue-900/20",children:[r.jsx(pr,{size:20}),"預約看屋"]})]})]})]})},sf=()=>{const e=ur(),t=g.useRef(null),[s,n]=g.useState(!1),[a,o]=g.useState([]),[i,l]=g.useState([]),[c,d]=g.useState(null),[u,m]=g.useState({title:"",price:"",address:"",size:"",age:"",floorCurrent:"",floorTotal:"",rooms:"3",halls:"2",bathrooms:"2",type:"電梯大樓",description:"",advantage1:"",advantage2:"",disadvantage:"",sourceExternalId:""});g.useEffect(()=>{H.auth.getUser().then(({data:N})=>{d(N.user)})},[]);const p=N=>{m({...u,[N.target.name]:N.target.value})},f={adv1Valid:u.advantage1.length>=5,adv2Valid:u.advantage2.length>=5,disValid:u.disadvantage.length>=10,get allValid(){return this.adv1Valid&&this.adv2Valid&&this.disValid}},v=u.title.length>0&&u.price.length>0&&u.address.length>0,_=v&&f.allValid&&i.length>0,y=()=>{prompt("請貼上 591 網址")&&(n(!0),setTimeout(()=>{m(S=>({...S,title:"【急售】信義區捷運景觀豪邸",price:"2880",address:"台北市信義區忠孝東路",size:"45.2",sourceExternalId:"591-MOCK-ID"})),n(!1)},1e3))},k=N=>{if(N.target.files&&N.target.files.length>0){const S=Array.from(N.target.files);l(j=>[...j,...S]);const T=S.map(j=>URL.createObjectURL(j));o(j=>[...j,...T])}},O=N=>{o(S=>S.filter((T,j)=>j!==N)),l(S=>S.filter((T,j)=>j!==N))},z=async()=>{if(!v)return alert("請填寫標題、價格、地址");if(!f.allValid)return alert("兩好一公道字數不足！");if(i.length===0)return alert("請至少上傳一張照片");n(!0);try{const N=await cr.uploadImages(i),S=await cr.createPropertyWithForm(u,N);alert("🎉 刊登成功！物件編號："+S.public_id),e("/property/"+S.public_id)}catch(N){alert("失敗："+N.message)}finally{n(!1)}},w="w-full p-3 rounded-xl bg-slate-50 border border-slate-200 focus:ring-2 focus:ring-[#003366] focus:border-transparent outline-none text-sm";return r.jsxs("div",{className:"min-h-screen bg-[#f8fafc] font-sans text-slate-800",children:[r.jsxs("nav",{className:"sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b border-slate-100 h-16 flex items-center px-4 shadow-sm justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{onClick:()=>e(-1),className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:r.jsx(oa,{size:20,className:"text-slate-600"})}),r.jsxs("div",{className:"flex items-center text-[#003366] font-extrabold text-xl gap-2",children:[r.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-[#003366] to-[#00A8E8] rounded-lg flex items-center justify-center text-white",children:r.jsx(Dt,{size:18})}),"邁房子"]})]}),r.jsxs("button",{onClick:y,disabled:s,className:"text-xs bg-blue-50 text-[#00A8E8] px-3 py-1.5 rounded-lg font-bold hover:bg-blue-100 flex items-center gap-1 border border-blue-100",children:[s?r.jsx(Zr,{size:12,className:"animate-spin"}):r.jsx(mi,{size:12}),"591 搬家"]})]}),r.jsxs("main",{className:"max-w-2xl mx-auto p-4 pb-32 space-y-5",children:[r.jsxs("section",{className:"bg-white p-5 rounded-2xl border border-slate-100 shadow-sm",children:[r.jsxs("h2",{className:"text-lg font-bold text-[#003366] mb-4 flex items-center gap-2",children:[r.jsx(Dt,{size:18})," 基本資料"]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"物件標題 *"}),r.jsx("input",{name:"title",value:u.title,onChange:p,className:w+" font-bold",placeholder:"例如：信義區101景觀全新裝潢大三房"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"價格 (萬) *"}),r.jsx("input",{name:"price",type:"number",value:u.price,onChange:p,className:w,placeholder:"0"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"地址 *"}),r.jsx("input",{name:"address",value:u.address,onChange:p,className:w,placeholder:"台北市信義區..."})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"坪數"}),r.jsx("input",{name:"size",type:"number",value:u.size,onChange:p,className:w,placeholder:"0"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"屋齡"}),r.jsx("input",{name:"age",type:"number",value:u.age,onChange:p,className:w,placeholder:"0"})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"類型"}),r.jsxs("select",{name:"type",value:u.type,onChange:p,className:w,children:[r.jsx("option",{children:"電梯大樓"}),r.jsx("option",{children:"公寓"}),r.jsx("option",{children:"透天"}),r.jsx("option",{children:"套房"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"房"}),r.jsx("input",{name:"rooms",type:"number",value:u.rooms,onChange:p,className:w})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"廳"}),r.jsx("input",{name:"halls",type:"number",value:u.halls,onChange:p,className:w})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"衛"}),r.jsx("input",{name:"bathrooms",type:"number",value:u.bathrooms,onChange:p,className:w})]})]})]})]}),r.jsxs("section",{className:"bg-white p-5 rounded-2xl border border-slate-100 shadow-sm",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[r.jsx(mr,{className:"text-orange-500",size:20}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-lg font-bold text-[#003366]",children:"兩好一公道"}),r.jsx("p",{className:"text-xs text-slate-500",children:"誠實揭露，建立買賣信任"})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"flex items-center gap-1.5 font-medium text-green-700 mb-1 text-xs",children:[r.jsx(Fs,{size:14})," 優點 1 (至少 5 字)"]}),r.jsx("input",{name:"advantage1",value:u.advantage1,onChange:p,className:w+(f.adv1Valid?" border-green-300 bg-green-50/50":""),placeholder:"例如：格局方正，採光極佳"}),r.jsxs("span",{className:"text-xs mt-0.5 block "+(f.adv1Valid?"text-green-600":"text-slate-400"),children:[u.advantage1.length,"/5 字 ",f.adv1Valid&&"✓"]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"flex items-center gap-1.5 font-medium text-green-700 mb-1 text-xs",children:[r.jsx(Fs,{size:14})," 優點 2 (至少 5 字)"]}),r.jsx("input",{name:"advantage2",value:u.advantage2,onChange:p,className:w+(f.adv2Valid?" border-green-300 bg-green-50/50":""),placeholder:"例如：近捷運站，生活機能好"}),r.jsxs("span",{className:"text-xs mt-0.5 block "+(f.adv2Valid?"text-green-600":"text-slate-400"),children:[u.advantage2.length,"/5 字 ",f.adv2Valid&&"✓"]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"flex items-center gap-1.5 font-medium text-orange-700 mb-1 text-xs",children:[r.jsx(pi,{size:14})," 誠實公道話 (至少 10 字)"]}),r.jsx("input",{name:"disadvantage",value:u.disadvantage,onChange:p,className:w+(f.disValid?" border-orange-300 bg-orange-50/50":""),placeholder:"例如：臨路有車流聲，建議加裝氣密窗"}),r.jsxs("span",{className:"text-xs mt-0.5 block "+(f.disValid?"text-orange-600":"text-red-400"),children:[u.disadvantage.length,"/10 字 ",f.disValid?"✓":"(請更詳細描述)"]})]})]})]}),r.jsxs("section",{className:"bg-white p-5 rounded-2xl border border-slate-100 shadow-sm",children:[r.jsxs("h2",{className:"text-lg font-bold text-[#003366] mb-4 flex items-center gap-2",children:[r.jsx(Xn,{size:18,className:"text-yellow-500"})," 文案與照片"]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"物件描述"}),r.jsx("textarea",{name:"description",value:u.description,onChange:p,rows:4,className:w+" resize-none",placeholder:"詳細介紹這個物件的特色、生活機能、交通便利性..."})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-slate-600 mb-2",children:["物件照片 * ",r.jsx("span",{className:"text-slate-400",children:"(至少 1 張)"})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[a.map((N,S)=>r.jsxs("div",{className:"aspect-square rounded-xl overflow-hidden relative group border border-slate-200",children:[r.jsx("img",{src:N,alt:"",className:"w-full h-full object-cover"}),r.jsx("button",{onClick:()=>O(S),className:"absolute top-1 right-1 bg-red-500 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition",children:r.jsx(aa,{size:12})}),S===0&&r.jsx("span",{className:"absolute bottom-1 left-1 bg-[#003366] text-white text-[10px] px-1.5 py-0.5 rounded",children:"封面"})]},S)),r.jsxs("button",{onClick:()=>{var N;return(N=t.current)==null?void 0:N.click()},className:"aspect-square rounded-xl border-2 border-dashed border-slate-300 flex flex-col items-center justify-center text-slate-400 hover:border-[#00A8E8] hover:text-[#00A8E8] transition-colors",children:[r.jsx(fi,{size:24}),r.jsx("span",{className:"text-xs mt-1",children:"上傳"})]}),r.jsx("input",{type:"file",multiple:!0,ref:t,onChange:k,className:"hidden",accept:"image/*"})]})]})]})]}),(u.title||u.price||a.length>0)&&r.jsxs("section",{className:"bg-slate-50 p-4 rounded-2xl border border-slate-200",children:[r.jsxs("h3",{className:"text-sm font-bold text-slate-500 mb-3 flex items-center gap-2",children:[r.jsx(ia,{size:14})," 即時預覽"]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:[a.length>0&&r.jsx("div",{className:"aspect-video",children:r.jsx("img",{src:a[0],alt:"",className:"w-full h-full object-cover"})}),r.jsxs("div",{className:"p-4",children:[r.jsx("h4",{className:"font-bold text-slate-900",children:u.title||"物件標題"}),r.jsx("p",{className:"text-xs text-slate-500 mt-1",children:u.address||"地址"}),r.jsxs("div",{className:"flex items-baseline gap-1 mt-2",children:[r.jsx("span",{className:"text-xl font-extrabold text-[#003366]",children:u.price||"0"}),r.jsx("span",{className:"text-sm text-slate-500",children:"萬"})]}),r.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:[u.type,u.size&&u.size+"坪",u.rooms+"房"+u.halls+"廳"+u.bathrooms+"衛"].filter(Boolean).map((N,S)=>r.jsx("span",{className:"px-2 py-0.5 bg-blue-50 text-[#003366] text-xs rounded-full",children:N},S))})]})]})]})]}),r.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-slate-100 p-4 z-50",children:r.jsxs("div",{className:"max-w-2xl mx-auto",children:[r.jsxs("button",{onClick:z,disabled:s||!_,className:"w-full py-4 rounded-xl font-bold text-lg flex items-center justify-center gap-2 transition-all "+(_?"bg-gradient-to-r from-[#003366] to-[#00A8E8] text-white shadow-lg shadow-blue-900/20 hover:scale-[1.01]":"bg-slate-200 text-slate-400 cursor-not-allowed"),children:[s?r.jsx(Zr,{className:"animate-spin",size:20}):r.jsx(ta,{size:20}),s?"上傳中...":_?"確認刊登物件":"請完成必填欄位"]}),!_&&r.jsxs("div",{className:"flex justify-center gap-4 mt-2 text-xs text-slate-400",children:[r.jsx("span",{className:v?"text-green-600":"",children:v?"✓ 基本資料":"○ 基本資料"}),r.jsx("span",{className:f.allValid?"text-green-600":"",children:f.allValid?"✓ 兩好一公道":"○ 兩好一公道"}),r.jsx("span",{className:i.length>0?"text-green-600":"",children:i.length>0?"✓ 照片":"○ 照片"})]})]})})]})},rf=new Wi({defaultOptions:{queries:{staleTime:1e3*60*5,retry:1}}});function nf(){const[e,t]=g.useState(null),s=Jn();return g.useEffect(()=>{Sa().then(t)},[]),g.useEffect(()=>{e&&Kt("page_view",s.pathname)},[s,e]),e?r.jsx(Vi,{client:rf,children:r.jsx(gl,{children:r.jsxs(cd,{children:[r.jsxs(Fo,{children:[r.jsx(ge,{path:"/",element:r.jsx(_e,{children:r.jsx(Lc,{config:e})})}),r.jsx(ge,{path:"/uag",element:r.jsx(Kp,{})}),r.jsx(ge,{path:"/auth/register",element:r.jsx(_e,{children:r.jsx(Wc,{})})}),r.jsx(ge,{path:"/auth/login",element:r.jsx(_e,{children:r.jsx(Vc,{})})}),r.jsx(ge,{path:"/community/:id/wall",element:r.jsx(_e,{children:r.jsx(Qc,{})})}),r.jsx(ge,{path:"/community/suggested",element:r.jsx(_e,{children:r.jsx(Gc,{})})}),r.jsx(ge,{path:"/property/upload",element:r.jsx(_e,{children:r.jsx(sf,{})})}),r.jsx(ge,{path:"/property/:id",element:r.jsx(_e,{children:r.jsx(tf,{})})}),r.jsx(ge,{path:"/p/:id",element:r.jsx(_e,{children:r.jsx(nd,{})})}),r.jsx(ge,{path:"/maihouses/trust/room",element:r.jsx(_e,{children:r.jsx(fn,{})})}),r.jsx(ge,{path:"/assure",element:r.jsx(_e,{children:r.jsx(fn,{})})}),r.jsx(ge,{path:"/chat",element:r.jsx(_e,{children:r.jsx(id,{})})})]},s.pathname),e.devtools==="1"&&r.jsx(Rl,{config:e}),r.jsx(dd,{})]})})}):r.jsx("div",{className:"p-6 text-sm text-[var(--text-secondary)]",children:"載入中…"})}const Dn=document.getElementById("root");if(Dn){const e=window.location.pathname.startsWith("/maihouses")?"/maihouses":"/";Ds.createRoot(Dn).render(r.jsx(_s.StrictMode,{children:r.jsx(Do,{basename:e,children:r.jsx(nf,{})})}))}export{Sa as g};
//# sourceMappingURL=index-vIDXnQOM.js.map
