# ⛔️ AI AGENT 天條 v11.0 - 強制工具搜尋版 ⛔️

```
╔══════════════════════════════════════════════════════════════════════════════╗
║                                                                              ║
║   🚨🚨🚨 第零條天條：強制 Skills 搜尋 🚨🚨🚨                                  ║
║                                                                              ║
║   ⛔ 開始任何任務前，必須先搜尋適合的工具 ⛔                                   ║
║                                                                              ║
║   步驟：                                                                      ║
║   1. 分析任務類型                                                             ║
║   2. 搜尋相關 Skills / 工具                                                   ║
║   3. 在報告中列出找到的工具                                                   ║
║   4. 優先使用已有的工具，不重複造輪子                                          ║
║                                                                              ║
║   沒有搜尋工具就開始寫代碼 = 違規 = 任務失敗                                   ║
║                                                                              ║
╚══════════════════════════════════════════════════════════════════════════════╝
```

---

## 🔧 工具搜尋關鍵字對照表

| 任務類型 | 必搜關鍵字               | 額外關鍵字                        |
| -------- | ------------------------ | --------------------------------- |
| 前端 UI  | `react`, `component`     | `tailwind`, `ui`, `form`, `modal` |
| API 開發 | `api`, `rest`            | `fetch`, `serverless`, `endpoint` |
| 資料庫   | `database`, `supabase`   | `postgres`, `sql`, `query`        |
| 認證     | `auth`, `authentication` | `jwt`, `oauth`, `session`         |
| 測試     | `test`, `testing`        | `jest`, `playwright`, `e2e`       |
| 部署     | `deploy`, `vercel`       | `ci/cd`, `github-actions`         |
| AI/LLM   | `openai`, `claude`       | `llm`, `chat`, `embedding`        |
| 圖片處理 | `image`, `upload`        | `imgix`, `compression`            |
| 工具     | `utility`, `helper`      | `validation`, `formatting`        |

---

# 🔥 全自動執行協議 v11.0

## ⚡ 收到任務的【第一秒】必須做的事

**不管任務是什麼，AI 收到任務後的第一個輸出必須是：**

```
╔══════════════════════════════════════════════════════════════╗
║ 📋 任務接收                                                  ║
╠══════════════════════════════════════════════════════════════╣
║ 🎯 任務：[用一句話描述任務]                                   ║
║ ⏰ 開始：[當前時間]                                          ║
╠══════════════════════════════════════════════════════════════╣
║ 🔍 工具搜尋結果：                                             ║
║   • 搜尋關鍵字：[關鍵字1], [關鍵字2]                          ║
║   • 找到工具：[工具1] - [用途]                                ║
║   • 決定使用：[選擇的工具]                                    ║
╠══════════════════════════════════════════════════════════════╣
║ 📖 需要閱讀的檔案：                                           ║
║   • [file1.ts] - [原因]                                       ║
║   • [file2.ts] - [原因]                                       ║
╠══════════════════════════════════════════════════════════════╣
║ 📝 工作清單（HARD GATE - 全部完成才算完成）：                 ║
║   ⬜ 1. [第一個子任務]                                        ║
║   ⬜ 2. [第二個子任務]                                        ║
║   ⬜ 3. [第三個子任務]                                        ║
║   ...                                                        ║
╚══════════════════════════════════════════════════════════════╝
```

**❌ 沒有工具搜尋結果 = 違規**
**❌ 沒有列出需要閱讀的檔案 = 違規**
**❌ 沒有這個輸出就開始寫代碼 = 違規**
**❌ 清單不完整 = 違規**
**❌ 跳過任何清單項目 = 違規**

---

## 📊 每完成一個清單項目必須輸出

```
═══════════════════════════════════════════════════════════════
📊 進度報告 [X/Y]
═══════════════════════════════════════════════════════════════
✅ 剛完成：[完成的項目描述]
📁 修改的檔案：[file.ts] - [改了什麼]
🔧 使用的工具：[使用了哪些工具]

📝 清單狀態：
  ✅ 1. [已完成項目]
  ✅ 2. [已完成項目]
  🔧 3. [當前進行中] ← 現在
  ⬜ 4. [待處理項目]
═══════════════════════════════════════════════════════════════
```

---

## 🏁 任務完成時必須輸出

```
╔══════════════════════════════════════════════════════════════╗
║ 🏁 任務完成                                                  ║
╠══════════════════════════════════════════════════════════════╣
║ 🎯 任務：[任務描述]                                          ║
╠══════════════════════════════════════════════════════════════╣
║ ✅ 完成清單：                                                 ║
║   ✅ 1. [完成項目]                                            ║
║   ✅ 2. [完成項目]                                            ║
║   ✅ 3. [完成項目]                                            ║
╠══════════════════════════════════════════════════════════════╣
║ 📁 修改的檔案：                                               ║
║   • [file1.ts] - [改了什麼]                                   ║
║   • [file2.ts] - [改了什麼]                                   ║
║ 🔧 使用的工具：                                               ║
║   • [tool1] - [用途]                                          ║
╠══════════════════════════════════════════════════════════════╣
║ ✅ 測試結果：                                                  ║
║   • npm run typecheck ✓                                       ║
║   • npm run lint ✓                                            ║
║   • npm run build ✓                                           ║
╚══════════════════════════════════════════════════════════════╝
```

---

## 🚫 違規行為（任一觸發 = 任務失敗）

| 違規           | 說明                                | 懲罰     |
| -------------- | ----------------------------------- | -------- |
| 沒搜尋工具     | 沒有先搜尋相關工具                  | 任務失敗 |
| 沒輸出任務接收 | 第一個輸出不是「📋 任務接收」框     | 任務失敗 |
| 沒列工作清單   | 沒有在開始時分析並列出所有子任務    | 任務失敗 |
| 沒閱讀檔案     | 修改前沒有先讀取相關檔案            | 任務失敗 |
| 跳過進度報告   | 完成子任務後沒有輸出進度報告        | -10 分   |
| 清單不完整     | 漏掉子任務，後來才發現要補做        | -20 分   |
| 沒輸出完成報告 | 任務結束時沒有輸出「🏁 任務完成」框 | -10 分   |
| 使用 any       | 使用了 any 類型                     | -20 分   |
| 空的 catch     | catch 區塊沒有處理錯誤              | -20 分   |
| 硬編碼密鑰     | 在代碼中硬編碼 API Key              | 立即終止 |
| 跳過測試       | 沒有執行驗證命令                    | -30 分   |
| 腦補需求       | 假設用戶意圖而不詢問                | 任務失敗 |
| 便宜行事       | 用簡單但錯誤的方案                  | 任務失敗 |

---

## 🔒 先讀後寫原則

### 修改任何檔案前必須：

1. **先讀取該檔案** - 了解現有結構
2. **讀取相關檔案** - 包括：
   - 相關的類型定義 (`types/*.ts`)
   - 相關的服務層 (`services/*.ts`)
   - 相關的組件 (`components/*.tsx`)
   - 相關的 API (`api/*.ts`)
3. **理解架構** - 確認現有代碼風格
4. **確認依賴** - 檢查 import/export 關係

### 違規示例

```typescript
// ❌ 錯誤：沒讀取就直接寫
// AI 直接創建 NewComponent.tsx，沒有先讀取現有組件的結構

// ✅ 正確：先讀取相關檔案
// 1. 讀取 src/components/ 了解組件結構
// 2. 讀取 src/types/ 了解類型定義
// 3. 讀取類似組件了解風格
// 4. 再創建新組件
```

---

## 💡 清單拆解原則

**AI 必須自己分析任務，拆解成具體的子任務：**

1. **每個子任務 = 一個可驗證的結果**
   - ❌ 錯誤：「處理樣式」
   - ✅ 正確：「建立 PostCard.tsx 組件」

2. **每個子任務 = 一個檔案或一個功能**
   - ❌ 錯誤：「寫完所有組件」
   - ✅ 正確：「建立 PostCard.tsx」「建立 WallTabs.tsx」「建立 WallStates.tsx」

3. **子任務順序 = 依賴順序**
   - 先做基礎，再做依賴基礎的

---

## 🔥 代碼品質標準

### 絕對禁止

```typescript
// ❌ 禁止 any
const data: any = fetchData();

// ❌ 禁止硬編碼密鑰
const API_KEY = "sk-xxx...";

// ❌ 禁止忽略錯誤
try { ... } catch (e) { /* 空的 */ }

// ❌ 禁止 console.log 在生產代碼
console.log("debug:", data);
```

### 正確做法

```typescript
// ✅ 明確類型
interface UserData {
  id: string;
  name: string;
}
const data: UserData = await fetchData();

// ✅ 環境變數
const apiKey = process.env.OPENAI_API_KEY;

// ✅ 完整錯誤處理
try {
  const result = await fetchData();
  return result;
} catch (error) {
  const message = error instanceof Error ? error.message : '未知錯誤';
  console.error('Fetch failed:', message);
  throw new Error(`無法取得資料: ${message}`);
}
```

---

## 🧪 強制驗證檢查

完成任務前**必須**執行以下命令：

```bash
# 1. TypeScript 類型檢查
npm run typecheck

# 2. ESLint 代碼風格檢查
npm run lint

# 3. 構建檢查
npm run build
```

**任何一項失敗 = 任務未完成**

---

## 🌐 語言規範

| 場景        | 語言                 |
| ----------- | -------------------- |
| AI 回覆     | 繁體中文（台灣用語） |
| UI 文字     | 繁體中文             |
| 錯誤訊息    | 繁體中文             |
| 變數/函數名 | 英文 camelCase       |
| 類型/介面名 | 英文 PascalCase      |
| 註解        | 繁體中文或英文       |

---

## 🏗️ 專案結構

```
maihouses/
├── .github/
│   └── copilot-instructions.md  # Copilot 天條
├── .cline/
│   └── rules/
│       └── global.md            # Cline 全域規則
├── .clinerules                  # Cline 工作區規則
├── .mcp.json                    # MCP 伺服器配置
├── mcp-servers/
│   └── skillsmp/                # SkillsMP MCP 伺服器
├── api/                         # Vercel Serverless Functions
├── src/
│   ├── components/              # React 組件
│   ├── pages/                   # 頁面
│   ├── services/                # 服務層
│   ├── types/                   # 類型定義
│   └── utils/                   # 工具函數
├── supabase/                    # Supabase 設定
└── tests/                       # 測試
```

---

## 📝 提交規範

```bash
feat: 新增 XXX 功能
fix: 修復 XXX 問題
refactor: 重構 XXX 模組
style: 調整 XXX 樣式
docs: 更新 XXX 文件
chore: 雜項更新
```

---

# MaiHouses (邁房子) - 專案指南

## 🏗️ 技術架構

- **前端**: React 18 + TypeScript + Vite
- **樣式**: Tailwind CSS
- **後端**: Vercel Serverless Functions
- **資料庫**: Supabase (PostgreSQL)
- **部署**: Vercel

## 🔐 環境變數

```bash
# 前端（VITE_ 前綴）
VITE_SUPABASE_URL=https://xxxxx.supabase.co
VITE_SUPABASE_ANON_KEY=eyJxxxxxx

# 後端
SUPABASE_URL=https://xxxxx.supabase.co
SUPABASE_SERVICE_ROLE_KEY=eyJxxxxxx
```

**絕對禁止**硬編碼任何密鑰！

---

_版本：v11.0 強制工具搜尋版_
_最後更新：2025/12/24_
