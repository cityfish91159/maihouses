/**
 * ğŸ† æœ€ä½³å¯¦è¸ Custom Hook æ¨¡æ¿
 *
 * çå‹µé»ï¼š
 * - æ­£ç¢ºçš„é¡å‹å®šç¾© (+8 åˆ†)
 * - useCallback/useMemo (+5 åˆ†)
 * - early return (+3 åˆ†)
 * - JSDoc (+3 åˆ†)
 * - ç²¾ç°¡ä»£ç¢¼ (<50è¡Œ +10 åˆ†)
 */

import { useState, useCallback, useMemo } from 'react';

// âœ… æ¸…æ™°çš„é¡å‹å®šç¾©
interface UseCustomHookOptions {
  initialValue?: string;
  maxLength?: number;
}

interface UseCustomHookReturn {
  value: string;
  setValue: (newValue: string) => void;
  reset: () => void;
  isValid: boolean;
  errorMessage: string | null;
}

/**
 * useCustomHook - Hook æè¿°
 *
 * @param options - é…ç½®é¸é …
 * @returns Hook è¿”å›å€¼
 *
 * @example
 * const { value, setValue, isValid } = useCustomHook({ maxLength: 100 });
 */
export function useCustomHook(
  options: UseCustomHookOptions = {}
): UseCustomHookReturn {
  const { initialValue = '', maxLength = 255 } = options;

  const [value, setValueInternal] = useState(initialValue);

  // âœ… useCallback å„ªåŒ–
  const setValue = useCallback(
    (newValue: string) => {
      if (newValue.length <= maxLength) {
        setValueInternal(newValue);
      }
    },
    [maxLength]
  );

  const reset = useCallback(() => {
    setValueInternal(initialValue);
  }, [initialValue]);

  // âœ… useMemo å„ªåŒ–è¨ˆç®—çµæœ
  const validation = useMemo(() => {
    if (value.length === 0) {
      return { isValid: false, errorMessage: 'Value is required' };
    }
    if (value.length > maxLength) {
      return { isValid: false, errorMessage: `Max ${maxLength} characters` };
    }
    return { isValid: true, errorMessage: null };
  }, [value, maxLength]);

  return {
    value,
    setValue,
    reset,
    ...validation,
  };
}
