# 🌐 Cline Global Rules v2.0 - 強制工具搜尋版

> 此規則適用於所有任務，優先級高於 Workspace Rules

---

## 🚨🚨🚨 第零條天條：強制 Skills 搜尋 🚨🚨🚨

```
╔══════════════════════════════════════════════════════════════════════════════╗
║                                                                              ║
║   ⛔ 開始任何任務前，必須先使用 SkillsMP 搜尋適合的工具 ⛔                     ║
║                                                                              ║
║   沒有搜尋工具就開始寫代碼 = 違規 = 任務失敗                                   ║
║                                                                              ║
╚══════════════════════════════════════════════════════════════════════════════╝
```

### 強制執行流程

1. **收到任務** → 立即分析任務類型
2. **搜尋 Skills** → 使用 `search_skills` 或 `ai_search_skills` 搜尋相關工具
3. **列出可用工具** → 在任務報告中列出找到的 Skills
4. **優先使用工具** → 有合適的 Skill 就用，不重複造輪子
5. **開始執行** → 確認工具後才能開始寫代碼

### Skills 搜尋關鍵字對照表

| 任務類型 | 必搜關鍵字               | 額外關鍵字                        |
| -------- | ------------------------ | --------------------------------- |
| 前端 UI  | `react`, `component`     | `tailwind`, `ui`, `form`          |
| API 開發 | `api`, `rest`            | `fetch`, `serverless`, `endpoint` |
| 資料庫   | `database`, `supabase`   | `postgres`, `sql`, `query`        |
| 認證     | `auth`, `authentication` | `jwt`, `oauth`, `session`         |
| 測試     | `test`, `testing`        | `jest`, `playwright`, `e2e`       |
| 部署     | `deploy`, `vercel`       | `ci/cd`, `github-actions`         |
| AI/LLM   | `openai`, `claude`       | `llm`, `chat`, `embedding`        |
| 工具     | `utility`, `helper`      | `validation`, `formatting`        |

---

## 🔒 最高優先級規則

### 1️⃣ 任務執行前的強制檢查清單

```
□ 是否已使用 SkillsMP 搜尋工具？
□ 是否已閱讀所有相關代碼？
□ 是否已閱讀所有相關文件？
□ 是否已列出完整的工作清單？
□ 是否確認沒有捷徑可走？
```

**任何一項未完成 = 不准開始寫代碼**

### 2️⃣ 先讀後寫（絕對禁止盲寫）

- 修改任何檔案前**必須先讀取該檔案**
- 必須閱讀所有**相關的前端、後端、類型定義**
- 必須理解**現有代碼的架構和風格**
- **不准腦補**任何不確定的內容

### 3️⃣ 最高規格代碼標準

```typescript
// ✅ 正確 - 完整類型定義
interface ApiResponse<T> {
  success: boolean;
  data: T;
  error?: {
    code: string;
    message: string;
  };
}

// ✅ 正確 - 完整錯誤處理
async function fetchData<T>(url: string): Promise<ApiResponse<T>> {
  try {
    const response = await fetch(url);
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
    }
    const data = await response.json();
    return { success: true, data };
  } catch (error) {
    const message = error instanceof Error ? error.message : '未知錯誤';
    console.error(`Fetch failed: ${message}`);
    return {
      success: false,
      data: null as T,
      error: { code: 'FETCH_ERROR', message }
    };
  }
}

// ❌ 禁止 - any 類型
const data: any = fetchData();

// ❌ 禁止 - 忽略錯誤
try { ... } catch (e) { /* 空的 */ }

// ❌ 禁止 - 硬編碼
const API_KEY = "sk-xxx...";
```

---

## 📋 任務執行協議 v2.0

### 收到任務的第一秒

```
╔══════════════════════════════════════════════════════════════╗
║ 📋 任務接收                                                  ║
╠══════════════════════════════════════════════════════════════╣
║ 🎯 任務：[用一句話描述任務]                                   ║
║ ⏰ 開始：[當前時間]                                          ║
╠══════════════════════════════════════════════════════════════╣
║ 🔍 Skills 搜尋結果：                                          ║
║   • 搜尋關鍵字：[關鍵字1], [關鍵字2], ...                     ║
║   • 找到工具：[工具名1] - [用途]                              ║
║   •          [工具名2] - [用途]                               ║
║   • 決定使用：[選擇使用的工具]                                 ║
╠══════════════════════════════════════════════════════════════╣
║ 📖 已閱讀檔案：                                               ║
║   • [file1.ts] - [為什麼需要讀]                               ║
║   • [file2.ts] - [為什麼需要讀]                               ║
╠══════════════════════════════════════════════════════════════╣
║ 📝 工作清單（HARD GATE - 全部完成才算完成）：                 ║
║   ⬜ 1. [第一個子任務]                                        ║
║   ⬜ 2. [第二個子任務]                                        ║
║   ⬜ 3. [第三個子任務]                                        ║
╚══════════════════════════════════════════════════════════════╝
```

### 完成子任務時

```
═══════════════════════════════════════════════════════════════
📊 進度報告 [X/Y]
═══════════════════════════════════════════════════════════════
✅ 剛完成：[完成的項目描述]
📁 修改的檔案：[file.ts] - [改了什麼]
🔧 使用的工具：[使用了哪些 Skills]

📝 清單狀態：
  ✅ 1. [已完成項目]
  🔧 2. [當前進行中] ← 現在
  ⬜ 3. [待處理項目]
═══════════════════════════════════════════════════════════════
```

### 任務完成時

```
╔══════════════════════════════════════════════════════════════╗
║ 🏁 任務完成                                                  ║
╠══════════════════════════════════════════════════════════════╣
║ 🎯 任務：[任務描述]                                          ║
╠══════════════════════════════════════════════════════════════╣
║ ✅ 完成清單：                                                 ║
║   ✅ 1. [完成項目]                                            ║
║   ✅ 2. [完成項目]                                            ║
╠══════════════════════════════════════════════════════════════╣
║ 📁 修改的檔案：                                               ║
║   • [file1.ts] - [改了什麼]                                   ║
║ 📦 使用的 Skills：                                            ║
║   • [skill-name] - [用途]                                     ║
╠══════════════════════════════════════════════════════════════╣
║ ✅ 測試結果：                                                  ║
║   • npm run typecheck ✓                                       ║
║   • npm run lint ✓                                            ║
║   • npm run build ✓                                           ║
╚══════════════════════════════════════════════════════════════╝
```

---

## 🗣️ 語言規範

| 場景        | 語言                 |
| ----------- | -------------------- |
| AI 回覆     | 繁體中文（台灣用語） |
| UI 文字     | 繁體中文             |
| 錯誤訊息    | 繁體中文             |
| 變數/函數名 | 英文 camelCase       |
| 類型/介面名 | 英文 PascalCase      |
| 註解        | 繁體中文或英文       |

---

## 🚫 違規行為（任一觸發 = 任務失敗）

| 違規          | 說明                         | 懲罰     |
| ------------- | ---------------------------- | -------- |
| 沒搜尋 Skills | 沒有先使用 SkillsMP 搜尋工具 | 任務失敗 |
| 沒讀取檔案    | 修改前沒有先讀取相關檔案     | 任務失敗 |
| 使用 any      | 使用了 any 類型              | -20 分   |
| 空的 catch    | catch 區塊沒有處理錯誤       | -20 分   |
| 硬編碼密鑰    | 在代碼中硬編碼 API Key       | 立即終止 |
| 跳過測試      | 沒有執行驗證命令             | -30 分   |
| 腦補需求      | 假設用戶意圖而不詢問         | 任務失敗 |
| 便宜行事      | 用簡單但錯誤的方案           | 任務失敗 |

---

## 🧪 強制驗證檢查

完成任務前**必須**執行以下命令：

```bash
# 1. TypeScript 類型檢查
npm run typecheck

# 2. ESLint 代碼風格檢查
npm run lint

# 3. 構建檢查
npm run build
```

**任何一項失敗 = 任務未完成**

---

## ⚡ 效能與品質標準

1. **完整類型** - 所有變數都必須有明確類型
2. **完整錯誤處理** - 每個 async/await 都要有 try/catch
3. **完整日誌** - 錯誤要有足夠的上下文資訊
4. **完整測試** - 功能必須可驗證
5. **完整文檔** - 複雜邏輯要有註解

---

_版本：v2.0 強制工具搜尋版_
_最後更新：2025-12-24_
