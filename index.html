<!doctype html>
<html lang="zh-Hant-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="light only" />
    <meta name="theme-color" content="#ffffff" />

    <!-- DNS 預解析與預連線優化 -->
    <link rel="preconnect" href="https://api.openai.com" crossorigin />
    <link rel="dns-prefetch" href="https://api.openai.com" />

    <title>邁房子｜讓家,不只是地址</title>
    <script>
      // 全域錯誤捕捉，防止手機白屏無法除錯
      window.__ERRORS__ = [];
      window.onerror = function (msg, url, lineNo, columnNo, error) {
        var errInfo = {
          msg: msg,
          url: url,
          line: lineNo,
          col: columnNo,
          stack: error && error.stack ? error.stack : 'N/A',
        };
        window.__ERRORS__.push(errInfo);

        var root = document.getElementById('root');
        if (root) {
          var stackHtml =
            error && error.stack
              ? '<pre style="font-size:10px;overflow-x:auto;background:#1e1e1e;color:#d4d4d4;padding:10px;border-radius:4px;margin-top:10px;white-space:pre-wrap;word-break:break-all;">' +
                error.stack +
                '</pre>'
              : '';
          root.innerHTML =
            '<div style="padding:20px;color:#e11d48;background:#fff1f2;border:1px solid #fda4af;border-radius:8px;margin:10px;font-family:sans-serif;">' +
            '<h3 style="margin:0 0 10px 0">頁面執行出錯</h3>' +
            '<p style="font-size:13px;margin:0;word-break:break-all;">錯誤: ' +
            msg +
            '</p>' +
            '<p style="font-size:11px;color:#666;margin:5px 0 0 0;word-break:break-all;">位置: ' +
            url +
            ':' +
            lineNo +
            ':' +
            columnNo +
            '</p>' +
            stackHtml +
            '<button onclick="location.reload()" style="margin-top:15px;padding:8px 16px;background:#e11d48;color:white;border:none;border-radius:6px;font-weight:bold;">重新整理</button>' +
            '</div>';
        }
        return false;
      };
      window.onunhandledrejection = function (event) {
        var reason = event.reason;
        var msg = reason instanceof Error ? reason.message : String(reason);
        var stack = reason instanceof Error ? reason.stack : 'N/A';
        window.__ERRORS__.push({
          type: 'unhandledrejection',
          msg: msg,
          stack: stack,
        });

        var root = document.getElementById('root');
        if (root && root.innerText.indexOf('載入中') !== -1) {
          var stackHtml =
            stack !== 'N/A'
              ? '<pre style="font-size:10px;overflow-x:auto;background:#1e1e1e;color:#d4d4d4;padding:10px;border-radius:4px;margin-top:10px;white-space:pre-wrap;word-break:break-all;">' +
                stack +
                '</pre>'
              : '';
          root.innerHTML =
            '<div style="padding:20px;color:#e11d48;background:#fff1f2;border:1px solid #fda4af;border-radius:8px;margin:10px;font-family:sans-serif;">' +
            '<h3 style="margin:0 0 10px 0">Promise 錯誤</h3>' +
            '<p style="font-size:13px;margin:0;word-break:break-all;">錯誤: ' +
            msg +
            '</p>' +
            stackHtml +
            '<button onclick="location.reload()" style="margin-top:15px;padding:8px 16px;background:#e11d48;color:white;border:none;border-radius:6px;font-weight:bold;">重新整理</button>' +
            '</div>';
        }
      };
    </script>
  </head>

  <body>
    <div id="root">
      <div
        style="
          padding: 16px;
          font-family:
            system-ui,
            -apple-system,
            Segoe UI,
            Roboto,
            Helvetica,
            Arial,
            sans-serif;
          color: #526070;
          background: #eef2f7;
          min-height: 100vh;
          box-sizing: border-box;
        "
      >
        載入中…若畫面長時間空白，請更新 Safari 或清除快取後重試。
      </div>
    </div>
    <noscript>
      <div
        style="
          padding: 16px;
          font-family:
            system-ui,
            -apple-system,
            Segoe UI,
            Roboto,
            Helvetica,
            Arial,
            sans-serif;
          color: #526070;
          background: #eef2f7;
          min-height: 100vh;
          box-sizing: border-box;
        "
      >
        需要啟用 JavaScript 才能使用此網站。
      </div>
    </noscript>
    <script>
      // Force Eruda if ?eruda=true is present
      if (window.location.href.includes('eruda=true')) {
        var script = document.createElement('script');
        script.src = '//cdn.jsdelivr.net/npm/eruda';
        script.onload = function () {
          eruda.init();
          console.log('Eruda initialized directly from index.html');
        };
        document.body.appendChild(script);
      }
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
